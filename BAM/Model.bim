{
  "name": "SemanticModel",
  "compatibilityLevel": 1600,
  "model": {
    "name": "模型",
    "culture": "zh-CN",
    "discourageImplicitMeasures": true,
    "dataSources": [
      {
        "type": "structured",
        "name": "Oracle/172 16 8 78/oracledb",
        "connectionDetails": {
          "protocol": "oracle",
          "address": {
            "server": "172.16.8.78/oracledb"
          },
          "authentication": null,
          "query": null
        },
        "options": {
          "hierarchicalNavigation": true
        },
        "credential": {
          "AuthenticationKind": "UsernamePassword",
          "kind": "Oracle",
          "path": "172.16.8.78/oracledb",
          "Username": "gspm",
          "PrivacySetting": "Public"
        }
      },
      {
        "type": "structured",
        "name": "Oracle/172 16 8 127/racdb com",
        "connectionDetails": {
          "protocol": "oracle",
          "address": {
            "server": "172.16.8.127/racdb.com"
          },
          "authentication": null,
          "query": null
        },
        "options": {
          "hierarchicalNavigation": true
        },
        "credential": {
          "AuthenticationKind": "UsernamePassword",
          "kind": "Oracle",
          "path": "172.16.8.127/racdb.com",
          "Username": "picc",
          "PrivacySetting": "Public"
        }
      }
    ],
    "tables": [
      {
        "name": "F_业主确认量",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "确认产值无税",
            "dataType": "double",
            "sourceColumn": "确认产值无税"
          },
          {
            "name": "税额",
            "dataType": "double",
            "sourceColumn": "税额"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "确认产值含税",
            "dataType": "double",
            "sourceColumn": "确认产值含税"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({新业主确认量, 结转确认量})",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D-责任体",
        "columns": [
          {
            "name": "责任体",
            "dataType": "string",
            "sourceColumn": "责任体"
          },
          {
            "name": "排序",
            "dataType": "int64",
            "sourceColumn": "排序"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 责任体",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D_施工专业",
        "columns": [
          {
            "name": "施工专业",
            "dataType": "string",
            "sourceColumn": "施工专业"
          },
          {
            "name": "排序",
            "dataType": "int64",
            "sourceColumn": "排序"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 施工专业",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D_分包类型",
        "columns": [
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "简称",
            "dataType": "string",
            "sourceColumn": "简称"
          },
          {
            "name": "排序",
            "dataType": "int64",
            "sourceColumn": "排序"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 分包类型",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D_商务科目",
        "columns": [
          {
            "name": "FID",
            "dataType": "string",
            "sourceColumn": "FID"
          },
          {
            "name": "商务科目名称",
            "dataType": "string",
            "sourceColumn": "商务科目名称"
          },
          {
            "name": "状态",
            "dataType": "string",
            "sourceColumn": "状态"
          },
          {
            "name": "全路径",
            "dataType": "string",
            "sourceColumn": "全路径"
          },
          {
            "name": "一级",
            "dataType": "string",
            "sourceColumn": "一级"
          },
          {
            "name": "二级",
            "dataType": "string",
            "sourceColumn": "二级"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 商务科目",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D_日历",
        "dataCategory": "Time",
        "columns": [
          {
            "name": "日期",
            "dataType": "dateTime",
            "isKey": true,
            "sourceColumn": "日期",
            "annotations": [
              {
                "name": "TabularEditor_MarkAsDateKey",
                "value": "1"
              }
            ]
          },
          {
            "name": "日期序号",
            "dataType": "int64",
            "sourceColumn": "日期序号"
          },
          {
            "name": "年序号",
            "dataType": "int64",
            "sourceColumn": "年序号"
          },
          {
            "name": "年份名称",
            "dataType": "string",
            "sourceColumn": "年份名称"
          },
          {
            "name": "季度序号",
            "dataType": "int64",
            "sourceColumn": "季度序号"
          },
          {
            "name": "季度名称",
            "dataType": "string",
            "sourceColumn": "季度名称"
          },
          {
            "name": "月份序号",
            "dataType": "int64",
            "sourceColumn": "月份序号"
          },
          {
            "name": "月份名称",
            "dataType": "string",
            "sourceColumn": "月份名称"
          },
          {
            "name": "周序号",
            "dataType": "int64",
            "sourceColumn": "周序号"
          },
          {
            "name": "周名称",
            "dataType": "string",
            "sourceColumn": "周名称"
          },
          {
            "name": "年季序号",
            "dataType": "int64",
            "sourceColumn": "年季序号"
          },
          {
            "name": "年季名称",
            "dataType": "string",
            "sourceColumn": "年季名称"
          },
          {
            "name": "年月序号",
            "dataType": "int64",
            "sourceColumn": "年月序号"
          },
          {
            "name": "年月名称",
            "dataType": "string",
            "sourceColumn": "年月名称"
          },
          {
            "name": "年周序号",
            "dataType": "int64",
            "sourceColumn": "年周序号"
          },
          {
            "name": "年周名称",
            "dataType": "string",
            "sourceColumn": "年周名称"
          },
          {
            "name": "日序号",
            "dataType": "int64",
            "sourceColumn": "日序号"
          },
          {
            "name": "周天名称",
            "dataType": "string",
            "sourceColumn": "周天名称"
          },
          {
            "name": "工作日",
            "dataType": "string",
            "sourceColumn": "工作日"
          },
          {
            "type": "calculated",
            "name": "日名称",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "FORMAT('D_日历'[日期],\"yyyy年MM月DD日\")",
            "lineageTag": "ff7511af-18ff-41db-9929-c7566f64b4cb"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    x = 2000,",
                "    y = Date.Year(DateTime.FixedLocalNow()),",
                "    begin_date = if x = null then #date(Date.Year(DateTime.LocalNow()),1,1) else #date(x,1,1),",
                "    end_date = if y = null then #date(Date.Year(DateTime.LocalNow()),12,31) else #date(y,12,31),",
                "    list = {1..Number.From(end_date)-Number.From(begin_date)+1},",
                "    dates = List.Transform( list , (item)=> Date.AddDays(begin_date,item-1) ),",
                "    table = Table.TransformColumnTypes(Table.RenameColumns(Table.FromList(dates, Splitter.SplitByNothing(), null, null, ExtraValues.Error),{{\"Column1\", \"日期\"}}),{{\"日期\", type date}}),",
                "    date_id = Table.TransformColumnTypes(Table.AddColumn(table, \"日期序号\", each Date.Year([日期])*10000+Date.Month([日期])*100+Date.Day([日期])),{{\"日期序号\", Int64.Type}}),",
                "    year_id = Table.AddColumn(date_id, \"年序号\", each Date.Year([日期]), Int64.Type),",
                "    year_name = Table.AddColumn(year_id, \"年份名称\", each Text.From([年序号])&\"年\",Text.Type),",
                "    quarter_id = Table.AddColumn(year_name, \"季度序号\", each Date.QuarterOfYear([日期]), Int64.Type),",
                "    quarter_name = Table.AddColumn(quarter_id, \"季度名称\", each Text.From([季度序号])&\"季\",Text.Type),",
                "    month_id = Table.AddColumn(quarter_name, \"月份序号\", each Date.Month([日期]), Int64.Type),",
                "    month_name = Table.AddColumn(month_id, \"月份名称\", each Text.PadStart(Text.From([月份序号]),2,\"0\")&\"月\",Text.Type),",
                "    week_id = Table.AddColumn(month_name, \"周序号\", each Date.WeekOfYear([日期]), Int64.Type),",
                "    week_name = Table.AddColumn(week_id, \"周名称\", each Text.PadStart(Text.From([周序号]),2,\"0\")&\"周\",Text.Type),",
                "    year_quarter_id = Table.AddColumn(week_name, \"年季序号\", each Date.Year([日期])*10+Date.QuarterOfYear([日期]), Int64.Type),",
                "    year_quarter_name = Table.AddColumn(year_quarter_id, \"年季名称\", each \"YQ\"&Text.From([年季序号]),Text.Type),",
                "    year_month_id = Table.AddColumn(year_quarter_name, \"年月序号\", each Date.Year([日期])*100+ Date.Month([日期]), Int64.Type),",
                "    year_month_name = Table.AddColumn(year_month_id, \"年月名称\", each [年份名称]&[月份名称],type text),",
                "    year_week_id = Table.AddColumn(year_month_name, \"年周序号\", each Date.Year([日期])*100+ Date.WeekOfYear([日期]), Int64.Type),",
                "    #\"year_week-name\" = Table.AddColumn(year_week_id, \"年周名称\", each \"YW\"&Text.From([年周序号]),Text.Type),",
                "    day_in_week_id = Table.AddColumn(#\"year_week-name\", \"日序号\", each Date.DayOfWeek([日期],0), Int64.Type),",
                "    day_in_week_name = Table.AddColumn(day_in_week_id, \"周天名称\", each if [日序号] = 1 then \"WD1\" else",
                "if [日序号] = 2 then \"WD2\" else",
                "if [日序号] = 3 then \"WD3\" else",
                "if [日序号] = 4 then \"WD4\" else",
                "if [日序号] = 5 then \"WD5\" else",
                "if [日序号] = 6 then \"WD6\" else",
                "\"WD7\",Text.Type),",
                "    work_day = Table.AddColumn(day_in_week_name , \"工作日\", each if [日序号] = 6 or [日序号] = 0 then \"休息日\" else \"工作日\",Text.Type)",
                "in",
                "    work_day"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "日期层次",
            "lineageTag": "14f8efb6-043e-4583-9d7e-ea8e004e4cdc",
            "levels": [
              {
                "name": "年份名称",
                "ordinal": 0,
                "column": "年份名称",
                "lineageTag": "944c5366-6eb3-4ab4-af6f-8d0fe8fb0614"
              },
              {
                "name": "年月名称",
                "ordinal": 1,
                "column": "年月名称",
                "lineageTag": "e79daaf5-c944-4555-a402-1c6578da7d79"
              },
              {
                "name": "日名称",
                "ordinal": 2,
                "column": "日名称",
                "lineageTag": "ceae9f3e-c3a0-44f8-a5dd-ed0fb3d1da0b"
              }
            ]
          }
        ]
      },
      {
        "name": "D_项目信息",
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "专业分类",
            "dataType": "string",
            "sourceColumn": "专业分类"
          },
          {
            "name": "签约单位",
            "dataType": "string",
            "sourceColumn": "签约单位"
          },
          {
            "name": "经营类型",
            "dataType": "string",
            "sourceColumn": "经营类型"
          },
          {
            "name": "业务板块",
            "dataType": "string",
            "sourceColumn": "业务板块"
          },
          {
            "name": "投标管理部门",
            "dataType": "string",
            "sourceColumn": "投标管理部门"
          },
          {
            "name": "股份财务一体化项目编码",
            "dataType": "string",
            "sourceColumn": "股份财务一体化项目编码"
          },
          {
            "name": "股份一体化利润中心编码",
            "dataType": "string",
            "sourceColumn": "股份一体化利润中心编码"
          },
          {
            "name": "责任体",
            "dataType": "string",
            "sourceColumn": "责任体"
          },
          {
            "name": "实际竣工日期",
            "dataType": "dateTime",
            "sourceColumn": "实际竣工日期",
            "formatString": "General Date",
            "lineageTag": "e26454fa-f30b-4cbe-a5f3-cd4f05c1fb62",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "name": "实际开工日期",
            "dataType": "dateTime",
            "sourceColumn": "实际开工日期",
            "formatString": "General Date",
            "lineageTag": "3acc761e-4d1d-4e02-8c2e-f04430435472",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 项目信息",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D_承包合同",
        "columns": [
          {
            "name": "类别",
            "dataType": "string",
            "sourceColumn": "类别"
          },
          {
            "name": "类型",
            "dataType": "string",
            "sourceColumn": "类型"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "合同名称",
            "dataType": "string",
            "sourceColumn": "合同名称"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "主合同编号",
            "dataType": "string",
            "sourceColumn": "主合同编号"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 承包合同",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "F_承包合同金额",
        "isHidden": true,
        "columns": [
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "含税",
            "dataType": "double",
            "sourceColumn": "含税"
          },
          {
            "name": "无税",
            "dataType": "double",
            "sourceColumn": "无税"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = GSPM_CHENGBAOHETONGXINXI,",
                "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"签订日期\", \"土建-指定-含税\", \"机电-指定-含税\", \"土建-自施-含税\", \"机电-自施-含税\", \"土建-指定-无税\", \"机电-指定-无税\", \"土建-自施-无税\", \"机电-自施-无税\"}),",
                "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"签订日期\", DateTime.Date, type date}}),",
                "    逆透视的其他列 = Table.UnpivotOtherColumns(提取的日期, {\"合同编号\", \"签订日期\"}, \"属性\", \"值\"),",
                "    按分隔符拆分列 = Table.SplitColumn(逆透视的其他列, \"属性\", Splitter.SplitTextByDelimiter(\"-\", QuoteStyle.Csv), {\"属性.1\", \"属性.2\", \"属性.3\"}),",
                "    重命名的列1 = Table.RenameColumns(按分隔符拆分列,{{\"属性.1\", \"专业\"}, {\"属性.2\", \"分包类型\"}}),",
                "    已透视列 = Table.Pivot(重命名的列1, List.Distinct(重命名的列1[属性.3]), \"属性.3\", \"值\", List.Sum)",
                "in",
                "    已透视列"
              ]
            }
          }
        ]
      },
      {
        "name": "F_分包合同额",
        "isHidden": true,
        "columns": [
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "补充协议号",
            "dataType": "string",
            "sourceColumn": "补充协议号"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "商务科目ID",
            "dataType": "string",
            "sourceColumn": "商务科目ID"
          },
          {
            "name": "财务科目ID",
            "dataType": "string",
            "sourceColumn": "财务科目ID"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "sourceColumn": "施工专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "分包编码",
            "dataType": "string",
            "sourceColumn": "分包编码"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "不含税合同价",
            "dataType": "double",
            "sourceColumn": "不含税合同价"
          },
          {
            "name": "含税合同价",
            "dataType": "double",
            "sourceColumn": "含税合同价"
          },
          {
            "name": "税金",
            "dataType": "double",
            "sourceColumn": "税金"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 分包合同,",
                "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"补充协议号\", \"项目编码\", \"商务科目ID\", \"财务科目ID\", \"施工专业\", \"分包类型\", \"分包编码\", \"签订日期\", \"不含税合同价\", \"含税合同价\", \"税金\", \"KEYID\"}),",
                "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"签订日期\", DateTime.Date, type date}})",
                "in",
                "    提取的日期"
              ]
            }
          }
        ]
      },
      {
        "name": "D_分包合同",
        "columns": [
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "补充协议号",
            "dataType": "string",
            "sourceColumn": "补充协议号"
          },
          {
            "name": "合同名称",
            "dataType": "string",
            "sourceColumn": "合同名称"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "标准合同名称",
            "dataType": "string",
            "sourceColumn": "标准合同名称"
          },
          {
            "name": "商务科目ID",
            "dataType": "string",
            "sourceColumn": "商务科目ID"
          },
          {
            "name": "商务科目",
            "dataType": "string",
            "sourceColumn": "商务科目"
          },
          {
            "name": "财务科目ID",
            "dataType": "string",
            "sourceColumn": "财务科目ID"
          },
          {
            "name": "是否临建合同",
            "dataType": "string",
            "sourceColumn": "是否临建合同"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "sourceColumn": "施工专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "分包编码",
            "dataType": "string",
            "sourceColumn": "分包编码"
          },
          {
            "name": "分包名称",
            "dataType": "string",
            "sourceColumn": "分包名称"
          },
          {
            "name": "是否暂估",
            "dataType": "string",
            "sourceColumn": "是否暂估"
          },
          {
            "name": "单据状态",
            "dataType": "string",
            "sourceColumn": "单据状态"
          },
          {
            "name": "业务类别",
            "dataType": "string",
            "sourceColumn": "业务类别"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "合同内容",
            "dataType": "string",
            "sourceColumn": "合同内容"
          },
          {
            "name": "标准合同编码",
            "dataType": "string",
            "sourceColumn": "标准合同编码",
            "lineageTag": "5236fd06-18fd-4171-8b2b-55d88d86a70b",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "name": "国内外",
            "dataType": "string",
            "sourceColumn": "国内外",
            "lineageTag": "4639b14d-c0e2-4327-8354-72cdefac2616",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = D_分包合同",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "F_分包结算",
        "isHidden": true,
        "columns": [
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "不含税结算额",
            "dataType": "double",
            "sourceColumn": "不含税结算额"
          },
          {
            "name": "含税结算额",
            "dataType": "double",
            "sourceColumn": "含税结算额"
          },
          {
            "name": "税金",
            "dataType": "double",
            "sourceColumn": "税金"
          },
          {
            "type": "calculated",
            "name": "C_分包类型",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_分包合同'[分包类型])",
            "lineageTag": "74b7a37b-785f-49d7-943a-293c23a6121f",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "C_施工专业",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_分包合同'[施工专业])",
            "lineageTag": "c067af42-0de1-415b-85c6-7220a3f20ba2",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = #\"GSPM_FENBAOHETONGJIESUAN（分包合同结算）\",",
                "    删除的其他列 = Table.SelectColumns(源,{\"FXIANGMUBIANMA\", \"FXIANGMUMINGCHENG\", \"FHETONGBIANHAO\", \"FJIESUANJIAHS\", \"FJIESUANJIABHS\", \"FQIANDINGSHIJIAN\", \"FPINGSHENZHUANGTAI\", \"SCREATETIME\", \"FJIESUANLEIXING\"}),",
                "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"FQIANDINGSHIJIAN\", DateTime.Date, type date}}),",
                "    重命名的列 = Table.RenameColumns(提取的日期,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FJIESUANJIAHS\", \"含税结算额\"}, {\"FPINGSHENZHUANGTAI\", \"单据状态\"}, {\"FQIANDINGSHIJIAN\", \"签订日期\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FJIESUANJIABHS\", \"不含税结算额\"}}),",
                "    #\"已添加自定义（KEYID）\" = Table.AddColumn(重命名的列, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text),",
                "    排序的行 = Table.Buffer(Table.Sort(#\"已添加自定义（KEYID）\",{{\"KEYID\", Order.Descending}, {\"SCREATETIME\", Order.Descending}})),",
                "    #\"删除的副本（取各项目该合同末期结算）\" = Table.Distinct(排序的行, {\"KEYID\"}),",
                "    删除的其他列1 = Table.SelectColumns(#\"删除的副本（取各项目该合同末期结算）\",{\"项目编码\", \"合同编号\", \"含税结算额\", \"不含税结算额\", \"签订日期\", \"KEYID\"}),",
                "    #\"已添加自定义（计算税金）\" = Table.AddColumn(删除的其他列1, \"税金\", each List.Sum({[含税结算额],-[不含税结算额]}),Number.Type),",
                "    重排序的列 = Table.ReorderColumns(#\"已添加自定义（计算税金）\",{\"KEYID\", \"项目编码\", \"合同编号\", \"签订日期\", \"不含税结算额\", \"含税结算额\", \"税金\"})",
                "in",
                "    重排序的列"
              ]
            }
          }
        ]
      },
      {
        "name": "F_采购物资合同额",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "补充协议号",
            "dataType": "string",
            "sourceColumn": "补充协议号"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "供方编码",
            "dataType": "string",
            "sourceColumn": "供方编码"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "价税合计",
            "dataType": "double",
            "sourceColumn": "价税合计"
          },
          {
            "name": "合同额",
            "dataType": "double",
            "sourceColumn": "合同额"
          },
          {
            "name": "税额",
            "dataType": "double",
            "sourceColumn": "税额"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 采购物资合同,",
                "    删除的其他列 = Table.SelectColumns(源,{\"项目编码\", \"补充协议号\", \"合同编号\", \"专业\", \"分包类型\", \"供方编码\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"KEYID\"})",
                "in",
                "    删除的其他列"
              ]
            }
          }
        ]
      },
      {
        "name": "D_采购物资合同",
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "补充协议号",
            "dataType": "string",
            "sourceColumn": "补充协议号"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "合同名称",
            "dataType": "string",
            "sourceColumn": "合同名称"
          },
          {
            "name": "标准合同编码",
            "dataType": "string",
            "sourceColumn": "标准合同编码"
          },
          {
            "name": "标准合同名称",
            "dataType": "string",
            "sourceColumn": "标准合同名称"
          },
          {
            "name": "商务科目ID",
            "dataType": "string",
            "sourceColumn": "商务科目ID"
          },
          {
            "name": "财务科目ID",
            "dataType": "string",
            "sourceColumn": "财务科目ID"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "供方编码",
            "dataType": "string",
            "sourceColumn": "供方编码"
          },
          {
            "name": "供方名称",
            "dataType": "string",
            "sourceColumn": "供方名称"
          },
          {
            "name": "增值税率",
            "dataType": "double",
            "sourceColumn": "增值税率"
          },
          {
            "name": "合同类型",
            "dataType": "string",
            "sourceColumn": "合同类型"
          },
          {
            "name": "业务大类",
            "dataType": "string",
            "sourceColumn": "业务大类"
          },
          {
            "name": "业务小类",
            "dataType": "string",
            "sourceColumn": "业务小类"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "国内外",
            "dataType": "string",
            "sourceColumn": "国内外"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = D_采购物资合同",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "F_租赁物资合同额",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "补充协议号",
            "dataType": "string",
            "sourceColumn": "补充协议号"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "供方编码",
            "dataType": "string",
            "sourceColumn": "供方编码"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "价税合计",
            "dataType": "double",
            "sourceColumn": "价税合计"
          },
          {
            "name": "合同额",
            "dataType": "double",
            "sourceColumn": "合同额"
          },
          {
            "name": "税额",
            "dataType": "double",
            "sourceColumn": "税额"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 租赁物资合同,",
                "    删除的其他列 = Table.SelectColumns(源,{\"项目编码\", \"补充协议号\", \"合同编号\", \"专业\", \"分包类型\", \"供方编码\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"KEYID\"})",
                "in",
                "    删除的其他列"
              ]
            }
          }
        ]
      },
      {
        "name": "D_租赁物资合同",
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "补充协议号",
            "dataType": "string",
            "sourceColumn": "补充协议号"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "合同名称",
            "dataType": "string",
            "sourceColumn": "合同名称"
          },
          {
            "name": "标准合同编码",
            "dataType": "string",
            "sourceColumn": "标准合同编码"
          },
          {
            "name": "标准合同名称",
            "dataType": "string",
            "sourceColumn": "标准合同名称"
          },
          {
            "name": "商务科目ID",
            "dataType": "string",
            "sourceColumn": "商务科目ID"
          },
          {
            "name": "财务科目ID",
            "dataType": "string",
            "sourceColumn": "财务科目ID"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "供方编码",
            "dataType": "string",
            "sourceColumn": "供方编码"
          },
          {
            "name": "供方名称",
            "dataType": "string",
            "sourceColumn": "供方名称"
          },
          {
            "name": "增值税率",
            "dataType": "double",
            "sourceColumn": "增值税率"
          },
          {
            "name": "合同类型",
            "dataType": "string",
            "sourceColumn": "合同类型"
          },
          {
            "name": "业务大类",
            "dataType": "string",
            "sourceColumn": "业务大类"
          },
          {
            "name": "业务小类",
            "dataType": "string",
            "sourceColumn": "业务小类"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "国内外",
            "dataType": "string",
            "sourceColumn": "国内外"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = D_租赁物资合同",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "F_采购物资进场",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "本月进场含税",
            "dataType": "double",
            "sourceColumn": "本月进场含税"
          },
          {
            "name": "本月进场不含税",
            "dataType": "double",
            "sourceColumn": "本月进场不含税"
          },
          {
            "name": "本月税金",
            "dataType": "double",
            "sourceColumn": "本月税金"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({物资进场二期, 物资进场一期}),",
                "    合并的查询 = Table.NestedJoin(源, {\"KEYID\"}, D_采购物资合同, {\"KEYID\"}, \"D_消耗物资合同\", JoinKind.LeftOuter),",
                "    #\"展开的“D_消耗物资合同”\" = Table.ExpandTableColumn(合并的查询, \"D_消耗物资合同\", {\"专业\", \"分包类型\"}, {\"专业\", \"分包类型\"})",
                "in",
                "    #\"展开的“D_消耗物资合同”\""
              ]
            }
          }
        ]
      },
      {
        "name": "F_采购物资付款表",
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "项目编码"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "日期"
          },
          {
            "name": "支付方式",
            "dataType": "string",
            "sourceColumn": "支付方式"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "合同编号"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "施工专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "分包类型"
          },
          {
            "name": "本期付款",
            "dataType": "decimal",
            "isHidden": true,
            "sourceColumn": "本期付款"
          },
          {
            "name": "单据状态",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "单据状态"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "KEYID"
          },
          {
            "type": "calculated",
            "name": "C_分包类型",
            "dataType": "string",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "RELATED('D_采购物资合同'[专业])",
            "lineageTag": "5feac364-f126-485e-b383-ad2c764ec20f",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"IsHidden\"]"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "C_施工专业",
            "dataType": "string",
            "isDataTypeInferred": true,
            "isHidden": true,
            "expression": "RELATED('D_采购物资合同'[专业])",
            "lineageTag": "9e77c7e9-cbe2-463d-b715-8be19d09c8af",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"IsHidden\"]"
              }
            ]
          },
          {
            "name": "支付渠道",
            "dataType": "string",
            "sourceColumn": "支付渠道",
            "lineageTag": "46bbd1d7-1d6c-496c-8c34-1f4641d0d4c5"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({单项物资付款,集采物资付款}),",
                "    #\"替换的值(标准化状态)\" = Table.ReplaceValue(源,each [单据状态] ,each if [单据状态]<> \"已完成\" then \"在途\" else [单据状态],Replacer.ReplaceText,{\"单据状态\"})",
                "in",
                "    #\"替换的值(标准化状态)\""
              ]
            }
          }
        ]
      },
      {
        "name": "F_租赁物资付款表",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "支付方式",
            "dataType": "string",
            "sourceColumn": "支付方式"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "金额",
            "dataType": "double",
            "sourceColumn": "金额"
          },
          {
            "name": "单据状态",
            "dataType": "string",
            "sourceColumn": "单据状态"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "type": "calculated",
            "name": "C_分包类型",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_租赁物资合同'[分包类型])",
            "lineageTag": "f13ef36c-864c-437f-bac3-4aaa237eb123",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"IsHidden\"]"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "C_施工专业",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_租赁物资合同'[专业])",
            "lineageTag": "c0927193-2dc8-4bc9-a941-349e9d9b3588",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"IsHidden\"]"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = #\"GSPM_ZZCAILIAOZULINAFK（租赁合同付款）\",",
                "    删除的其他列 = Table.SelectColumns(源,{\"FXIANGMUBIANMA\", \"FNIAN\", \"FYUE\", \"FZHIFUFANGSHI\", \"FHETONGBIANHAO\", \"FBENQISHIJIFUKUAN\", \"FPINGSHENZHUANGTAI2\"}),",
                "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FBENQISHIJIFUKUAN\", \"金额\"}, {\"FPINGSHENZHUANGTAI2\", \"单据状态\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FZHIFUFANGSHI\", \"支付方式\"}}),",
                "    已添加自定义 = Table.AddColumn(重命名的列, \"日期\", each #date([年],[月],1),Date.Type),",
                "    已添加自定义1 = Table.AddColumn(已添加自定义, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
                "    删除的列 = Table.RemoveColumns(已添加自定义1,{\"年\", \"月\"}),",
                "    #\"替换的值(标准化状态)\" = Table.ReplaceValue(删除的列,each [单据状态] , each if [单据状态]<>\"已完成\" then \"在途\" else [单据状态],Replacer.ReplaceText,{\"单据状态\"})",
                "in",
                "    #\"替换的值(标准化状态)\""
              ]
            }
          }
        ]
      },
      {
        "name": "F_采购物资退场",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "金额",
            "dataType": "double",
            "sourceColumn": "金额"
          },
          {
            "name": "税金",
            "dataType": "double",
            "sourceColumn": "税金"
          },
          {
            "name": "价税合计",
            "dataType": "double",
            "sourceColumn": "价税合计"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 采购物资退场明细,",
                "    合并的查询 = Table.NestedJoin(源,{\"退场单\"},采购物资退场主表,{\"FID\"},\"专项物资退场主表\",JoinKind.Inner),",
                "    #\"展开的“专项物资退场主表”\" = Table.ExpandTableColumn(合并的查询, \"专项物资退场主表\", {\"年\", \"月\", \"项目编码\", \"单据状态\"}, {\"年\", \"月\", \"项目编码\", \"单据状态\"}),",
                "    #\"合并的查询（排除二期项目）\" = Table.FuzzyNestedJoin(#\"展开的“专项物资退场主表”\", {\"项目编码\"}, 非二期项目, {\"项目编码\"}, \"非二期项目\", JoinKind.LeftOuter, [IgnoreCase=true, IgnoreSpace=true]),",
                "    #\"已添加自定义（KEYID）\" = Table.AddColumn(#\"合并的查询（排除二期项目）\", \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
                "    #\"已添加自定义（日期）\" = Table.AddColumn(#\"已添加自定义（KEYID）\", \"日期\", each #date([年],[月],1),Date.Type),",
                "    #\"合并的查询（物资合同）\" = Table.NestedJoin(#\"已添加自定义（日期）\", {\"KEYID\"}, D_采购物资合同, {\"KEYID\"}, \"D_采购物资合同\", JoinKind.LeftOuter),",
                "    #\"展开的“D_采购物资合同”\" = Table.ExpandTableColumn(#\"合并的查询（物资合同）\", \"D_采购物资合同\", {\"专业\", \"分包类型\"}, {\"专业\", \"分包类型\"}),",
                "    删除的其他列 = Table.SelectColumns(#\"展开的“D_采购物资合同”\",{\"金额\", \"税金\", \"价税合计\", \"项目编码\", \"KEYID\", \"日期\", \"专业\", \"分包类型\"}),",
                "    重排序的列 = Table.ReorderColumns(删除的其他列,{\"项目编码\", \"KEYID\", \"专业\", \"分包类型\", \"日期\", \"金额\", \"税金\", \"价税合计\"})",
                "in",
                "    重排序的列"
              ]
            }
          }
        ]
      },
      {
        "name": "F_物资调拨",
        "isHidden": true,
        "columns": [
          {
            "name": "年",
            "dataType": "double",
            "sourceColumn": "年"
          },
          {
            "name": "月",
            "dataType": "double",
            "sourceColumn": "月"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "sourceColumn": "施工专业"
          },
          {
            "name": "合同类型",
            "dataType": "string",
            "sourceColumn": "合同类型"
          },
          {
            "name": "调拨金额",
            "dataType": "double",
            "sourceColumn": "调拨金额"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = GSPM_WUZIDIAOBOXIANGMUFAQI_CB,",
                "    删除的其他列 = Table.SelectColumns(源,{\"FDIAOBODANID\", \"FDIAOBOJINE\", \"FJINCHANGWUZIID\"}),",
                "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FDIAOBOJINE\", \"调拨金额\"}}),",
                "    合并的查询 = Table.NestedJoin(重命名的列, {\"FDIAOBODANID\"}, 物资调拨主表, {\"FID\"}, \"物资调拨\", JoinKind.Inner),",
                "    #\"展开的“物资调拨报量不含税”\" = Table.ExpandTableColumn(合并的查询, \"物资调拨\", {\"年\", \"月\", \"项目编码\"}, {\"年\", \"月\", \"项目编码\"}),",
                "    删除的列 = Table.RemoveColumns(#\"展开的“物资调拨报量不含税”\",{\"FDIAOBODANID\"}),",
                "    合并的查询1 = Table.NestedJoin(删除的列, {\"FJINCHANGWUZIID\"}, 物资进场物资详细, {\"FID\"}, \"物资进场物资详细\", JoinKind.LeftOuter),",
                "    #\"展开的“物资进场物资详细”\" = Table.ExpandTableColumn(合并的查询1, \"物资进场物资详细\", {\"施工专业\", \"合同类型\"}, {\"施工专业\", \"合同类型\"}),",
                "    删除的列1 = Table.RemoveColumns(#\"展开的“物资进场物资详细”\",{\"FJINCHANGWUZIID\"}),",
                "    重排序的列 = Table.ReorderColumns(删除的列1,{\"年\", \"月\", \"项目编码\", \"施工专业\", \"合同类型\", \"调拨金额\"}),",
                "    已添加自定义 = Table.AddColumn(重排序的列, \"日期\", each #date([年],[月],1),type date),",
                "    替换的值 = Table.ReplaceValue(已添加自定义,null,\"土建\",Replacer.ReplaceValue,{\"施工专业\"}),",
                "    替换的值1 = Table.ReplaceValue(替换的值,null,\"自施\",Replacer.ReplaceValue,{\"合同类型\"})",
                "in",
                "    替换的值1"
              ]
            }
          }
        ]
      },
      {
        "name": "F_物资租赁进场",
        "isHidden": true,
        "columns": [
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "本月进场不含税",
            "dataType": "double",
            "sourceColumn": "本月进场不含税"
          },
          {
            "name": "本月税金",
            "dataType": "double",
            "sourceColumn": "本月税金"
          },
          {
            "name": "本月进场含税",
            "dataType": "double",
            "sourceColumn": "本月进场含税"
          },
          {
            "name": "专业",
            "dataType": "string",
            "sourceColumn": "专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({物资租赁一期, 物资租赁二期}),",
                "    重排序的列 = Table.ReorderColumns(源,{\"KEYID\", \"项目编码\", \"项目名称\", \"日期\", \"合同编号\", \"本月进场不含税\", \"本月税金\", \"本月进场含税\"}),",
                "    合并的查询 = Table.NestedJoin(重排序的列, {\"KEYID\"}, D_租赁物资合同, {\"KEYID\"}, \"D_租赁物资合同\", JoinKind.LeftOuter),",
                "    #\"展开的“D_租赁物资合同”\" = Table.ExpandTableColumn(合并的查询, \"D_租赁物资合同\", {\"专业\", \"分包类型\"}, {\"专业\", \"分包类型\"})",
                "in",
                "    #\"展开的“D_租赁物资合同”\""
              ]
            }
          }
        ]
      },
      {
        "name": "F_采购物资结算",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "含税结算额",
            "dataType": "double",
            "sourceColumn": "含税结算额"
          },
          {
            "name": "不含税结算额",
            "dataType": "double",
            "sourceColumn": "不含税结算额"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "业务大类",
            "dataType": "string",
            "sourceColumn": "业务大类"
          },
          {
            "name": "税金",
            "dataType": "double",
            "sourceColumn": "税金"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "type": "calculated",
            "name": "C_分包类型",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_采购物资合同'[分包类型])",
            "lineageTag": "f5ae7b8e-9907-4675-a76e-f6ed5691f7c3",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "C_施工专业",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_采购物资合同'[专业])",
            "lineageTag": "b98f0a94-a5d3-4278-80e3-29c03e3b70b1",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 物资合同结算,",
                "    筛选的行 = Table.SelectRows(源, each ([业务大类] = \"消耗\"))",
                "in",
                "    筛选的行"
              ]
            }
          }
        ]
      },
      {
        "name": "F_租赁物资结算",
        "isHidden": true,
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "含税结算额",
            "dataType": "double",
            "sourceColumn": "含税结算额"
          },
          {
            "name": "不含税结算额",
            "dataType": "double",
            "sourceColumn": "不含税结算额"
          },
          {
            "name": "签订日期",
            "dataType": "dateTime",
            "sourceColumn": "签订日期"
          },
          {
            "name": "业务大类",
            "dataType": "string",
            "sourceColumn": "业务大类"
          },
          {
            "name": "税金",
            "dataType": "double",
            "sourceColumn": "税金"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "type": "calculated",
            "name": "C_分包类型",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_租赁物资合同'[分包类型])",
            "lineageTag": "bd7ce616-0490-4de2-918d-e57453698780",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "C_施工专业",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED('D_租赁物资合同'[分包类型])",
            "lineageTag": "8e13e707-d2ea-4d26-9dd4-f829c0f290fb",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = 物资合同结算,",
                "    筛选的行 = Table.SelectRows(源, each ([业务大类] = \"周转\"))",
                "in",
                "    筛选的行"
              ]
            }
          }
        ]
      },
      {
        "name": "账户-项目",
        "columns": [
          {
            "name": "身份证",
            "dataType": "string",
            "sourceColumn": "身份证"
          },
          {
            "name": "账号",
            "dataType": "string",
            "sourceColumn": "账号"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.NestedJoin(门户账户, {\"身份证\"}, 员工项目, {\"身份证\"}, \"员工项目\", JoinKind.LeftOuter),",
                "    #\"展开的“员工项目”\" = Table.ExpandTableColumn(源, \"员工项目\", {\"项目编码\"}, {\"项目编码\"}),",
                "    筛选的行 = Table.SelectRows(#\"展开的“员工项目”\", each [项目编码] <> null and [项目编码] <> \"\")",
                "in",
                "    筛选的行"
              ]
            }
          }
        ]
      },
      {
        "name": "F_应上交收益履约",
        "isHidden": true,
        "columns": [
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "开工累计应上缴收益",
            "dataType": "double",
            "sourceColumn": "开工累计应上缴收益"
          },
          {
            "name": "开工累计应上缴履约",
            "dataType": "double",
            "sourceColumn": "开工累计应上缴履约"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = X5,",
                "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
                "    GSPM_PROJECTPROFIT = GSPM{[Name=\"GSPM_PROJECTPROFIT\"]}[Data],",
                "    删除的其他列 = Table.SelectColumns(GSPM_PROJECTPROFIT,{\"IYEAR\", \"IMONTH\", \"FXIANGMUBIANMA\", \"PROJNAME\", \"HEJI5\", \"HEJI8\"}),",
                "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXIANGMUBIANMA\", \"项目编码\"}, {\"PROJNAME\", \"项目名称\"}, {\"HEJI5\", \"开工累计应上缴收益\"}, {\"HEJI8\", \"开工累计应上缴履约\"}}),",
                "    合并的列 = Table.CombineColumns(Table.TransformColumnTypes(重命名的列, {{\"IYEAR\", type text}, {\"IMONTH\", type text}}, \"zh-CN\"),{\"IYEAR\", \"IMONTH\"},Combiner.CombineTextByDelimiter(\"-\", QuoteStyle.None),\"日期\"),",
                "    已分析的日期 = Table.TransformColumns(合并的列,{{\"日期\", each Date.From(DateTimeZone.From(_)), type date}})",
                "in",
                "    已分析的日期"
              ]
            }
          }
        ]
      },
      {
        "name": "度量值",
        "columns": [
          {
            "name": "B",
            "dataType": "string",
            "sourceColumn": "B"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [列1 = _t]),",
                "    重命名的列 = Table.RenameColumns(源,{{\"列1\", \"B\"}})",
                "in",
                "    重命名的列"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "M_物资合同_价税合计",
            "description": "M_物资合同_价税合计 = SUM('F_采购物资合同额'[价税合计])",
            "expression": "SUM('F_采购物资合同额'[价税合计])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\合同",
            "lineageTag": "d898ce57-14f4-4aae-8b00-4521db1d2c78",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资合同_金额",
            "description": "M_物资合同_金额 = SUM('F_采购物资合同额'[合同额])",
            "expression": "SUM('F_采购物资合同额'[合同额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\合同",
            "lineageTag": "bccea53c-a43e-45d4-a1a1-9f748a93b1b1",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资合同_税金",
            "description": "M_物资合同_税金 = SUM('F_采购物资合同额'[税额])",
            "expression": "SUM('F_采购物资合同额'[税额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\合同",
            "lineageTag": "da273162-95ee-4a4a-ac28-8794cc844a79",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_签订日期_物资补充协议(最早)",
            "description": "M_签订日期_物资补充协议(最早) = MIN( 'F_采购物资合同额'[签订日期] )",
            "expression": "MIN( 'F_采购物资合同额'[签订日期] )",
            "displayFolder": "03.采购物资\\合同",
            "lineageTag": "91366356-ecfa-40ac-b1b2-1b56ffd8a532"
          },
          {
            "name": "M_物资进场_价税合计",
            "description": "SUM( 'F_采购物资进场'[本月进场含税] ) - SUM( 'F_采购物资退场'[价税合计] ",
            "expression": "( SUM( 'F_采购物资进场'[本月进场含税] ) - SUM( 'F_采购物资退场'[价税合计] ))/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\进场",
            "lineageTag": "16dfe62e-688a-4ad9-afce-6344766cf5af",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资进场_金额",
            "description": "M_物资进场_金额 = SUM( 'F_采购物资进场'[本月进场不含税] ) - SUM( 'F_采购物资退场'[金额] )",
            "expression": "( SUM( 'F_采购物资进场'[本月进场不含税] ) - SUM( 'F_采购物资退场'[金额] ))/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\进场",
            "lineageTag": "af2b08e5-ee81-45b3-a425-ba57d1325071",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资进场_税金",
            "expression": "(SUM( 'F_采购物资进场'[本月税金] ) - SUM( 'F_采购物资退场'[税金] ))/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\进场",
            "lineageTag": "a7230715-1284-4fe8-b6f4-72bdaa35da4c",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资结算_价税合计",
            "description": "M_物资结算_价税合计 = SUM('F_采购物资结算'[含税结算额])",
            "expression": "SUM('F_采购物资结算'[含税结算额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\结算",
            "lineageTag": "8db2dafd-a035-4e5f-abc9-960d75f54922",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资结算_金额",
            "description": "M_物资结算_金额 = SUM('F_采购物资结算'[不含税结算额])",
            "expression": "SUM('F_采购物资结算'[不含税结算额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\结算",
            "lineageTag": "12bae7f2-0b76-465b-92be-ea57fb995c89",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资结算_税金",
            "description": "M_物资结算_税金 = SUM('F_采购物资结算'[税金])",
            "expression": "SUM('F_采购物资结算'[税金])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\结算",
            "lineageTag": "bcc4fc08-59dd-484a-9e55-f57d8559aa74",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_签订日期_物资结算(最晚)",
            "description": "M_签订日期_物资结算(最晚) = MAX( 'F_采购物资结算'[签订日期] )",
            "expression": "MAX( 'F_采购物资结算'[签订日期] )",
            "displayFolder": "03.采购物资\\结算",
            "lineageTag": "124944f7-5399-42ed-bd25-9b22b9f0ec1b"
          },
          {
            "name": "_物资应付_价税合计",
            "description": [
              "_物资应付_价税合计 = ",
              "IF( [M_物资结算_价税合计]<>0, ",
              "    [M_物资结算_价税合计], ",
              "    [M_物资进场_价税合计]",
              ")",
              "",
              "/*",
              "补充说明：",
              "中间态度量，不应作为最终度量使用",
              "*/"
            ],
            "expression": [
              "",
              "IF( [M_物资结算_价税合计]<>0, ",
              "    [M_物资结算_价税合计], ",
              "    [M_物资进场_价税合计]",
              ")",
              "",
              "/*",
              "补充说明：",
              "中间态度量，不应作为最终度量使用",
              "*/"
            ],
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\结算",
            "lineageTag": "3bd4dd67-7e84-4409-883f-b3531057c4a6",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资应付_价税合计",
            "description": [
              "M_物资应付_价税合计 = ",
              "IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    SUMX(KEEPFILTERS(VALUES('D_采购物资合同'[合同编号])),[_物资应付_价税合计])",
              ")",
              "",
              "/*说明：",
              "    1、进场、结算在时间轴不一致，因此计算时间轴应付无意义，排除时间轴",
              "    2、为保证性能，未用CROSSJOIN(ALL(各维度字段值))作为迭代表，因此使用时，各坐标轴字段应来自同一筛选链，例如：不应出现D_分包类型的字段",
              "*/"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    SUMX(KEEPFILTERS(VALUES('D_采购物资合同'[合同编号])),[_物资应付_价税合计])",
              ")",
              "",
              "/*说明：",
              "    1、进场、结算在时间轴不一致，因此计算时间轴应付无意义，排除时间轴",
              "    2、为保证性能，未用CROSSJOIN(ALL(各维度字段值))作为迭代表，因此使用时，各坐标轴字段应来自同一筛选链，例如：不应出现D_分包类型的字段",
              "*/"
            ],
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\结算",
            "lineageTag": "26010502-251f-4ffc-a743-d13b4c6c1252",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资付款_实付",
            "description": "M_物资付款 = SUM( 'F_采购物资付款表'[本期付款] )",
            "expression": "CALCULATE( SUM( 'F_采购物资付款表'[本期付款] ) , 'F_采购物资付款表'[单据状态]=\"已完成\")/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\付款",
            "lineageTag": "658dcebb-29e2-41f6-b411-d91089fc1cb2",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资欠款",
            "description": [
              "M_物资欠款 = ",
              " IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    [M_物资应付_价税合计]-[M_物资付款]",
              ")",
              "",
              "/*-------------------------------------",
              "补充说明：",
              "    时间轴本度量无意义，故时间轴本度量置空",
              "--------------------------------------*/"
            ],
            "expression": [
              "",
              " IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    [M_物资应付_价税合计]-[M_物资付款_实付]",
              ")",
              "/*-------------------------------------",
              "补充说明：",
              "    时间轴本度量无意义，故时间轴本度量置空",
              "--------------------------------------*/"
            ],
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\付款",
            "lineageTag": "f13f51ad-a7ed-43ce-8af5-e9687b8645e9",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资支付率",
            "description": [
              "M_物资支付率 = ",
              "IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    DIVIDE([M_物资付款],[M_物资应付_价税合计])",
              ")",
              "",
              "/*-------------------------------------",
              "补充说明：",
              "    时间轴本度量无意义，故时间轴本度量置空",
              "--------------------------------------*/",
              ")"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    DIVIDE([M_物资付款_实付],[M_物资应付_价税合计])",
              ")",
              "",
              "/*-------------------------------------",
              "补充说明：",
              "    时间轴本度量无意义，故时间轴本度量置空",
              "--------------------------------------*/"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "displayFolder": "03.采购物资\\付款",
            "lineageTag": "9b9914f7-606a-4116-8f07-b6bb2dc4892f",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资付款_在途",
            "expression": "CALCULATE( SUM( 'F_采购物资付款表'[本期付款] ) , 'F_采购物资付款表'[单据状态]=\"在途\")/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\付款",
            "lineageTag": "3f00e1d4-7584-4a80-be53-a1c46eda44bb",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_物资欠款_付款含在途",
            "expression": [
              "",
              " IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    [M_物资应付_价税合计]-[M_物资付款_实付]-[M_物资付款_在途]",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "03.采购物资\\付款",
            "lineageTag": "2fa7a71c-58ac-4874-9aba-31bd0e2b1342",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_补充协议数_物资",
            "description": "M_补充协议数_物资 = DISTINCTCOUNT('F_采购物资合同额'[补充协议号])",
            "expression": "DISTINCTCOUNT('F_采购物资合同额'[补充协议号])",
            "formatString": "0",
            "displayFolder": "03.采购物资\\计数",
            "lineageTag": "e0e3e77f-a43f-4db1-8e89-04b06634518f"
          },
          {
            "name": "M_合同数_物资",
            "description": [
              "M_合同数_物资 = ",
              "DISTINCTCOUNT ( 'F_采购物资合同额'[合同编号] )"
            ],
            "expression": [
              "",
              "DISTINCTCOUNT ( 'F_采购物资合同额'[合同编号] )"
            ],
            "formatString": "0",
            "displayFolder": "03.采购物资\\计数",
            "lineageTag": "d5452598-da9b-46a3-a565-9e81cb522970"
          },
          {
            "name": "M_项目数_物资",
            "description": [
              "M_项目数_物资 = ",
              "DISTINCTCOUNT ( 'F_采购物资合同额'[项目编码] )"
            ],
            "expression": [
              "",
              "DISTINCTCOUNT ( 'F_采购物资合同额'[项目编码] )"
            ],
            "formatString": "0",
            "displayFolder": "03.采购物资\\计数",
            "lineageTag": "92ed4a01-d451-4a18-8b60-c2a6e4c59718"
          },
          {
            "name": "M_分供数_物资",
            "description": "M_分供数_物资 = DISTINCTCOUNT('F_采购物资合同额'[供方编码])",
            "expression": "DISTINCTCOUNT('F_采购物资合同额'[供方编码])",
            "formatString": "0",
            "displayFolder": "03.采购物资\\计数",
            "lineageTag": "99b184d8-2ffa-4f85-b0b0-52e748ba321c"
          },
          {
            "name": "M_承包合同_价税合计",
            "description": [
              "M_承包合同_价税合计 = ",
              "SUM ( 'F_承包合同金额'[含税] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_承包合同金额'[含税] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "01.承包合同\\合同及结算",
            "lineageTag": "ed52af6b-14be-43be-af5b-724e3831afaa",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_承包合同_金额",
            "description": [
              "M_承包合同_金额 = ",
              "SUM ( 'F_承包合同金额'[无税] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_承包合同金额'[无税] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "01.承包合同\\合同及结算",
            "lineageTag": "50c0b4a4-348c-4e09-b1eb-bcad73e84926",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_承包合同份数",
            "expression": "DISTINCTCOUNT('F_承包合同金额'[合同编号])",
            "formatString": "0",
            "displayFolder": "01.承包合同\\合同及结算",
            "lineageTag": "237fecb0-5f55-4b69-87e6-d14cdc0536e6"
          },
          {
            "name": "M_确权_价税合计",
            "description": [
              "M_确权_价税合计 = ",
              "SUM ( 'F_业主确认量'[确认产值含税] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_业主确认量'[确认产值含税] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "01.承包合同\\确权",
            "lineageTag": "ae8240b8-f972-46f4-afa8-be485174ba4c",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_确权_金额",
            "description": [
              "M_确权_金额 = ",
              "SUM ( 'F_业主确认量'[确认产值无税] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_业主确认量'[确认产值无税] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "01.承包合同\\确权",
            "lineageTag": "d38d3b9a-e50d-4089-a0ad-ac7fcbff39d6",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_确权_税金",
            "description": [
              "M_确权_税金 = ",
              "SUM ( 'F_业主确认量'[税额] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_业主确认量'[税额] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "01.承包合同\\确权",
            "lineageTag": "ffbf9043-2654-42f1-b083-03dddef2eab5",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包合同_金额",
            "description": [
              "M_分包合同_金额 = ",
              "SUM ( 'F_分包合同额'[不含税合同价] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_分包合同额'[不含税合同价] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\合同",
            "lineageTag": "07cbc977-bbe9-4cb6-baed-11a9b4d4063f",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包合同_税金",
            "description": [
              "M_分包合同_税金 = ",
              "SUM ( 'F_分包合同额'[税金] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_分包合同额'[税金] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\合同",
            "lineageTag": "ba32895d-d3de-4697-8138-bd125b2a5e7f",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包合同_价税合计",
            "description": [
              "M_分包合同_价税合计 = ",
              "SUM ( 'F_分包合同额'[含税合同价] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_分包合同额'[含税合同价] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\合同",
            "lineageTag": "77f28bb1-92f7-40a3-84a1-91abcaa3b3e2",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_签订日期_分包补充协议（最早）",
            "description": "M_签订日期_分包补充协议（最早） = MIN('F_分包合同额'[签订日期])",
            "expression": "MIN('F_分包合同额'[签订日期])",
            "formatString": "General Date",
            "displayFolder": "02.分包\\合同",
            "lineageTag": "1bc93316-9302-48d4-ba2b-7bdc49cd9202"
          },
          {
            "name": "M_项目数_分包",
            "description": [
              "M_项目数_分包 = ",
              "DISTINCTCOUNT ( 'F_分包合同额'[项目编码] )"
            ],
            "expression": [
              "",
              "DISTINCTCOUNT ( 'F_分包合同额'[项目编码] )"
            ],
            "formatString": "0",
            "displayFolder": "02.分包\\计数",
            "lineageTag": "c606546b-d220-4b7a-9f1b-9ab57040fa42"
          },
          {
            "name": "M_合同数_分包",
            "description": [
              "M_合同数_分包 = ",
              "DISTINCTCOUNT ( 'F_分包合同额'[合同编号] )"
            ],
            "expression": [
              "",
              "DISTINCTCOUNT ( 'F_分包合同额'[合同编号] )"
            ],
            "formatString": "0",
            "displayFolder": "02.分包\\计数",
            "lineageTag": "ca42f1c0-d7c2-4520-929f-8655ae28854c",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_补充协议数_分包",
            "description": "M_补充协议数_分包 = DISTINCTCOUNT('F_分包合同额'[补充协议号])",
            "expression": "DISTINCTCOUNT('F_分包合同额'[补充协议号])",
            "formatString": "0",
            "displayFolder": "02.分包\\计数",
            "lineageTag": "9e2b6697-54a5-4c53-9384-6c1e5b22aba3"
          },
          {
            "name": "M_分包数量_合同",
            "description": "M_分包数量_合同 = DISTINCTCOUNT('F_分包合同额'[分包编码])",
            "expression": "DISTINCTCOUNT('F_分包合同额'[分包编码])",
            "formatString": "0",
            "displayFolder": "02.分包\\计数",
            "lineageTag": "718707da-2f02-4cc2-9ba6-ff6b2939bd10"
          },
          {
            "name": "M_分包报量_价税合计",
            "description": [
              "M_分包报量_价税合计 = ",
              "SUM ( 'F_分包报量表'[报量价税合计] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_分包报量表'[报量价税合计] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\报量",
            "lineageTag": "6090ec9f-7e3e-4d27-a3c5-908443f33b3e",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包报量_金额",
            "description": [
              "M_分包报量_金额 = ",
              "SUM ( 'F_分包报量表'[报量金额] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_分包报量表'[报量金额] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\报量",
            "lineageTag": "c7a85b66-2c64-4a69-be65-a2b929fe7855",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包报量_税金",
            "description": [
              "M_分包报量_税金 = ",
              "SUM ( 'F_分包报量表'[报量税额] )"
            ],
            "expression": [
              "",
              "SUM ( 'F_分包报量表'[报量税额] )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\报量",
            "lineageTag": "81332b57-ee38-45bb-b7b2-c1b1fadf9187",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包付款_在途",
            "description": [
              "M_分包付款_在途 = ",
              "CALCULATE ( SUM ( 'F_分包付款主表'[本期实际付款] ), 'F_分包付款主表'[单据状态] = \"总部处理中\" )"
            ],
            "expression": [
              "",
              "CALCULATE ( SUM ( 'F_分包付款'[本期实际付款] ), 'F_分包付款'[单据状态] = \"在途\" )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "84f03d64-a971-4786-8a48-1714228a4432",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包付款_实付",
            "description": [
              "M_分包付款_实付 = ",
              "CALCULATE ( SUM ( 'F_分包付款主表'[本期实际付款] ), 'F_分包付款主表'[单据状态] = \"已完成\" )"
            ],
            "expression": [
              "",
              "CALCULATE ( SUM ( 'F_分包付款'[本期实际付款] ), 'F_分包付款'[单据状态] = \"已完成\" )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "93b89dc3-880d-4897-9fc2-488c04226ed5",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包付款_劳务费",
            "description": [
              "M_分包付款_劳务费 = ",
              "CALCULATE ( SUM ( 'F_分包付款主表'[劳务费] ), 'F_分包付款主表'[单据状态] = \"已完成\" )"
            ],
            "expression": [
              "",
              "CALCULATE ( SUM ( 'F_分包付款'[劳务费] ), 'F_分包付款'[单据状态] = \"已完成\" )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "a8e36da0-e6d7-43b3-b559-451944f3bc3c",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包付款_其它",
            "description": [
              "M_分包付款_其它 = ",
              "    CALCULATE(",
              "        SUM('F_分包付款主表'[其它]),",
              "        'F_分包付款主表'[单据状态]=\"已完成\"",
              "    )"
            ],
            "expression": [
              "",
              "CALCULATE ( SUM ( 'F_分包付款'[其它] ), 'F_分包付款'[单据状态] = \"已完成\" )/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "3ce084bd-9e4b-4fe7-9087-dcedd037b234",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_欠分包款",
            "description": [
              "M_欠分包款 = ",
              " IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    [M_分包应付_价税合计]-[M_分包付款_实付]",
              ")"
            ],
            "expression": [
              "",
              " IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    [M_分包应付_价税合计]-[M_分包付款_实付]",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "35156445-a016-4407-a650-e688181f980f",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包支付率",
            "description": [
              "M_分包支付率 = ",
              "IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    DIVIDE([M_分包付款_实付],[M_分包应付_价税合计])",
              ")"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    DIVIDE([M_分包付款_实付],[M_分包应付_价税合计])",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "5493966d-9be6-4d6b-b519-055889cf52fc",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_欠分包款_付款含在途",
            "expression": [
              "",
              " IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    [M_分包应付_价税合计]-[M_分包付款_实付]-[M_分包付款_在途]",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\付款",
            "lineageTag": "38dd0729-6de2-4046-a1f2-ca85b6d0cc18",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包结算_价税合计",
            "description": "M_分包结算_价税合计 = SUM('F_分包结算'[含税结算额])",
            "expression": "SUM('F_分包结算'[含税结算额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\结算",
            "lineageTag": "a9e33a01-dba3-4ead-bac6-86510e06324b",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包结算_金额",
            "description": "M_分包结算_金额 = SUM('F_分包结算'[不含税结算额])",
            "expression": "SUM('F_分包结算'[不含税结算额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\结算",
            "lineageTag": "e906ce2c-831a-41d3-8d35-789d7bea343f",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_分包结算_税金",
            "description": "M_分包结算_税金 = SUM('F_分包结算'[税金])",
            "expression": "SUM('F_分包结算'[税金])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\结算",
            "lineageTag": "bc0ed429-604e-4eff-9fc1-359ccde265a7",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "_分包应付_价税合计",
            "description": [
              "_分包应付_价税合计 = ",
              "IF( ABS( [M_分包结算_价税合计] ) > 0, [M_分包结算_价税合计], [M_分包报量_价税合计] )",
              "",
              "/*",
              "中间态辅助度量，不应作为最终度量使用",
              "*/"
            ],
            "expression": [
              "",
              "IF( ABS( [M_分包结算_价税合计] ) > 0, [M_分包结算_价税合计], [M_分包报量_价税合计] )",
              "",
              "/*",
              "中间态辅助度量，不应作为最终度量使用",
              "*/"
            ],
            "formatString": "#,##0.00",
            "displayFolder": "02.分包\\结算",
            "lineageTag": "c38b3a9f-2925-4b17-8a23-ce48abee5390",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ]
          },
          {
            "name": "M_签订日期_分包结算（最晚）",
            "description": [
              "M_分包应付_价税合计 = ",
              "IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    SUMX(KEEPFILTERS(VALUES('D_分包合同'[合同编号])),[_分包应付_价税合计])",
              ")"
            ],
            "expression": "MAX( 'F_分包结算'[签订日期] )",
            "displayFolder": "02.分包\\结算",
            "lineageTag": "41ed7271-21c7-4555-8773-c7e7f55cee58"
          },
          {
            "name": "M_分包应付_价税合计",
            "description": [
              "M_分包应付_价税合计 = ",
              "IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    SUMX(KEEPFILTERS(VALUES('D_分包合同'[合同编号])),[_分包应付_价税合计])",
              ")"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    SUMX(KEEPFILTERS(VALUES('D_分包合同'[合同编号])),[_分包应付_价税合计])",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "02.分包\\结算",
            "lineageTag": "fe4f0d47-3599-480e-9e2f-7a45a3791d93",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_应上缴履约_开累",
            "description": "应上缴收益履约",
            "expression": [
              "",
              " SUMX(",
              "     VALUES('D_项目信息'[项目名称]),",
              "    LASTNONBLANKVALUE('D_日历'[日期],SUM('F_应上交收益履约'[开工累计应上缴履约]))",
              ")/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "05.应上缴收益履约",
            "lineageTag": "3b87c412-e692-4c07-bdc9-898fa363297e",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_应上缴收益_开累",
            "expression": [
              "",
              " SUMX(",
              "     VALUES('D_项目信息'[项目名称]),",
              "     LASTNONBLANKVALUE('D_日历'[日期],SUM('F_应上交收益履约'[开工累计应上缴收益]))",
              ")/SELECTEDVALUE('货币单位'[系数],1)"
            ],
            "formatString": "#,0.00",
            "displayFolder": "05.应上缴收益履约",
            "lineageTag": "de636e85-bbcf-4bf5-b5e1-b3f7528efdbb",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁合同_价税合计",
            "description": "M_租赁合同_价税合计 = SUM('F_租赁物资合同额'[价税合计])",
            "expression": "SUM('F_租赁物资合同额'[价税合计])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\合同",
            "lineageTag": "63c1fb02-912c-4335-9912-1b1ae0849fc5",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁合同_金额",
            "description": "M_租赁合同_金额 = SUM('F_租赁物资合同额'[合同额])",
            "expression": "SUM('F_租赁物资合同额'[合同额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\合同",
            "lineageTag": "ca7504ef-93c7-4cd4-9941-6fcac808f199",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁合同_税金",
            "description": "M_租赁合同_税金 = SUM('F_租赁物资合同额'[税额])",
            "expression": "SUM('F_租赁物资合同额'[税额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\合同",
            "lineageTag": "6ff603cd-e8d4-4920-887e-43a548cbc7ea",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_签订日期_租赁补充协议（最早）",
            "description": "M_签订日期_租赁补充协议（最早） = MIN( 'F_租赁物资合同额'[签订日期] )",
            "expression": "MIN( 'F_租赁物资合同额'[签订日期] )",
            "displayFolder": "04.租赁物资\\合同",
            "lineageTag": "278fc370-0c2a-4df6-b318-b3926f92631c"
          },
          {
            "name": "M_租赁进场_价税合计",
            "description": "M_租赁进场_价税合计 = SUM('F_物资租赁进场'[本月进场含税])",
            "expression": "SUM('F_物资租赁进场'[本月进场含税])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\进场",
            "lineageTag": "92ac39cb-dcee-4d71-a41e-8ec718e29de7",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁进场_金额",
            "description": "M_租赁进场_金额 = SUM('F_物资租赁进场'[本月进场不含税])",
            "expression": "SUM('F_物资租赁进场'[本月进场不含税])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\进场",
            "lineageTag": "1aabba44-5f43-4490-a79e-66018521aa78",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁进场_税金",
            "description": "M_租赁进场_税金 = SUM('F_物资租赁进场'[本月税金])",
            "expression": "SUM('F_物资租赁进场'[本月税金])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\进场",
            "lineageTag": "cf840d08-6953-462b-934f-17fc2f145eda",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁结算_价税合计",
            "description": "M_租赁结算_价税合计 = SUM('F_租赁物资结算'[含税结算额])",
            "expression": "SUM('F_租赁物资结算'[含税结算额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\结算",
            "lineageTag": "6b47b98e-e36d-4f87-8255-9aad149f7f63",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁应付_价税合计",
            "description": [
              "M_租赁应付_价税合计 = ",
              "IF(",
              "    ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    SUMX(",
              "        VALUES( 'D_租赁物资合同'[合同编号] ),",
              "        [_租赁应付_价税合计]",
              "    )",
              ")"
            ],
            "expression": [
              "",
              "IF(",
              "    ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    SUMX(",
              "        VALUES( 'D_租赁物资合同'[合同编号] ),",
              "        [_租赁应付_价税合计]",
              "    )",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\结算",
            "lineageTag": "304a1d8f-49a2-4f5f-b6c8-8566f4253ee1",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁结算_金额",
            "description": "M_租赁结算_金额 = SUM('F_租赁物资结算'[不含税结算额])",
            "expression": "SUM('F_租赁物资结算'[不含税结算额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\结算",
            "lineageTag": "778746ae-940f-4f73-8c03-5110b1de9719",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁结算_税金",
            "description": "M_租赁结算_税金 = SUM('F_租赁物资结算'[税金])",
            "expression": "SUM('F_租赁物资结算'[税金])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\结算",
            "lineageTag": "edceb50e-236c-4575-8453-998d6226b298",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "_租赁应付_价税合计",
            "expression": [
              "",
              "IF( ABS( [M_租赁结算_价税合计] ) > 0, [M_租赁结算_价税合计], [M_租赁进场_价税合计] )",
              ""
            ],
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\结算",
            "lineageTag": "27c61238-b9d2-4aff-9ea8-707913145f17",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁付款_实付",
            "description": "M_租赁付款 = SUM('F_租赁物资付款表'[金额])",
            "expression": "CALCULATE( SUM('F_租赁物资付款表'[金额]),'F_租赁物资付款表'[单据状态]=\"已完成\")/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\付款",
            "lineageTag": "b2afa83f-998e-4c10-a8d0-7a2728428226",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁欠款",
            "description": [
              "M_租赁欠款 = ",
              "IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    [M_租赁应付_价税合计]-[M_租赁付款]",
              ")"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    [M_租赁应付_价税合计]-[M_租赁付款_实付]",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\付款",
            "lineageTag": "c0df7d03-99df-46b1-8cc2-7d69aa4b908a",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁支付率",
            "description": [
              "M_租赁支付率 = ",
              " IF(ISCROSSFILTERED('D_日历'[日期]),",
              "    BLANK(),",
              "    DIVIDE([M_租赁付款],[M_租赁应付_价税合计])",
              " )"
            ],
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    DIVIDE([M_租赁付款_实付],[M_租赁应付_价税合计])",
              ")"
            ],
            "formatString": "0.00%;-0.00%;0.00%",
            "displayFolder": "04.租赁物资\\付款",
            "lineageTag": "0204e9d6-8a51-4b53-a909-eb8c26bc8754",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁付款_在途",
            "expression": "CALCULATE( SUM('F_租赁物资付款表'[金额]),'F_租赁物资付款表'[单据状态]=\"在途\")/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\付款",
            "lineageTag": "52dbdde9-a058-48b2-8873-db9afa6bc9ba",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_租赁欠款_付款含在途",
            "expression": [
              "",
              "IF(ISINSCOPE('D_日历'[年月名称]),",
              "    BLANK(),",
              "    [M_租赁应付_价税合计]-[M_租赁付款_实付]-[M_租赁付款_在途]",
              ")"
            ],
            "formatString": "#,0.00",
            "displayFolder": "04.租赁物资\\付款",
            "lineageTag": "3b274e6f-b582-42b9-b615-739ac8b48b00",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_补充协议数_租赁",
            "description": "M_补充协议数_租赁 = DISTINCTCOUNT( 'F_租赁物资合同额'[补充协议号] )",
            "expression": "DISTINCTCOUNT( 'F_租赁物资合同额'[补充协议号] )",
            "displayFolder": "04.租赁物资\\计数",
            "lineageTag": "5c61753f-3429-40e4-b4d0-8d448936dd65"
          },
          {
            "name": "M_合同数_租赁",
            "description": "M_合同数_租赁 = DISTINCTCOUNT( 'F_租赁物资合同额'[合同编号] )",
            "expression": "DISTINCTCOUNT( 'F_租赁物资合同额'[合同编号] )",
            "displayFolder": "04.租赁物资\\计数",
            "lineageTag": "3b5a298c-4e0b-4d8d-998e-40eea26137c6"
          },
          {
            "name": "M_分供数_租赁",
            "description": "M_分供数_租赁 = DISTINCTCOUNT( 'F_租赁物资合同额'[供方编码] )",
            "expression": "DISTINCTCOUNT( 'F_租赁物资合同额'[供方编码] )",
            "displayFolder": "04.租赁物资\\计数",
            "lineageTag": "37da8f3c-2327-4617-a1c6-3070e5fcd41c"
          },
          {
            "name": "M_项目数_租赁",
            "description": "M_项目数_租赁 = DISTINCTCOUNT( 'F_租赁物资合同额'[项目编码] )",
            "expression": "DISTINCTCOUNT( 'F_租赁物资合同额'[项目编码] )",
            "displayFolder": "04.租赁物资\\计数",
            "lineageTag": "31ab2f2c-b9e5-4af0-9130-97d02a93690f"
          },
          {
            "name": "刷新时间",
            "description": "刷新时间 = MAX('刷新时间'[刷新时间])",
            "expression": "\"数据更新时间：\" & MAX('刷新时间'[刷新时间])",
            "lineageTag": "7f63415d-eff6-4f59-92d1-4dbf54f49913"
          },
          {
            "name": "M_承包合同回款",
            "expression": "SUM('F_业主合同回款'[金额])/SELECTEDVALUE('货币单位'[系数],1)",
            "formatString": "0.00",
            "displayFolder": "01.承包合同\\回款",
            "lineageTag": "251b2f53-bb1f-44de-bcd8-b18132767dde",
            "annotations": [
              {
                "name": "PBI_ChangedProperties",
                "value": "[\"FormatString\"]"
              }
            ]
          },
          {
            "name": "M_下游合同额_价税合计",
            "expression": "[M_分包合同_价税合计]+[M_物资合同_价税合计]+[M_租赁合同_价税合计]",
            "formatString": "#,0.00",
            "displayFolder": "00项目级度量",
            "lineageTag": "447c77b4-2126-4556-8a5c-e06676e78209",
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ]
          },
          {
            "name": "M_下游合同付款",
            "expression": "[M_分包付款_实付]+[M_物资付款_实付]+[M_租赁付款_实付]",
            "formatString": "#,0.00",
            "displayFolder": "00项目级度量",
            "lineageTag": "b3bea443-7168-44e5-adef-5a5897da13ff"
          },
          {
            "name": "M_下游合同完成量_价税合计",
            "expression": "[M_分包报量_价税合计]+[M_物资进场_价税合计]+[M_租赁进场_价税合计]",
            "formatString": "#,0.00",
            "displayFolder": "00项目级度量",
            "lineageTag": "4bc1a042-dac5-4371-a84e-aaf820bb89ff"
          },
          {
            "name": "M_下游合同结算_价税合计",
            "expression": "[M_分包结算_价税合计]+[M_物资结算_价税合计]+[M_租赁结算_价税合计]",
            "formatString": "0.00",
            "displayFolder": "00项目级度量",
            "lineageTag": "3f067db1-15e7-4cf4-9c9e-6f0082e9f6ed"
          },
          {
            "name": "M_下游合同应付_价税合计",
            "expression": "[M_分包应付_价税合计]+[M_物资应付_价税合计]+[M_租赁应付_价税合计]",
            "formatString": "0.00",
            "displayFolder": "00项目级度量",
            "lineageTag": "b6050294-81c4-4ce4-ba2d-fc610c9c2633"
          },
          {
            "name": "M_欠分包款物资款",
            "expression": "[M_欠分包款]+[M_物资欠款]+[M_租赁欠款]",
            "formatString": "0.00",
            "displayFolder": "00项目级度量",
            "lineageTag": "4e2677c7-fb87-49f5-bf80-7085f0da9edf"
          }
        ]
      },
      {
        "name": "刷新时间",
        "columns": [
          {
            "name": "刷新时间",
            "dataType": "dateTime",
            "sourceColumn": "刷新时间"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = DateTime.LocalNow(),",
                "    转换为表 = #table(1, {{源}}),",
                "    重命名的列 = Table.RenameColumns(转换为表,{{\"Column1\", \"刷新时间\"}}),",
                "    更改的类型 = Table.TransformColumnTypes(重命名的列,{{\"刷新时间\", type datetime}})",
                "in",
                "    更改的类型"
              ]
            }
          }
        ]
      },
      {
        "name": "货币单位",
        "columns": [
          {
            "name": "货币单位",
            "dataType": "string",
            "sourceColumn": "货币单位"
          },
          {
            "name": "系数",
            "dataType": "int64",
            "sourceColumn": "系数"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WetrarKSjZKgUqxOt9GRHO5RrAAQQoV37kYQgwrEA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [货币单位 = _t, 系数 = _t]),",
                "    更改的类型 = Table.TransformColumnTypes(源,{{\"系数\", Int64.Type}})",
                "in",
                "    更改的类型"
              ]
            }
          }
        ]
      },
      {
        "name": "F_分包报量表",
        "isHidden": true,
        "columns": [
          {
            "name": "KEYID",
            "dataType": "string",
            "sourceColumn": "KEYID"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "sourceColumn": "施工专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "sourceColumn": "日期"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "报量金额",
            "dataType": "double",
            "sourceColumn": "报量金额"
          },
          {
            "name": "报量税额",
            "dataType": "double",
            "sourceColumn": "报量税额"
          },
          {
            "name": "报量价税合计",
            "dataType": "double",
            "sourceColumn": "报量价税合计"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({#\"2022年4月之前分包报量\", 新分包完成量}),",
                "    合并的查询 = Table.NestedJoin(源, {\"KEYID\"}, D_分包合同, {\"KEYID\"}, \"D_分包合同\", JoinKind.LeftOuter),",
                "    #\"展开的“D_分包合同”\" = Table.ExpandTableColumn(合并的查询, \"D_分包合同\", {\"施工专业\", \"分包类型\"}, {\"施工专业\", \"分包类型\"}),",
                "    重排序的列 = Table.ReorderColumns(#\"展开的“D_分包合同”\",{\"KEYID\", \"项目编码\", \"项目名称\", \"施工专业\", \"分包类型\", \"日期\", \"合同编号\", \"报量金额\", \"报量税额\", \"报量价税合计\"})",
                "in",
                "    重排序的列"
              ]
            }
          }
        ]
      },
      {
        "name": "F_分包付款",
        "columns": [
          {
            "name": "支付方式",
            "dataType": "string",
            "sourceColumn": "支付方式"
          },
          {
            "name": "KEYID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "KEYID"
          },
          {
            "name": "项目编码",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "项目名称"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "施工专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "分包类型"
          },
          {
            "name": "日期",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "日期"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "合同编号"
          },
          {
            "name": "本期实际付款",
            "dataType": "decimal",
            "isHidden": true,
            "sourceColumn": "本期实际付款"
          },
          {
            "name": "劳务费",
            "dataType": "decimal",
            "isHidden": true,
            "sourceColumn": "劳务费"
          },
          {
            "name": "其它",
            "dataType": "decimal",
            "isHidden": true,
            "sourceColumn": "其它"
          },
          {
            "name": "单据状态",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "单据状态"
          },
          {
            "name": "支付渠道",
            "dataType": "string",
            "sourceColumn": "支付渠道",
            "lineageTag": "bc3e864d-ef1c-4efc-8aa2-a8fba8e8d922"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({单项分包付款, 集采分包付款}),",
                "    #\"替换的值(标准化状态)\" = Table.ReplaceValue(源,each [单据状态],each if [单据状态]<>\"已完成\" then \"在途\" else [单据状态],Replacer.ReplaceText,{\"单据状态\"})",
                "in",
                "    #\"替换的值(标准化状态)\""
              ]
            }
          }
        ]
      },
      {
        "name": "权限",
        "lineageTag": "950217ca-7602-4dc6-a4a3-d28c8bf2a080",
        "calculationGroup": {
          "calculationItems": [
            {
              "name": "无限制",
              "expression": "SELECTEDMEASURE()"
            },
            {
              "name": "UserName行级权限",
              "expression": "CALCULATE(SELECTEDMEASURE(),'账户-项目'[账号]=username())"
            },
            {
              "name": "CUSTOMDATA行级权限",
              "expression": "CALCULATE(SELECTEDMEASURE(),'账户-项目'[账号]=CUSTOMDATA())"
            }
          ]
        },
        "columns": [
          {
            "name": "行级权限",
            "dataType": "string",
            "sourceColumn": "Name",
            "sortByColumn": "Ordinal",
            "lineageTag": "785952f4-5bae-4eae-8256-fd01025d53cc",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "name": "Ordinal",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Ordinal",
            "lineageTag": "3ba3d5c1-7c8e-4c61-b4c7-5bcb116edd33",
            "summarizeBy": "sum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "mode": "import",
            "source": {
              "type": "calculationGroup"
            }
          }
        ]
      },
      {
        "name": "D_标准合同",
        "columns": [
          {
            "name": "标准合同编号",
            "dataType": "string",
            "sourceColumn": "标准合同编号"
          },
          {
            "name": "标准合同名称",
            "dataType": "string",
            "sourceColumn": "标准合同名称"
          },
          {
            "name": "合同分类",
            "dataType": "string",
            "sourceColumn": "合同分类"
          },
          {
            "name": "商务科目ID",
            "dataType": "string",
            "sourceColumn": "商务科目ID"
          },
          {
            "name": "财务科目ID",
            "dataType": "string",
            "sourceColumn": "财务科目ID"
          },
          {
            "name": "合同类型",
            "dataType": "string",
            "sourceColumn": "合同类型"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = X5,",
                "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
                "    GSPM_BIAOZHUNHETONG = GSPM{[Name=\"GSPM_BIAOZHUNHETONG2020\"]}[Data],",
                "    重命名的列 = Table.RenameColumns(GSPM_BIAOZHUNHETONG,fx_List_生成字段更名列表(\"GSPM\",\"GSPM_BIAOZHUNHETONG\")),",
                "    删除的其他列 = Table.SelectColumns(重命名的列,{\"标准合同编号\", \"标准合同名称\", \"合同分类\", \"商务科目ID\", \"财务科目ID\"}),",
                "    删除的副本 = Table.Distinct(删除的其他列, {\"标准合同编号\"}),",
                "    筛选的行 = Table.SelectRows(删除的副本, each [标准合同编号] <> null and [标准合同编号] <> \"\"),",
                "    已添加自定义 = Table.AddColumn(筛选的行, \"合同类型\", each if List.Contains(集采劳务合同[编号],[标准合同编号]) then \"集采劳务合同\" else \"其它\",Text.Type)",
                "in",
                "    已添加自定义"
              ]
            }
          }
        ]
      },
      {
        "name": "D_C_支付方式",
        "lineageTag": "47459b45-8349-41fb-a920-73abae5847d1",
        "columns": [
          {
            "type": "calculatedTableColumn",
            "name": "支付方式",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "F_分包付款[支付方式]",
            "lineageTag": "93ff589c-addd-4c02-beaf-1162e89138c9",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "D_C_支付方式-b0d194ea-e1df-4e88-816f-1b37e8a71128",
            "mode": "import",
            "source": {
              "type": "calculated",
              "expression": [
                "",
                "FILTER(",
                "    DISTINCT(",
                "        UNION(",
                "            DISTINCT('F_分包付款'[支付方式]),",
                "            DISTINCT('F_采购物资付款表'[支付方式]),",
                "            DISTINCT('F_租赁物资付款表'[支付方式])",
                "        )",
                "    ),",
                "    NOT(ISBLANK([支付方式]))",
                ")"
              ]
            }
          }
        ],
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "f21589925496476c8ec779f685813754"
          }
        ]
      },
      {
        "name": "F_业主合同回款",
        "columns": [
          {
            "name": "项目编码",
            "dataType": "string",
            "sourceColumn": "项目编码"
          },
          {
            "name": "项目名称",
            "dataType": "string",
            "sourceColumn": "项目名称"
          },
          {
            "name": "实际回款日期",
            "dataType": "dateTime",
            "sourceColumn": "实际回款日期"
          },
          {
            "name": "合同编号",
            "dataType": "string",
            "sourceColumn": "合同编号"
          },
          {
            "name": "回款类型",
            "dataType": "string",
            "sourceColumn": "回款类型"
          },
          {
            "name": "施工专业",
            "dataType": "string",
            "sourceColumn": "施工专业"
          },
          {
            "name": "分包类型",
            "dataType": "string",
            "sourceColumn": "分包类型"
          },
          {
            "name": "金额",
            "dataType": "double",
            "sourceColumn": "金额"
          }
        ],
        "partitions": [
          {
            "name": "Partition",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    源 = Table.Combine({业主合同回款初始化, 业主合同回款登记})",
                "in",
                "    源"
              ]
            }
          }
        ]
      },
      {
        "name": "D_回款类型",
        "lineageTag": "e167807c-3bd2-4858-a155-b65be860fb11",
        "columns": [
          {
            "type": "calculatedTableColumn",
            "name": "回款类型",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "F_业主合同回款[回款类型]",
            "lineageTag": "10423667-e29b-4bd8-96e7-73ae728dfa5d",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "D_回款类型-d07da4e8-7bdd-4e5c-86ce-115c6dd4455f",
            "mode": "import",
            "source": {
              "type": "calculated",
              "expression": "DISTINCT('F_业主合同回款'[回款类型])"
            }
          }
        ],
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c783520450b040039f7379f0ad9529a4"
          }
        ]
      },
      {
        "name": "D_项目开工日期",
        "lineageTag": "a715157e-0169-4aa6-a388-6676afd9f556",
        "columns": [
          {
            "type": "calculatedTableColumn",
            "name": "日期",
            "dataType": "dateTime",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[日期]",
            "formatString": "General Date",
            "lineageTag": "b4eb7615-aa6a-46b9-899f-391c00ff9d76",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "日期序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[日期序号]",
            "formatString": "0",
            "lineageTag": "cadc3ec9-d382-4ecc-b4e5-1ed52896943e",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年序号]",
            "formatString": "0",
            "lineageTag": "51bde302-4db7-4c4e-b2be-1d5dcf5d4050",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年份名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年份名称]",
            "lineageTag": "e9b97e25-b96f-483a-b812-030f4407c3e5",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "季度序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[季度序号]",
            "formatString": "0",
            "lineageTag": "221083b3-96e2-4e4c-91f8-23746c445123",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "季度名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[季度名称]",
            "lineageTag": "e6ebcaf0-0a88-4618-b6e7-c7b811678aeb",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "月份序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[月份序号]",
            "formatString": "0",
            "lineageTag": "5682f71b-4efb-4378-a29b-5680d37bcd6e",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "月份名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[月份名称]",
            "lineageTag": "e5338f80-8e43-442e-959d-7a7639e82a59",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "周序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[周序号]",
            "formatString": "0",
            "lineageTag": "06f4601a-ca33-418e-8610-0abd1891c7fb",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "周名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[周名称]",
            "lineageTag": "9619f0d1-8230-4e2f-a4d6-b7b745fbad9c",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年季序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年季序号]",
            "formatString": "0",
            "lineageTag": "6c7452b0-e266-4450-a004-4d7bff467c1d",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年季名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年季名称]",
            "lineageTag": "46384d94-5ba8-4bf4-b40e-11efec3a179c",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年月序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年月序号]",
            "formatString": "0",
            "lineageTag": "78f148df-b57c-49af-9f1e-e98a13b72184",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年月名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年月名称]",
            "lineageTag": "47de755b-3c55-42db-b0c4-cfd1d0880acf",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年周序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年周序号]",
            "formatString": "0",
            "lineageTag": "a9255205-1aba-4419-8586-98176b38ae99",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "年周名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[年周名称]",
            "lineageTag": "1435b283-e20d-419f-9c3e-a97cdbdbdaa1",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "日序号",
            "dataType": "int64",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[日序号]",
            "formatString": "0",
            "lineageTag": "b8df3c04-dee3-4767-b69c-57c453924420",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "周天名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[周天名称]",
            "lineageTag": "6970a0f7-40c4-4ce6-b513-9db0ee21eb1e",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "工作日",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[工作日]",
            "lineageTag": "deb61a55-12b4-4169-9920-d1c1f5df0f33",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculatedTableColumn",
            "name": "日名称",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_日历[日名称]"
          }
        ],
        "partitions": [
          {
            "name": "D_项目开工日期-ece99377-8b12-48b0-9f9c-a5e32d4e0a84",
            "mode": "import",
            "source": {
              "type": "calculated",
              "expression": "'D_日历'"
            }
          }
        ],
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "55ff94244bd34e1388493467d7414f4e"
          }
        ]
      },
      {
        "name": "D_合同业务类别",
        "lineageTag": "95bab213-65eb-4d41-973b-46f354d02fc1",
        "columns": [
          {
            "type": "calculatedTableColumn",
            "name": "业务类别",
            "dataType": "string",
            "isNameInferred": true,
            "isDataTypeInferred": true,
            "sourceColumn": "D_分包合同[业务类别]",
            "lineageTag": "6f40123a-680e-433d-95e8-c635e3adecc3",
            "summarizeBy": "none",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          },
          {
            "type": "calculated",
            "name": "业务类别 (组)",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": [
              "SWITCH(",
              "  TRUE,",
              "  ISBLANK('D_合同业务类别'[业务类别]),",
              "  \"(空白)\",",
              "  'D_合同业务类别'[业务类别] IN {\"集采分包框架评审\",",
              "    \"集采租赁\",",
              "    \"统一转账\"},",
              "  \"集采框架合同\",",
              "  'D_合同业务类别'[业务类别] IN {\"集采分包补充合同评审\",",
              "    \"统一转账补充\",",
              "    \"项目组织分包合同补充评审\",",
              "    \"项目组织分包合同评审\",",
              "    \"指定分包合同评审\",",
              "    \"指定物资采购\",",
              "    \"指定物资采购补充\",",
              "    \"专项\",",
              "    \"专项补充\",",
              "    \"租赁\"},",
              "  \"专项及补充协议\",",
              "  'D_合同业务类别'[业务类别]",
              ")"
            ],
            "lineageTag": "098b11f6-e4f8-4c2c-aa34-5e1ef4a4e188",
            "summarizeBy": "none",
            "extendedProperties": [
              {
                "type": "json",
                "name": "GroupingMetadata",
                "value": {
                  "version": 0,
                  "groupedColumns": [
                    {
                      "Column": {
                        "Expression": {
                          "SourceRef": {
                            "Entity": "D_合同业务类别"
                          }
                        },
                        "Property": "业务类别"
                      }
                    }
                  ]
                }
              }
            ],
            "annotations": [
              {
                "name": "GroupingDesignState",
                "value": "{\"Version\":0,\"Sources\":[{\"Name\":\"d\",\"Entity\":\"D_合同业务类别\"}],\"GroupedColumns\":[{\"Column\":{\"Expression\":{\"SourceRef\":{\"Source\":\"d\"}},\"Property\":\"业务类别\"}}],\"GroupItems\":[{\"DisplayName\":\"(空白)\",\"BlankDefaultPlaceholder\":true},{\"DisplayName\":\"集采框架合同\",\"Expression\":{\"In\":{\"Expressions\":[{\"Column\":{\"Expression\":{\"SourceRef\":{\"Source\":\"d\"}},\"Property\":\"业务类别\"}}],\"Values\":[[{\"Literal\":{\"Value\":\"'集采分包框架评审'\"}}],[{\"Literal\":{\"Value\":\"'集采租赁'\"}}],[{\"Literal\":{\"Value\":\"'统一转账'\"}}]]}}},{\"DisplayName\":\"专项及补充协议\",\"Expression\":{\"In\":{\"Expressions\":[{\"Column\":{\"Expression\":{\"SourceRef\":{\"Source\":\"d\"}},\"Property\":\"业务类别\"}}],\"Values\":[[{\"Literal\":{\"Value\":\"'集采分包补充合同评审'\"}}],[{\"Literal\":{\"Value\":\"'统一转账补充'\"}}],[{\"Literal\":{\"Value\":\"'项目组织分包合同补充评审'\"}}],[{\"Literal\":{\"Value\":\"'项目组织分包合同评审'\"}}],[{\"Literal\":{\"Value\":\"'指定分包合同评审'\"}}],[{\"Literal\":{\"Value\":\"'指定物资采购'\"}}],[{\"Literal\":{\"Value\":\"'指定物资采购补充'\"}}],[{\"Literal\":{\"Value\":\"'专项'\"}}],[{\"Literal\":{\"Value\":\"'专项补充'\"}}],[{\"Literal\":{\"Value\":\"'租赁'\"}}]]}}}]}"
              },
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ]
          }
        ],
        "partitions": [
          {
            "name": "D_合同业务类别-bdf1a6e1-2bbd-4c36-81d2-e9efd780842b",
            "mode": "import",
            "source": {
              "type": "calculated",
              "expression": [
                "",
                "UNION(",
                "    DISTINCT('D_分包合同'[业务类别]),",
                "    DISTINCT('D_采购物资合同'[业务小类]),",
                "    DISTINCT('D_租赁物资合同'[业务小类])",
                " )"
              ]
            }
          }
        ],
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "7eaa1c1643a64cccb80140528d48df0b"
          }
        ]
      }
    ],
    "relationships": [
      {
        "name": "2cb07c91-3a2f-4f69-9fbb-49427653810a",
        "fromTable": "D_采购物资合同",
        "fromColumn": "标准合同编码",
        "toTable": "D_标准合同",
        "toColumn": "标准合同编号"
      },
      {
        "name": "2b8f6bd4-f950-4604-ac62-8c75a6120890",
        "fromTable": "D_采购物资合同",
        "fromColumn": "商务科目ID",
        "toTable": "D_商务科目",
        "toColumn": "FID"
      },
      {
        "name": "40c9443b-e460-42df-855a-de1193653d3b",
        "fromTable": "D_采购物资合同",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码"
      },
      {
        "name": "4f2d11d9-92e2-44e9-ab59-dce32ad06afe",
        "fromTable": "D_承包合同",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码"
      },
      {
        "name": "65251883-e9f5-4ad2-a14a-c9084753e66b",
        "fromTable": "D_分包合同",
        "fromColumn": "标准合同编码",
        "toTable": "D_标准合同",
        "toColumn": "标准合同编号"
      },
      {
        "name": "48d627f2-38ee-4067-a7db-37a5d5627e50",
        "fromTable": "D_分包合同",
        "fromColumn": "商务科目ID",
        "toTable": "D_商务科目",
        "toColumn": "FID"
      },
      {
        "name": "432e2d67-7778-4f93-9d4b-f4d4b9f4e406",
        "fromTable": "D_分包合同",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码"
      },
      {
        "name": "a843da54-1ef7-4fb5-a37e-7a02d972c0b3",
        "fromTable": "D_项目信息",
        "fromColumn": "责任体",
        "toTable": "D-责任体",
        "toColumn": "责任体"
      },
      {
        "name": "84a76c2a-df9b-4051-a19b-85bac157e44f",
        "fromTable": "D_租赁物资合同",
        "fromColumn": "标准合同编码",
        "toTable": "D_标准合同",
        "toColumn": "标准合同编号"
      },
      {
        "name": "31415f02-47c5-4237-862f-d14eeb1afad4",
        "fromTable": "D_租赁物资合同",
        "fromColumn": "商务科目ID",
        "toTable": "D_商务科目",
        "toColumn": "FID"
      },
      {
        "name": "22ed431a-fb1b-4846-9884-2c6ba6064257",
        "fromTable": "D_租赁物资合同",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码"
      },
      {
        "name": "7704919e-cf8d-4559-9dcd-b9cc3ffbb9e6",
        "fromTable": "F_采购物资付款表",
        "fromColumn": "C_分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "cc272229-e504-492f-82f8-d2b10786b628",
        "fromTable": "F_采购物资付款表",
        "fromColumn": "C_施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "6971ad76-e077-4e0e-8179-76fdb9a8b08f",
        "fromTable": "F_采购物资付款表",
        "fromColumn": "KEYID",
        "toTable": "D_采购物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "65b2d8d1-70df-4820-892a-548168477ffa",
        "fromTable": "F_采购物资付款表",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "0616a545-daa4-44c7-8473-b74f7d3dfbf0",
        "fromTable": "F_采购物资付款表",
        "fromColumn": "支付方式",
        "toTable": "D_C_支付方式",
        "toColumn": "支付方式"
      },
      {
        "name": "60ef4f56-c6b8-427e-a902-b00ef0d61b43",
        "fromTable": "F_采购物资合同额",
        "fromColumn": "KEYID",
        "toTable": "D_采购物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "8a880f3b-073f-4f2d-80d8-2f60d31dc809",
        "fromTable": "F_采购物资合同额",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "39a7be3e-048d-4598-8451-0bedf7f0e6c0",
        "fromTable": "F_采购物资合同额",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "d5a289b6-fba1-4cc8-8782-18f8ea574326",
        "fromTable": "F_采购物资合同额",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "88b2d0de-620d-487d-a0f4-9d4f436f5765",
        "fromTable": "F_采购物资结算",
        "fromColumn": "C_分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "8f54a8ae-c689-49d4-b12b-c5f789e237fa",
        "fromTable": "F_采购物资结算",
        "fromColumn": "C_施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "d6c8274c-1843-43fb-9d6c-fe8aecc881f3",
        "fromTable": "F_采购物资结算",
        "fromColumn": "KEYID",
        "toTable": "D_采购物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "a1fe05de-578b-4b5f-a20e-9ca1f0de0f36",
        "fromTable": "F_采购物资结算",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "e575a870-2e0d-4eaf-8ce6-08a027012acd",
        "fromTable": "F_采购物资进场",
        "fromColumn": "KEYID",
        "toTable": "D_采购物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "f3b78bdc-a1ba-4a3c-8d5e-caa35fbd89c6",
        "fromTable": "F_采购物资进场",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "b12494aa-b208-4a42-9222-7070d22fbef4",
        "fromTable": "F_采购物资进场",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "1e4870bf-a5a1-4b96-9011-1865e3888f78",
        "fromTable": "F_采购物资进场",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "e755457b-df6e-47a6-8b84-7e353dc1012c",
        "fromTable": "F_采购物资退场",
        "fromColumn": "KEYID",
        "toTable": "D_采购物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "959212fc-8b93-44c6-96c4-bf5d3f393052",
        "fromTable": "F_采购物资退场",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "4e8bcaca-0f90-4b56-a3b1-eefd863f71f3",
        "fromTable": "F_采购物资退场",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "0e9a9acb-7167-41ed-ba8c-4b283022f3f1",
        "fromTable": "F_采购物资退场",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "b1ee4478-ccfe-4c68-9971-5dd0a75d2659",
        "fromTable": "F_承包合同金额",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "简称"
      },
      {
        "name": "12ad0902-9059-46a0-86ea-341cde4ed6cd",
        "fromTable": "F_承包合同金额",
        "fromColumn": "合同编号",
        "toTable": "D_承包合同",
        "toColumn": "合同编号"
      },
      {
        "name": "c08c50bc-f6db-4e29-bbe1-215a74cd4b50",
        "fromTable": "F_承包合同金额",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "d122e0f6-34be-429f-aa71-c05e4bd4f1a2",
        "fromTable": "F_承包合同金额",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "c021385d-21c2-4e7a-b516-2d2c2ad21f49",
        "fromTable": "F_分包报量表",
        "fromColumn": "KEYID",
        "toTable": "D_分包合同",
        "toColumn": "KEYID"
      },
      {
        "name": "89d17150-3293-4cc6-8147-94f16a78499e",
        "fromTable": "F_分包报量表",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "fd89dbee-05db-4f90-9cda-62a10667b574",
        "fromTable": "F_分包报量表",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "a5fe8eed-1ced-408d-9736-a1c73af0adab",
        "fromTable": "F_分包报量表",
        "fromColumn": "施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "82ddc28f-9b6c-426a-9a13-919d36ca5ceb",
        "fromTable": "F_分包付款",
        "fromColumn": "KEYID",
        "toTable": "D_分包合同",
        "toColumn": "KEYID"
      },
      {
        "name": "41f6c9f8-4c2f-49ed-b51e-4eb5b515534b",
        "fromTable": "F_分包付款",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "54e240d8-5358-4dbd-af66-aedffc0887b1",
        "fromTable": "F_分包付款",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "be6fadc8-81b8-47f3-bcc6-070ec3269d09",
        "fromTable": "F_分包付款",
        "fromColumn": "施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "a67ba386-106f-4387-9eac-6ebad5bff9de",
        "fromTable": "F_分包付款",
        "fromColumn": "支付方式",
        "toTable": "D_C_支付方式",
        "toColumn": "支付方式"
      },
      {
        "name": "0d05ffc4-4a04-43d0-b940-8deb379eb51b",
        "fromTable": "F_分包合同额",
        "fromColumn": "KEYID",
        "toTable": "D_分包合同",
        "toColumn": "KEYID"
      },
      {
        "name": "6c595a3a-7e36-4436-9e06-e66904647351",
        "fromTable": "F_分包合同额",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "5b2f466d-e54e-4fe1-b12f-9daf1fb04f24",
        "fromTable": "F_分包合同额",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "92a66a36-db1e-4238-8e37-8eea40e2d136",
        "fromTable": "F_分包合同额",
        "fromColumn": "施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "b8e2d416-bdc3-48d4-b53c-b6a63bc13c0c",
        "fromTable": "F_分包结算",
        "fromColumn": "C_分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "c7b9e75e-9302-4a11-8941-e5c9db05ad44",
        "fromTable": "F_分包结算",
        "fromColumn": "C_施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "5dd128c3-2171-453b-a24c-3d54dbc860fb",
        "fromTable": "F_分包结算",
        "fromColumn": "KEYID",
        "toTable": "D_分包合同",
        "toColumn": "KEYID"
      },
      {
        "name": "1d754e12-1f3d-46fc-a4c9-6c88605f64b9",
        "fromTable": "F_分包结算",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "ccb8a58f-1110-49d0-a0b1-2b739e3a3f3b",
        "fromTable": "F_物资租赁进场",
        "fromColumn": "KEYID",
        "toTable": "D_租赁物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "47125973-c857-4408-94b0-daedb4aeccc9",
        "fromTable": "F_物资租赁进场",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "9854ed6a-7350-4d70-a197-0be95fb83ab9",
        "fromTable": "F_物资租赁进场",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "0f5945c0-8a5f-41c4-9123-78c4cb83ac01",
        "fromTable": "F_物资租赁进场",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "d103135c-0050-421a-a69e-6507a3ef57d3",
        "fromTable": "F_业主确认量",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "e43eeee3-9d3f-4408-b4af-114a84317808",
        "fromTable": "F_业主确认量",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "36927c55-82ca-407a-b98b-d57002bd938e",
        "fromTable": "F_业主确认量",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码"
      },
      {
        "name": "db31d1d5-42bc-4158-8718-5a30ac13d841",
        "fromTable": "F_业主确认量",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "6ad5465f-c31a-4af8-98ed-2c29f2c408ea",
        "fromTable": "F_应上交收益履约",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "674492bf-3d07-40f2-9d15-3ac2aa4837df",
        "fromTable": "F_应上交收益履约",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码"
      },
      {
        "name": "6b88acca-a63f-4005-8320-d36d8ef70dd2",
        "fromTable": "F_租赁物资付款表",
        "fromColumn": "C_分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "8258637e-b778-46a2-9fed-cab26f3182a2",
        "fromTable": "F_租赁物资付款表",
        "fromColumn": "C_施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "b037913a-08ef-4391-be04-353cedac8c71",
        "fromTable": "F_租赁物资付款表",
        "fromColumn": "KEYID",
        "toTable": "D_租赁物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "a83ab41d-e819-41a7-8102-4bf71c64a687",
        "fromTable": "F_租赁物资付款表",
        "fromColumn": "日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "c7910e50-1b95-4f58-87f0-681196353d53",
        "fromTable": "F_租赁物资付款表",
        "fromColumn": "支付方式",
        "toTable": "D_C_支付方式",
        "toColumn": "支付方式"
      },
      {
        "name": "a92efc12-3b1a-435e-b775-1ca76e9d0c24",
        "fromTable": "F_租赁物资合同额",
        "fromColumn": "KEYID",
        "toTable": "D_租赁物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "fc97d43b-e337-4dc1-ad70-c158468ce80d",
        "fromTable": "F_租赁物资合同额",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "3bfb7fa4-b16e-4c2e-9909-4b03525cd538",
        "fromTable": "F_租赁物资合同额",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "bace8185-d957-4e69-b699-95c6c7d4c3ed",
        "fromTable": "F_租赁物资合同额",
        "fromColumn": "专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "419dad84-d9b2-4791-b2be-d364a622f64f",
        "fromTable": "F_租赁物资结算",
        "fromColumn": "C_分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "5d38b4a5-75f3-4230-a430-a4a48e41ba75",
        "fromTable": "F_租赁物资结算",
        "fromColumn": "C_施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "b7ce866e-9b12-4bea-9294-6d571c9831e9",
        "fromTable": "F_租赁物资结算",
        "fromColumn": "KEYID",
        "toTable": "D_租赁物资合同",
        "toColumn": "KEYID"
      },
      {
        "name": "73e48274-bd36-46ec-ae66-5a0f7a19f6fe",
        "fromTable": "F_租赁物资结算",
        "fromColumn": "签订日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "9a8cbe69-85d0-4866-9cbf-1deebccf3254",
        "fromTable": "账户-项目",
        "fromColumn": "项目编码",
        "toTable": "D_项目信息",
        "toColumn": "项目编码",
        "crossFilteringBehavior": "bothDirections",
        "securityFilteringBehavior": "bothDirections"
      },
      {
        "name": "baf9b717-bc56-4ede-a9fe-e7ca68a1be5a",
        "fromTable": "F_业主合同回款",
        "fromColumn": "分包类型",
        "toTable": "D_分包类型",
        "toColumn": "分包类型"
      },
      {
        "name": "f5cfe88b-28d8-4ec8-858f-6e031e0d8ee1",
        "fromTable": "F_业主合同回款",
        "fromColumn": "合同编号",
        "toTable": "D_承包合同",
        "toColumn": "合同编号"
      },
      {
        "name": "c3fa1fe8-5c1c-4a75-86de-65e62993868a",
        "fromTable": "F_业主合同回款",
        "fromColumn": "回款类型",
        "toTable": "D_回款类型",
        "toColumn": "回款类型"
      },
      {
        "name": "a0a1890f-6084-4f66-857e-5a296b738952",
        "fromTable": "F_业主合同回款",
        "fromColumn": "施工专业",
        "toTable": "D_施工专业",
        "toColumn": "施工专业"
      },
      {
        "name": "9d9d3c49-6a8c-4939-a4f7-a46084110836",
        "fromTable": "F_业主合同回款",
        "fromColumn": "实际回款日期",
        "toTable": "D_日历",
        "toColumn": "日期"
      },
      {
        "name": "6a886872-011f-4074-ac35-e659f12c861c",
        "fromTable": "D_项目信息",
        "fromColumn": "实际开工日期",
        "toTable": "D_项目开工日期",
        "toColumn": "日期"
      },
      {
        "name": "51be9e63-c7a6-4c7b-b163-a2bc328eb02b",
        "fromTable": "D_采购物资合同",
        "fromColumn": "业务小类",
        "toTable": "D_合同业务类别",
        "toColumn": "业务类别"
      },
      {
        "name": "9eff44d1-e87a-4f4f-aee4-c126657cb6a4",
        "fromTable": "D_分包合同",
        "fromColumn": "业务类别",
        "toTable": "D_合同业务类别",
        "toColumn": "业务类别"
      },
      {
        "name": "f3be0e82-acaf-483f-835c-36e4b92d21d7",
        "fromTable": "D_租赁物资合同",
        "fromColumn": "业务小类",
        "toTable": "D_合同业务类别",
        "toColumn": "业务类别"
      }
    ],
    "roles": [
      {
        "name": "Reader",
        "modelPermission": "read",
        "members": [
          {
            "memberName": "CHINAONEBUILD\\linhong",
            "memberId": "S-1-5-21-1606980848-1844823847-725345543-5972"
          },
          {
            "memberName": "BUILTIN\\Users",
            "memberId": "S-1-5-32-545"
          }
        ]
      }
    ],
    "expressions": [
      {
        "name": "X5",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Oracle.Database(\"172.16.8.78/oracledb\", [HierarchicalNavigation=true])",
          "in",
          "    源"
        ]
      },
      {
        "name": "GSPM_JLYZQUERENWANCENGLIANG（业主确认量主表）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_JLYZQUERENWANCENGLIANG1 = GSPM{[Name=\"GSPM_JLYZQUERENWANCENGLIANG\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_JLYZQUERENWANCENGLIANG1, each ([FPINGSHENZHUANGTAI] = \"已完成\")),",
          "    重命名的列 = Table.RenameColumns(筛选的行,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "确认量主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_JLYZQUERENWANCENGLIANG（业主确认量主表）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"年\", \"月\", \"项目编码\", \"项目名称\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "GSPM_WANCHENGLIANGMX（业主确认量明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WANCHENGLIANGMX1 = GSPM{[Name=\"GSPM_WANCHENGLIANGMX\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_WANCHENGLIANGMX1,{{\"FSHIGONGZHUANYE\", \"专业\"}, {\"FBYQRCZWS\", \"确认产值无税\"}, {\"FBYQRCZSE\", \"税额\"}, {\"FFENBAOHETONGCODE\", \"分包类型\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "确认量明细",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WANCHENGLIANGMX（业主确认量明细）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"分包类型\", \"FZBID\", \"专业\", \"确认产值无税\", \"税额\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "新业主确认量",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(确认量主表, {\"FID\"}, 确认量明细, {\"FZBID\"}, \"确认量明细\", JoinKind.Inner),",
          "    #\"展开的“确认量明细”\" = Table.ExpandTableColumn(源, \"确认量明细\", {\"分包类型\", \"专业\", \"确认产值无税\", \"税额\"}, {\"分包类型\", \"专业\", \"确认产值无税\", \"税额\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“确认量明细”\",{\"FID\"}),",
          "    // 内容是合同号的，全是指定分包",
          "    替换的值 = Table.ReplaceValue(删除的列,each [分包类型] ,each if [分包类型]<>\"自施\" then \"指定分包\" else \"自施\",Replacer.ReplaceText,{\"分包类型\"}),",
          "    计算日期 = Table.AddColumn(替换的值, \"日期\", each #date([年],[月],1),type date),",
          "    计算含税确认量 = Table.AddColumn(计算日期, \"确认产值含税\", each List.Sum({[确认产值无税],[税额]}),type number),",
          "    删除的列1 = Table.RemoveColumns(计算含税确认量,{\"年\", \"月\"})",
          "in",
          "    删除的列1"
        ]
      },
      {
        "name": "GSPM_WANCHENGLIANGJIEZHUANCB",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WANCHENGLIANGJIEZHUANCB1 = GSPM{[Name=\"GSPM_WANCHENGLIANGJIEZHUANCB\"]}[Data]",
          "in",
          "    GSPM_WANCHENGLIANGJIEZHUANCB1"
        ]
      },
      {
        "name": "确认量历史年度结算表从表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_WANCHENGLIANGJIEZHUANCB,",
          "    删除的其他列 = Table.SelectColumns(源,{\"FKLTUJIANZISHIHS\", \"FKLTUJIANZISHIWS\", \"FKLTUJIANZHIDINGHS\", \"FKLTUJIANZHIDINGWS\", \"FKLJIANDIANZISHIHS\", \"FKLJIDIANZISHIWS\", \"FKLJIDIANZHIDINGHS\", \"FKLJIDIANZHIDINGWS\", \"FNLTJZSCZHS\", \"FNLTJZSCZWS\", \"FNLTJZDCZHS\", \"FNLTJZDCZWS\", \"FNLJDZSCZHS\", \"FNLJDZSCZWS\", \"FNLJDZDCZHS\", \"FNLJDZDCZWS\", \"FZBID\"}),",
          "    // 由于用完整汉字，字段名会超出oracle字段名长度限制，因此首字母表示：",
          "    // t-土建；j-机电；z-自施；d-指定；h-含税；w-无税",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FKLTUJIANZISHIHS\", \"2019-12/t-z-h\"}, {\"FKLTUJIANZISHIWS\", \"2019-12/t-z-w\"}, {\"FKLTUJIANZHIDINGHS\", \"2019-12/t-d-h\"}, {\"FKLTUJIANZHIDINGWS\", \"2019-12/t-d-w\"}, {\"FKLJIANDIANZISHIHS\", \"2019-12/j-z-h\"}, {\"FKLJIDIANZISHIWS\", \"2019-12/j-z-w\"}, {\"FKLJIDIANZHIDINGHS\", \"2019-12/j-d-h\"}, {\"FKLJIDIANZHIDINGWS\", \"2019-12/j-d-w\"}, {\"FNLTJZSCZHS\", \"2020-5/t-z-h\"}, {\"FNLTJZSCZWS\", \"2020-5/t-z-w\"}, {\"FNLTJZDCZHS\", \"2020-5/t-d-h\"}, {\"FNLTJZDCZWS\", \"2020-5/t-d-w\"}, {\"FNLJDZSCZHS\", \"2020-5/j-z-h\"}, {\"FNLJDZSCZWS\", \"2020-5/j-z-w\"}, {\"FNLJDZDCZHS\", \"2020-5/j-d-h\"}, {\"FNLJDZDCZWS\", \"2020-5/j-d-w\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_WANCHENGLIANGJIEZHUANZB",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WANCHENGLIANGJIEZHUANZB1 = GSPM{[Name=\"GSPM_WANCHENGLIANGJIEZHUANZB\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_WANCHENGLIANGJIEZHUANZB1, each ([FPINGSHENZHUANGTAI] = \"已完成\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "确认量历史年度结算表主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_WANCHENGLIANGJIEZHUANZB,",
          "    删除的其他列 = Table.SelectColumns(源,{\"FXIANGMUBIANMA\", \"FXIANGMUMINGCHENG\", \"FID\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "结转确认量",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(确认量历史年度结算表从表, {\"FZBID\"}, 确认量历史年度结算表主表, {\"FID\"}, \"确认量历史年度结算表主表\", JoinKind.Inner),",
          "    #\"展开的“确认量历史年度结算表主表”\" = Table.ExpandTableColumn(源, \"确认量历史年度结算表主表\", {\"项目编码\", \"项目名称\"}, {\"项目编码\", \"项目名称\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“确认量历史年度结算表主表”\",{\"FZBID\"}),",
          "    逆透视的其他列 = Table.UnpivotOtherColumns(删除的列, {\"项目编码\", \"项目名称\"}, \"属性\", \"值\"),",
          "    按分隔符拆分列 = Table.SplitColumn(逆透视的其他列, \"属性\", Splitter.SplitTextByDelimiter(\"/\", QuoteStyle.Csv), {\"日期\", \"属性.2\"}),",
          "    已分析的日期 = Table.TransformColumns(按分隔符拆分列,{{\"日期\", each Date.From(DateTimeZone.From(_)), type date}}),",
          "    按分隔符拆分列1 = Table.SplitColumn(已分析的日期, \"属性.2\", Splitter.SplitTextByDelimiter(\"-\", QuoteStyle.Csv), {\"专业\", \"分包类型\", \"属性.2.3\"}),",
          "    替换的值 = Table.ReplaceValue(按分隔符拆分列1,\"t\",\"土建\",Replacer.ReplaceText,{\"专业\"}),",
          "    替换的值1 = Table.ReplaceValue(替换的值,\"j\",\"机电\",Replacer.ReplaceText,{\"专业\"}),",
          "    替换的值2 = Table.ReplaceValue(替换的值1,\"z\",\"自施\",Replacer.ReplaceText,{\"分包类型\"}),",
          "    替换的值3 = Table.ReplaceValue(替换的值2,\"d\",\"指定分包\",Replacer.ReplaceText,{\"分包类型\"}),",
          "    替换的值4 = Table.ReplaceValue(替换的值3,\"h\",\"确认产值含税\",Replacer.ReplaceText,{\"属性.2.3\"}),",
          "    替换的值5 = Table.ReplaceValue(替换的值4,\"w\",\"确认产值无税\",Replacer.ReplaceText,{\"属性.2.3\"}),",
          "    已透视列 = Table.Pivot(替换的值5, List.Distinct(替换的值5[属性.2.3]), \"属性.2.3\", \"值\", List.Sum)",
          "in",
          "    已透视列"
        ]
      },
      {
        "name": "fx_List_生成字段更名列表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = (OWNER as text,TABLE_NAME as text) as list => let",
          "        源 =  X5,",
          "        源1=Value.NativeQuery(源,\"select COLUMN_NAME,COMMENTS from all_col_comments where OWNER = '\" & OWNER &\"' and TABLE_NAME = '\" & TABLE_NAME & \"'\"),",
          "        替换的值 = Table.ReplaceValue(源1,null, each [COLUMN_NAME],Replacer.ReplaceValue,{\"COMMENTS\"}),",
          "        更改的类型 = Table.TransformColumnTypes(替换的值,{{\"COMMENTS\", type text}}),",
          "        删除的副本 = Table.Distinct(更改的类型, {\"COMMENTS\"}),",
          "        缩短说明字段长度=Table.TransformColumns(删除的副本, {{\"COMMENTS\", each Text.Start(_,15), type text}}),",
          "        自定义1 = List.Zip({缩短说明字段长度[COLUMN_NAME],缩短说明字段长度[COMMENTS]})",
          "    in",
          "        自定义1",
          "in",
          "    源"
        ]
      },
      {
        "name": "picc",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Oracle.Database(\"172.16.8.127/racdb.com\", [HierarchicalNavigation=true])",
          "in",
          "    源"
        ]
      },
      {
        "name": "PingZhengKu",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Oracle.Database(\"172.16.8.199/orcl\", [HierarchicalNavigation=true])",
          "in",
          "    源"
        ]
      },
      {
        "name": "MD_XIANGMUXINXI",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    MD = 源{[Schema=\"MD\"]}[Data],",
          "    MD_XIANGMUXINXI = MD{[Name=\"MD_XIANGMUXINXI\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(MD_XIANGMUXINXI,fx_List_生成字段更名列表(\"MD\",\"MD_XIANGMUXINXI\")),",
          "    #\"停止折叠（取消后续会出错）\" = Table.StopFolding(重命名的列)",
          "in",
          "    #\"停止折叠（取消后续会出错）\""
        ]
      },
      {
        "name": "MD_SHANGWUKEMU2020",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    MD = 源{[Schema=\"MD\"]}[Data],",
          "    MD_SHANGWUKEMU2020 = MD{[Name=\"MD_SHANGWUKEMU2020\"]}[Data]",
          "in",
          "    MD_SHANGWUKEMU2020"
        ]
      },
      {
        "name": "D-责任体",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 责任体",
          "in",
          "    源"
        ]
      },
      {
        "name": "D_施工专业",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 施工专业",
          "in",
          "    源"
        ]
      },
      {
        "name": "D_分包类型",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 分包类型",
          "in",
          "    源"
        ]
      },
      {
        "name": "D_商务科目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 商务科目",
          "in",
          "    源"
        ]
      },
      {
        "name": "D_日历",
        "kind": "m",
        "expression": [
          "let",
          "    x = 2000,",
          "    y = Date.Year(DateTime.FixedLocalNow()),",
          "    begin_date = if x = null then #date(Date.Year(DateTime.LocalNow()),1,1) else #date(x,1,1),",
          "    end_date = if y = null then #date(Date.Year(DateTime.LocalNow()),12,31) else #date(y,12,31),",
          "    list = {1..Number.From(end_date)-Number.From(begin_date)+1},",
          "    dates = List.Transform( list , (item)=> Date.AddDays(begin_date,item-1) ),",
          "    table = Table.TransformColumnTypes(Table.RenameColumns(Table.FromList(dates, Splitter.SplitByNothing(), null, null, ExtraValues.Error),{{\"Column1\", \"日期\"}}),{{\"日期\", type date}}),",
          "    date_id = Table.TransformColumnTypes(Table.AddColumn(table, \"日期序号\", each Date.Year([日期])*10000+Date.Month([日期])*100+Date.Day([日期])),{{\"日期序号\", Int64.Type}}),",
          "    year_id = Table.AddColumn(date_id, \"年序号\", each Date.Year([日期]), Int64.Type),",
          "    year_name = Table.AddColumn(year_id, \"年份名称\", each Text.From([年序号])&\"年\",Text.Type),",
          "    quarter_id = Table.AddColumn(year_name, \"季度序号\", each Date.QuarterOfYear([日期]), Int64.Type),",
          "    quarter_name = Table.AddColumn(quarter_id, \"季度名称\", each Text.From([季度序号])&\"季\",Text.Type),",
          "    month_id = Table.AddColumn(quarter_name, \"月份序号\", each Date.Month([日期]), Int64.Type),",
          "    month_name = Table.AddColumn(month_id, \"月份名称\", each Text.PadStart(Text.From([月份序号]),2,\"0\")&\"月\",Text.Type),",
          "    week_id = Table.AddColumn(month_name, \"周序号\", each Date.WeekOfYear([日期]), Int64.Type),",
          "    week_name = Table.AddColumn(week_id, \"周名称\", each Text.PadStart(Text.From([周序号]),2,\"0\")&\"周\",Text.Type),",
          "    year_quarter_id = Table.AddColumn(week_name, \"年季序号\", each Date.Year([日期])*10+Date.QuarterOfYear([日期]), Int64.Type),",
          "    year_quarter_name = Table.AddColumn(year_quarter_id, \"年季名称\", each \"YQ\"&Text.From([年季序号]),Text.Type),",
          "    year_month_id = Table.AddColumn(year_quarter_name, \"年月序号\", each Date.Year([日期])*100+ Date.Month([日期]), Int64.Type),",
          "    year_month_name = Table.AddColumn(year_month_id, \"年月名称\", each [年份名称]&[月份名称],type text),",
          "    year_week_id = Table.AddColumn(year_month_name, \"年周序号\", each Date.Year([日期])*100+ Date.WeekOfYear([日期]), Int64.Type),",
          "    #\"year_week-name\" = Table.AddColumn(year_week_id, \"年周名称\", each \"YW\"&Text.From([年周序号]),Text.Type),",
          "    day_in_week_id = Table.AddColumn(#\"year_week-name\", \"日序号\", each Date.DayOfWeek([日期],0), Int64.Type),",
          "    day_in_week_name = Table.AddColumn(day_in_week_id, \"周天名称\", each if [日序号] = 1 then \"WD1\" else",
          "if [日序号] = 2 then \"WD2\" else",
          "if [日序号] = 3 then \"WD3\" else",
          "if [日序号] = 4 then \"WD4\" else",
          "if [日序号] = 5 then \"WD5\" else",
          "if [日序号] = 6 then \"WD6\" else",
          "\"WD7\",Text.Type),",
          "    work_day = Table.AddColumn(day_in_week_name , \"工作日\", each if [日序号] = 6 or [日序号] = 0 then \"休息日\" else \"工作日\",Text.Type)",
          "in",
          "    work_day"
        ]
      },
      {
        "name": "D_项目信息",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 项目信息",
          "in",
          "    源"
        ]
      },
      {
        "name": "责任体",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45Wetq65mn/juezt7yYsFRJR8lQKVYnWunJjjlPe6Y/7WiDyALFjcDiT3v70MSNYeIgLUjiJnD1vSjqTcHiL5buRxM3A4s/X7PmyY6GJ7u6n+yY9bJ5BVDcHC6+qwdZ3AKhvhNZ3BIm/nT2bGRxQwOwxLOt258umQbiQz20c/+TvbOfzu97uqMJ7hZDYCDEAgA=\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [责任体 = _t, 排序 = _t]),",
          "    更改的类型 = Table.TransformColumnTypes(源,{{\"责任体\", type text}, {\"排序\", Int64.Type}})",
          "in",
          "    更改的类型"
        ]
      },
      {
        "name": "项目信息",
        "kind": "m",
        "expression": [
          "let",
          "    源 = MD_XIANGMUXINXI,",
          "    计算责任体 = Table.AddColumn(源, \"责任体\", each if [京内外分布] = \"国际\" then \"海外\" else if [厂房事业部] <> null then [厂房事业部] else if [直管机构] <> \"公司\" then [直管机构] else if [城市公司] <> null then [城市公司] else \"公司直营\", type text),",
          "    重命名的列1 = Table.RenameColumns(计算责任体,{{\"fYWBK\", \"业务板块\"}}),",
          "    删除的其他列 = Table.SelectColumns(重命名的列1,{\"项目编码\", \"项目名称\", \"专业分类\", \"签约单位\", \"实际开工日期\", \"实际竣工日期\", \"经营类型\", \"业务板块\", \"投标管理部门\", \"股份财务一体化项目编码\", \"股份一体化利润中心编码\", \"责任体\"}),",
          "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"实际开工日期\", DateTime.Date, type date}, {\"实际竣工日期\", DateTime.Date, type date}})",
          "in",
          "    提取的日期"
        ]
      },
      {
        "name": "施工专业",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45Wejpn/tPdu5R0lAyVYnWilZ7N2fV8ylYg10gpNhYA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [施工专业 = _t, 排序 = _t]),",
          "    更改的类型 = Table.TransformColumnTypes(源,{{\"排序\", Int64.Type}})",
          "in",
          "    更改的类型"
        ]
      },
      {
        "name": "分包类型",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WetG+6tm0vUo6CIahUqxOtNKznvan62Y97Wh72tMKFIRwgQwjpdhYAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [分包类型 = _t, 简称 = _t, 排序 = _t]),",
          "    更改的类型 = Table.TransformColumnTypes(源,{{\"排序\", Int64.Type}})",
          "in",
          "    更改的类型"
        ]
      },
      {
        "name": "商务科目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = MD_SHANGWUKEMU2020,",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"FSHANGWUKEMUMC\", \"FSHIYONGZHUANGTAI\", \"FFULLNAME\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FSHANGWUKEMUMC\", \"商务科目名称\"}, {\"FSHIYONGZHUANGTAI\", \"状态\"}, {\"FFULLNAME\", \"全路径\"}}),",
          "    复制的列 = Table.DuplicateColumn(重命名的列, \"全路径\", \"全路径 - 复制\"),",
          "    按分隔符拆分列 = Table.SplitColumn(复制的列, \"全路径 - 复制\", Splitter.SplitTextByDelimiter(\"/\", QuoteStyle.Csv), {\"全路径 - 复制.1\", \"一级\", \"二级\"}),",
          "    删除的列 = Table.RemoveColumns(按分隔符拆分列,{\"全路径 - 复制.1\"}),",
          "    替换的值 = Table.ReplaceValue(删除的列,null,each [一级],Replacer.ReplaceValue,{\"二级\"})",
          "in",
          "    替换的值"
        ]
      },
      {
        "name": "GSPM_CHENGBAOHETONGXINXI",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_CHENGBAOHETONGXINXI = GSPM{[Name=\"GSPM_CHENGBAOHETONGXINXI\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_CHENGBAOHETONGXINXI, each ([FHETONGFENLEI1] <> \"框架协议\") and ([FHETONGFENLEI2] <> \"备案\")),",
          "    筛选的行1 = Table.SelectRows(筛选的行, each [FHETONGBIANHAO] <> null),",
          "    重命名的列 = Table.RenameColumns(筛选的行1,{{\"FHETONGFENLEI1\", \"类别\"}, {\"FHETONGFENLEI2\", \"类型\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FHETONGMINGCHENG\", \"合同名称\"}, {\"FDUIYINGGONGCHENGBIANMA\", \"项目编码\"}, {\"FDUIYINGGONGCHENGMINGCHENG\", \"项目名称\"}, {\"FDUIYINGCHENGBAOHETONGBIANMA\", \"主合同编号\"}, {\"FHETONGQIANDINGRIQI\", \"签订日期\"}, {\"FTUJIANZHIDINGFENBAOHANSHUI\", \"土建-指定-含税\"}, {\"FJIDIANZHIDINGFENBAOHANSHUI\", \"机电-指定-含税\"}, {\"FTUJIANZISHIJINEHANSHUI\", \"土建-自施-含税\"}, {\"FJIDIANZISHIJINEHANSHUI\", \"机电-自施-含税\"},  {\"FTUJIANZHIDINGFENBAOWUSHUI\", \"土建-指定-无税\"}, {\"FJIDIANZHIDINGFENBAOWUSHUI\", \"机电-指定-无税\"}, {\"FTUJIANZISHIJINEWUSHUI\", \"土建-自施-无税\"}, {\"FJIDIANZISHIJINEWUSHUI\", \"机电-自施-无税\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "D_承包合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 承包合同",
          "in",
          "    源"
        ]
      },
      {
        "name": "F_承包合同金额",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_CHENGBAOHETONGXINXI,",
          "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"签订日期\", \"土建-指定-含税\", \"机电-指定-含税\", \"土建-自施-含税\", \"机电-自施-含税\", \"土建-指定-无税\", \"机电-指定-无税\", \"土建-自施-无税\", \"机电-自施-无税\"}),",
          "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"签订日期\", DateTime.Date, type date}}),",
          "    逆透视的其他列 = Table.UnpivotOtherColumns(提取的日期, {\"合同编号\", \"签订日期\"}, \"属性\", \"值\"),",
          "    按分隔符拆分列 = Table.SplitColumn(逆透视的其他列, \"属性\", Splitter.SplitTextByDelimiter(\"-\", QuoteStyle.Csv), {\"属性.1\", \"属性.2\", \"属性.3\"}),",
          "    重命名的列1 = Table.RenameColumns(按分隔符拆分列,{{\"属性.1\", \"专业\"}, {\"属性.2\", \"分包类型\"}}),",
          "    已透视列 = Table.Pivot(重命名的列1, List.Distinct(重命名的列1[属性.3]), \"属性.3\", \"值\", List.Sum)",
          "in",
          "    已透视列"
        ]
      },
      {
        "name": "承包合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_CHENGBAOHETONGXINXI,",
          "    删除的其他列 = Table.SelectColumns(源,{\"类别\", \"类型\", \"合同编号\", \"合同名称\", \"项目编码\", \"项目名称\", \"主合同编号\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "F_业主确认量",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({新业主确认量, 结转确认量})",
          "in",
          "    源"
        ]
      },
      {
        "name": "GSPM_HETONGPINGSHEN（分包原始合同）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_HETONGPINGSHEN = GSPM{[Name=\"GSPM_HETONGPINGSHEN\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_HETONGPINGSHEN,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FHETONGXIEYIHAO\", \"补充协议号\"}, {\"FHETONGMINGCHENG\", \"合同名称\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FSHANGWUKEMUID\", \"商务科目ID\"}, {\"FCAIWUKEMUID\", \"财务科目ID\"}, {\"FSHIFOULINJIANHT\", \"是否临建合同\"}, {\"FSHIGONGZHUANYE\", \"施工专业\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FZHAOBIAOFANGSHI\", \"招标方式\"}, {\"FFENBAOBIANMA\", \"分包编码\"}, {\"FFENBAOMINGCHENG\", \"分包名称\"}, {\"FYEWULEIBIE\", \"业务类别\"}, {\"FHANSHUIHETONGZONGJIA\", \"含税合同价\"}, {\"FQIZHONGSHUIJIN\", \"税金\"}, {\"FBUHANSHUIHETONGZONGJIA\", \"不含税合同价\"}, {\"FQIANDINGSHIJIAN\", \"签订日期\"}, {\"FSHIFOUZANGUHETONG\", \"是否暂估\"}, {\"FDAIQIANHETONGMINGCHENG\", \"标准合同名称\"}, {\"FPINGSHENZHUANGTAI\", \"单据状态\"}, {\"FHETONGNEIRONGMIAOSHU\", \"合同内容\"}, {\"FSHANGWUKEMUMINGCHENG\", \"商务科目\"}, {\"FDAIQIANHETONGBIANMA\", \"标准合同编码\"}, {\"FGUONEIWAI\", \"国内外\"}}),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([单据状态] = \"已完成\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "GSPM_FENBAOBUCHONGPINGSHEN（分包补充协议）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_HETONGPINGSHEN = GSPM{[Name=\"GSPM_FENBAOBUCHONGPINGSHEN\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_HETONGPINGSHEN,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FBUCHONGXIEYIHAO\", \"补充协议号\"}, {\"FBUCHONGXIEYIMINGCHENG\", \"合同名称\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FSHANGWUKEMUID\", \"商务科目ID\"}, {\"FCAIWUKEMUID\", \"财务科目ID\"}, {\"FSHIFOULINJIANHT\", \"是否临建合同\"}, {\"FSHIGONGZHUANYE\", \"施工专业\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FFENBAOBIANMA\", \"分包编码\"}, {\"FFENBAOMINGCHENG\", \"分包名称\"}, {\"FYEWULEIBIE\", \"业务类别\"}, {\"FHANSHUIHETONGZONGJIA\", \"含税合同价\"}, {\"FQIZHONGSHUIJIN\", \"税金\"}, {\"FBUHANSHUIHETONGZONGJIA\", \"不含税合同价\"}, {\"FQIANDINGRIQI\", \"签订日期\"}, {\"FSHIFOUZANGUHETONG\", \"是否暂估\"}, {\"FSFJZDXM\", \"是否针对项目\"}, {\"FBIAOZHUNHETONGNAME\", \"标准合同名称\"}, {\"FPINGSHENZHUANGTAI\", \"单据状态\"}, {\"FHETONGNEIRONGMIAOSHU\", \"合同内容\"}, {\"FSHANGWUKEMU\", \"商务科目\"}, {\"FBIAOZHUNHETONGCODE\", \"标准合同编码\"}, {\"FGUONEIWAI\", \"国内外\"}}),",
          "    筛选的行 = Table.SelectRows(重命名的列, each [单据状态]=\"已完成\")",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "原始分包合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_HETONGPINGSHEN（分包原始合同）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"补充协议号\", \"合同名称\", \"项目编码\", \"项目名称\", \"标准合同编码\", \"标准合同名称\", \"商务科目ID\", \"商务科目\", \"财务科目ID\", \"是否临建合同\", \"施工专业\", \"分包类型\", \"分包编码\", \"分包名称\", \"是否暂估\", \"签订日期\", \"不含税合同价\", \"含税合同价\", \"税金\", \"单据状态\", \"业务类别\", \"国内外\"}),",
          "    // KEYID作为后续业务串联线索",
          "    已添加自定义 = Table.AddColumn(删除的其他列, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type)",
          "in",
          "    已添加自定义"
        ]
      },
      {
        "name": "分包合同补充协议",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_FENBAOBUCHONGPINGSHEN（分包补充协议）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"补充协议号\", \"合同名称\", \"项目编码\", \"项目名称\", \"合同编号\", \"分包编码\", \"分包名称\", \"是否临建合同\", \"是否暂估\", \"合同内容\", \"含税合同价\", \"税金\", \"不含税合同价\", \"签订日期\", \"单据状态\", \"业务类别\", \"标准合同编码\", \"标准合同名称\", \"商务科目ID\", \"财务科目ID\", \"国内外\", \"施工专业\", \"分包类型\"}),",
          "    已添加自定义 = Table.AddColumn(删除的其他列, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type)",
          "in",
          "    已添加自定义"
        ]
      },
      {
        "name": "分包合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({原始分包合同, 分包合同补充协议})",
          "in",
          "    源"
        ]
      },
      {
        "name": "F_分包合同额",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 分包合同,",
          "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"补充协议号\", \"项目编码\", \"商务科目ID\", \"财务科目ID\", \"施工专业\", \"分包类型\", \"分包编码\", \"签订日期\", \"不含税合同价\", \"含税合同价\", \"税金\", \"KEYID\"}),",
          "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"签订日期\", DateTime.Date, type date}})",
          "in",
          "    提取的日期"
        ]
      },
      {
        "name": "D_分包合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 分包合同,",
          "    删除的列 = Table.RemoveColumns(源,{\"签订日期\", \"不含税合同价\", \"含税合同价\", \"税金\"}),",
          "    删除的副本 = Table.Distinct(删除的列, {\"KEYID\"})",
          "in",
          "    删除的副本"
        ]
      },
      {
        "name": "GSPM_FBBAOLIANGSHENPIBIAO（分包报量主表）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_FBBAOLIANGSHENPIBIAO = GSPM{[Name=\"GSPM_FBBAOLIANGSHENPIBIAO\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_FBBAOLIANGSHENPIBIAO, each ([FDANJUZHUANGTAI] = \"已完成\")),",
          "    重命名的列 = Table.RenameColumns(筛选的行,{{\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FSHIGONGZHUANYE\", \"专业\"}, {\"FDANJUZHUANGTAI\", \"单据状态\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_SHANGWUBAOLIANG（分包报量明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_SHANGWUBAOLIANG = GSPM{[Name=\"GSPM_SHANGWUBAOLIANG\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_SHANGWUBAOLIANG,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FFENBAODANWEI\", \"分包名称\"}, {\"FBAOLIANGJINE\", \"报量金额1\"}, {\"FBAOLIANGSHUIE\", \"报量税额1\"}, {\"FDQBLJIASHUIHEJI\", \"报量价税合计1\"}, {\"FGONGSIHEDINGDZBLJE\", \"公司调整金额\"}, {\"FGONGSIHEDINGDZBLSE\", \"公司调整税额\"}, {\"FGONGSIHEDINGDZBLJSHJ\", \"公司调整价税合计\"}, {\"FSHIFOUZANGUHETONG\", \"是否暂估合同\"}, {\"FHETONGSHUXING\", \"分包类型\"}, {\"FSHIGONGZHUANYE\", \"专业\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_FBJIANBAOLIANGSHENPIBIAO（分包减报量主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_FBJIANBAOLIANGSHENPIBIAO = GSPM{[Name=\"GSPM_FBJIANBAOLIANGSHENPIBIAO\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_FBJIANBAOLIANGSHENPIBIAO, each ([FDANJUZHUANGTAI] = \"已完成\")),",
          "    重命名的列 = Table.RenameColumns(筛选的行,{{\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FDANJUZHUANGTAI\", \"单据状态\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_SHANGWUJIANBAOLIANG（分包减报量明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_SHANGWUJIANBAOLIANG = GSPM{[Name=\"GSPM_SHANGWUJIANBAOLIANG\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_SHANGWUJIANBAOLIANG,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FFENBAODANWEI\", \"分包名称\"}, {\"FBAOLIANGJINE\", \"减报量金额\"}, {\"FBAOLIANGSHUIE\", \"减报量税额\"}, {\"FDQBLJIASHUIHEJI\", \"减报量价税合计\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_FBBAOLIANGSHENPIBIAO_EQ（分包报量主表二期）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_FBBAOLIANGSHENPIBIAO_EQ = GSPM{[Name=\"GSPM_FBBAOLIANGSHENPIBIAO_EQ\"]}[Data],",
          "    #\"筛选的行(完成单据)\" = Table.SelectRows(GSPM_FBBAOLIANGSHENPIBIAO_EQ, each ([FDANJUZHUANGTAI] = \"已完成\")),",
          "    重命名的列 = Table.RenameColumns(#\"筛选的行(完成单据)\",{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_SHANGWUBAOLIANG_EQ（分包报量明细二期）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_SHANGWUBAOLIANG_EQ = GSPM{[Name=\"GSPM_SHANGWUBAOLIANG_EQ\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_SHANGWUBAOLIANG_EQ,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FFENBAODANWEI\", \"分包名称\"}, {\"FBYWCBLHS\", \"报量价税合计\"}, {\"FZENGZHISHUILV\", \"税率\"}, {\"SCREATETIME\", \"创建日期\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FSHIGONGZHUANYE\", \"专业\"}, {\"FHETONGSHUXING\", \"分包类型\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "2022年4月之前分包报量主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_FBBAOLIANGSHENPIBIAO（分包报量主表）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"项目编码\", \"项目名称\", \"年\", \"月\", \"专业\", \"单据状态\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "2022年4月之前分包报量明细",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_SHANGWUBAOLIANG（分包报量明细）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"是否暂估合同\", \"报量金额1\", \"报量税额1\", \"报量价税合计1\", \"公司调整金额\", \"公司调整税额\", \"公司调整价税合计\", \"FSHENPIBIAOID\"}),",
          "    替换的值 = Table.ReplaceValue(删除的其他列,null,0,Replacer.ReplaceValue,{\"报量金额1\", \"报量税额1\", \"报量价税合计1\", \"公司调整金额\", \"公司调整税额\", \"公司调整价税合计\"}),",
          "    已添加自定义 = Table.AddColumn(替换的值, \"报量金额\", each if [是否暂估合同]=\"否\" then [报量金额1] else [公司调整金额],Number.Type),",
          "    已添加自定义1 = Table.AddColumn(已添加自定义, \"报量税额\", each if [是否暂估合同]=\"否\" then [报量税额1] else [公司调整税额],Number.Type),",
          "    已添加自定义2 = Table.AddColumn(已添加自定义1, \"报量价税合计\", each if [是否暂估合同]=\"否\" then [报量价税合计1] else [公司调整价税合计],Number.Type),",
          "    已添加条件列 = Table.AddColumn(已添加自定义2, \"暂估\", each if [是否暂估合同] = \"是\" then \"暂估\" else null,type text),",
          "    删除的列 = Table.RemoveColumns(已添加条件列,{\"报量金额1\", \"报量税额1\", \"报量价税合计1\", \"公司调整金额\", \"公司调整税额\", \"公司调整价税合计\", \"是否暂估合同\", \"暂估\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "2022年4月之前分包报量",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(#\"2022年4月之前分包报量明细\", {\"FSHENPIBIAOID\"}, #\"2022年4月之前分包报量主表\", {\"FID\"}, \"分包报量主表\", JoinKind.Inner),",
          "    #\"展开的“分包报量主表”\" = Table.ExpandTableColumn(源, \"分包报量主表\", {\"项目编码\", \"项目名称\", \"年\", \"月\"}, {\"项目编码\", \"项目名称\", \"年\", \"月\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“分包报量主表”\",{\"FSHENPIBIAOID\"}),",
          "    #\"合并的列（合并年月）\" = Table.CombineColumns(Table.TransformColumnTypes(删除的列, {{\"年\", type text}, {\"月\", type text}}, \"zh-CN\"),{\"年\", \"月\"},Combiner.CombineTextByDelimiter(\"-\", QuoteStyle.None),\"日期\"),",
          "    #\"已分析的日期（通过年月获得日期）\" = Table.TransformColumns(#\"合并的列（合并年月）\",{{\"日期\", each Date.From(DateTimeZone.From(_)), type date}}),",
          "    #\"已添加自定义（KEYID）\" = Table.AddColumn(#\"已分析的日期（通过年月获得日期）\", \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text)",
          "in",
          "    #\"已添加自定义（KEYID）\""
        ]
      },
      {
        "name": "分包完成量主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_FBBAOLIANGSHENPIBIAO_EQ（分包报量主表二期）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"项目编码\", \"项目名称\", \"年\", \"月\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "分包完成量明细",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_SHANGWUBAOLIANG_EQ（分包报量明细二期）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FSHENPIBIAOID\", \"合同编号\", \"项目编码\", \"税率\", \"报量价税合计\", \"创建日期\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "新分包完成量",
        "kind": "m",
        "expression": [
          "let",
          "    #\"合并的查询（合并主从表）\" = Table.NestedJoin(分包完成量明细, {\"FSHENPIBIAOID\"}, 分包完成量主表, {\"FID\"}, \"分包完成量主表\", JoinKind.Inner),",
          "    删除的列 = Table.RemoveColumns(#\"合并的查询（合并主从表）\",{\"FSHENPIBIAOID\"}),",
          "    #\"展开的“分包完成量主表”\" = Table.ExpandTableColumn(删除的列, \"分包完成量主表\", {\"年\", \"项目名称\", \"月\"}, {\"年\", \"项目名称\", \"月\"}),",
          "    替换的值 = Table.ReplaceValue(#\"展开的“分包完成量主表”\",null,0,Replacer.ReplaceValue,{\"税率\"}),",
          "    #\"已添加自定义（计算报量金额）\" = Table.AddColumn(替换的值, \"报量金额\", each [报量价税合计]/(1+[税率]),type number),",
          "    #\"已添加自定义（计算税金）\" = Table.AddColumn(#\"已添加自定义（计算报量金额）\", \"报量税额\", each [报量价税合计]-[报量金额],type number),",
          "    #\"已添加自定义(KEYID)\" = Table.AddColumn(#\"已添加自定义（计算税金）\", \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    排序的行1 = Table.Sort(#\"已添加自定义(KEYID)\",{{\"KEYID\", Order.Ascending}, {\"创建日期\", Order.Descending}}),",
          "    #\"已添加索引（稳定排序结果）\" = Table.AddIndexColumn(排序的行1, \"索引\", 0, 1, Int64.Type),",
          "    删除的副本 = Table.Distinct(#\"已添加索引（稳定排序结果）\", {\"KEYID\", \"年\", \"月\"}),",
          "    合并的列 = Table.CombineColumns(Table.TransformColumnTypes(删除的副本, {{\"年\", type text}, {\"月\", type text}}, \"zh-CN\"),{\"年\", \"月\"},Combiner.CombineTextByDelimiter(\"-\", QuoteStyle.None),\"日期\"),",
          "    已分析的日期 = Table.TransformColumns(合并的列,{{\"日期\", each Date.From(DateTimeZone.From(_)), type date}}),",
          "    #\"筛选的行（排除初始化报量）\" = Table.SelectRows(已分析的日期, each [日期] >= #date(2022, 5, 1)),",
          "    删除的列1 = Table.RemoveColumns(#\"筛选的行（排除初始化报量）\",{\"创建日期\", \"税率\", \"索引\"})",
          "in",
          "    删除的列1"
        ]
      },
      {
        "name": "分包减报量明细",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_SHANGWUJIANBAOLIANG（分包减报量明细）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"分包名称\", \"减报量金额\", \"减报量税额\", \"减报量价税合计\", \"FSHENPIBIAOID\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "分包减报量主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_FBJIANBAOLIANGSHENPIBIAO（分包减报量主表\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"项目编码\", \"项目名称\", \"年\", \"月\", \"单据状态\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "F_分包减报量",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(分包减报量明细,{\"FSHENPIBIAOID\"},分包减报量主表,{\"FID\"},\"分包减报量主表\",JoinKind.Inner),",
          "    #\"展开的“分包减报量主表”\" = Table.ExpandTableColumn(源, \"分包减报量主表\", {\"项目编码\", \"项目名称\", \"年\", \"月\"}, {\"项目编码\", \"项目名称\", \"年\", \"月\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“分包减报量主表”\",{\"FSHENPIBIAOID\"}),",
          "    已添加自定义 = Table.AddColumn(删除的列, \"日期\", each #date([年],[月],1),type date),",
          "    已添加自定义1 = Table.AddColumn(已添加自定义, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text)",
          "in",
          "    已添加自定义1"
        ]
      },
      {
        "name": "F_分包报量表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({#\"2022年4月之前分包报量\", 新分包完成量}),",
          "    合并的查询 = Table.NestedJoin(源, {\"KEYID\"}, D_分包合同, {\"KEYID\"}, \"D_分包合同\", JoinKind.LeftOuter),",
          "    #\"展开的“D_分包合同”\" = Table.ExpandTableColumn(合并的查询, \"D_分包合同\", {\"施工专业\", \"分包类型\"}, {\"施工专业\", \"分包类型\"}),",
          "    重排序的列 = Table.ReorderColumns(#\"展开的“D_分包合同”\",{\"KEYID\", \"项目编码\", \"项目名称\", \"施工专业\", \"分包类型\", \"日期\", \"合同编号\", \"报量金额\", \"报量税额\", \"报量价税合计\"})",
          "in",
          "    重排序的列"
        ]
      },
      {
        "name": "GSPM_JICAIFENBAOFKMXB（集采分包付款明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_JICAIFENBAOFKMXB = GSPM{[Name=\"GSPM_JICAIFENBAOFKMXB\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_JICAIFENBAOFKMXB, each ([FDAIHAO] = 5)),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"FJICAIFBFKBID\", \"FGONGRENLAOWUFEI\", \"FQITA\", \"FHEJI\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FHEJI\", \"本期实际付款\"}, {\"FGONGRENLAOWUFEI\", \"劳务费\"}, {\"FQITA\", \"其它\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_JICAIFENBAOFUKUAN（集采分包付款主表）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_TONGYIZZWUZIFUKUAN = GSPM{[Name=\"GSPM_JICAIFENBAOFUKUAN\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_TONGYIZZWUZIFUKUAN,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FSHIGONGZHUANYE\", \"施工专业\"}, {\"FZHIFUFANGSHI\", \"支付方式\"}, {\"FBENQISHIJIFUKUAN\", \"本期实际付款\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FPINGSHENZHUANGTAI\", \"单据状态\"}}),",
          "    删除的其他列 = Table.SelectColumns(重命名的列,{\"FID\", \"年\", \"月\", \"合同编号\", \"项目编码\", \"项目名称\", \"施工专业\", \"支付方式\", \"分包类型\", \"单据状态\"}),",
          "    #\"筛选的行（清除垃圾数据和终止的数据）\" = Table.SelectRows(删除的其他列, each ([项目编码] <> null) and ([单据状态] <> \"已终止\"))",
          "in",
          "    #\"筛选的行（清除垃圾数据和终止的数据）\""
        ]
      },
      {
        "name": "GSPM_FENBAOGONGCHENGFUKUAN（分包付款主表）)",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_FENBAOGONGCHENGFUKUAN = GSPM{[Name=\"GSPM_FENBAOGONGCHENGFUKUAN\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_FENBAOGONGCHENGFUKUAN,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FPINGSHENZHUANGTAI2\", \"单据状态\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FSHIGONGZHUANYE\", \"施工专业\"}, {\"FZHIFUFANGSHI\", \"支付方式\"}, {\"FHETONGLEIXING\", \"分包类型\"}}),",
          "    删除的其他列 = Table.SelectColumns(重命名的列,{\"FID\", \"年\", \"月\", \"支付方式\", \"项目编码\", \"项目名称\", \"合同编号\", \"施工专业\", \"分包类型\", \"单据状态\"}),",
          "    #\"筛选的行（去掉终止的单据)\" = Table.SelectRows(删除的其他列, each ([单据状态] <> \"已终止\"))",
          "in",
          "    #\"筛选的行（去掉终止的单据)\""
        ]
      },
      {
        "name": "GSPM_FENBAOGCKXMXB（分包付款明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_FENBAOGCKXMXB = GSPM{[Name=\"GSPM_FENBAOGCKXMXB\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_FENBAOGCKXMXB, each ([FDAIHAO] = 5)),",
          "    重命名的列 = Table.RenameColumns(筛选的行,{{\"FGONGRENLAOWUFEI\", \"劳务费\"}, {\"FQITA\", \"其它\"}, {\"FHEJI\", \"本期实际付款\"}}),",
          "    删除的其他列 = Table.SelectColumns(重命名的列,{\"劳务费\", \"其它\", \"本期实际付款\", \"FFENBAOGCKBID\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "单项分包付款",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_FENBAOGONGCHENGFUKUAN（分包付款主表）)\",",
          "    合并的查询 = Table.NestedJoin(源, {\"FID\"}, #\"GSPM_FENBAOGCKXMXB（分包付款明细）\", {\"FFENBAOGCKBID\"}, \"分包付款明细\", JoinKind.Inner),",
          "    删除的列 = Table.RemoveColumns(合并的查询,{\"FID\"}),",
          "    #\"展开的“分包付款明细”\" = Table.ExpandTableColumn(删除的列, \"分包付款明细\", {\"本期实际付款\", \"劳务费\", \"其它\"}, {\"本期实际付款\", \"劳务费\", \"其它\"}),",
          "    已添加自定义 = Table.AddColumn(#\"展开的“分包付款明细”\", \"日期\", each #date([年],[月],1),Date.Type),",
          "    删除的列1 = Table.RemoveColumns(已添加自定义,{\"年\", \"月\"}),",
          "    已添加自定义1 = Table.AddColumn(删除的列1, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text),",
          "    重排序的列 = Table.ReorderColumns(已添加自定义1,{\"KEYID\", \"项目编码\", \"项目名称\", \"日期\", \"合同编号\", \"本期实际付款\", \"劳务费\", \"其它\", \"单据状态\"}),",
          "    #\"已添加自定义(支付渠道)\" = Table.AddColumn(重排序的列, \"支付渠道\", each \"单项\",Text.Type)",
          "in",
          "    #\"已添加自定义(支付渠道)\""
        ]
      },
      {
        "name": "集采分包付款",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(#\"GSPM_JICAIFENBAOFUKUAN（集采分包付款主表）\", {\"FID\"}, #\"GSPM_JICAIFENBAOFKMXB（集采分包付款明细）\", {\"FJICAIFBFKBID\"}, \"集采分包付款明细\", JoinKind.Inner),",
          "    #\"展开的“集采分包付款明细”\" = Table.ExpandTableColumn(源, \"集采分包付款明细\", {\"劳务费\", \"其它\", \"本期实际付款\"}, {\"劳务费\", \"其它\", \"本期实际付款\"}),",
          "    已添加自定义 = Table.AddColumn(#\"展开的“集采分包付款明细”\", \"日期\", each #date([年],[月],1),type date),",
          "    删除的列 = Table.RemoveColumns(已添加自定义,{\"FID\", \"年\", \"月\"}),",
          "    已添加自定义1 = Table.AddColumn(删除的列, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text),",
          "    #\"已添加自定义(支付渠道)\" = Table.AddColumn(已添加自定义1, \"支付渠道\", each \"集中\",Text.Type)",
          "in",
          "    #\"已添加自定义(支付渠道)\""
        ]
      },
      {
        "name": "F_分包付款",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({单项分包付款, 集采分包付款}),",
          "    #\"替换的值(标准化状态)\" = Table.ReplaceValue(源,each [单据状态],each if [单据状态]<>\"已完成\" then \"在途\" else [单据状态],Replacer.ReplaceText,{\"单据状态\"})",
          "in",
          "    #\"替换的值(标准化状态)\""
        ]
      },
      {
        "name": "X5 (2)",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Oracle.Database(\"172.16.8.78/oracledb\", [HierarchicalNavigation=true])",
          "in",
          "    源"
        ]
      },
      {
        "name": "GSPM_FENBAOHETONGJIESUAN（分包合同结算）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_FENBAOHETONGJIESUAN = GSPM{[Name=\"GSPM_FENBAOHETONGJIESUAN\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_FENBAOHETONGJIESUAN, each ([FPINGSHENZHUANGTAI] = \"已完成\") and ([FJIESUANLEIXING] = \"正常结算\" or [FJIESUANLEIXING] = \"结算签约后让利\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_分包结算",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_FENBAOHETONGJIESUAN（分包合同结算）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FXIANGMUBIANMA\", \"FXIANGMUMINGCHENG\", \"FHETONGBIANHAO\", \"FJIESUANJIAHS\", \"FJIESUANJIABHS\", \"FQIANDINGSHIJIAN\", \"FPINGSHENZHUANGTAI\", \"SCREATETIME\", \"FJIESUANLEIXING\"}),",
          "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"FQIANDINGSHIJIAN\", DateTime.Date, type date}}),",
          "    重命名的列 = Table.RenameColumns(提取的日期,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FJIESUANJIAHS\", \"含税结算额\"}, {\"FPINGSHENZHUANGTAI\", \"单据状态\"}, {\"FQIANDINGSHIJIAN\", \"签订日期\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FJIESUANJIABHS\", \"不含税结算额\"}}),",
          "    #\"已添加自定义（KEYID）\" = Table.AddColumn(重命名的列, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text),",
          "    排序的行 = Table.Buffer(Table.Sort(#\"已添加自定义（KEYID）\",{{\"KEYID\", Order.Descending}, {\"SCREATETIME\", Order.Descending}})),",
          "    #\"删除的副本（取各项目该合同末期结算）\" = Table.Distinct(排序的行, {\"KEYID\"}),",
          "    删除的其他列1 = Table.SelectColumns(#\"删除的副本（取各项目该合同末期结算）\",{\"项目编码\", \"合同编号\", \"含税结算额\", \"不含税结算额\", \"签订日期\", \"KEYID\"}),",
          "    #\"已添加自定义（计算税金）\" = Table.AddColumn(删除的其他列1, \"税金\", each List.Sum({[含税结算额],-[不含税结算额]}),Number.Type),",
          "    重排序的列 = Table.ReorderColumns(#\"已添加自定义（计算税金）\",{\"KEYID\", \"项目编码\", \"合同编号\", \"签订日期\", \"不含税结算额\", \"含税结算额\", \"税金\"})",
          "in",
          "    重排序的列"
        ]
      },
      {
        "name": "GSPM_WUZIHETONGPS（物资原始合同）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIHETONGXINXI = GSPM{[Name=\"GSPM_WUZIHETONGPS\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_WUZIHETONGXINXI,{{\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FGONGFANGMINGCHENG\", \"供方名称\"}, {\"FHANSHUIHETONGJIAKUAN\", \"价税合计\"}, {\"FBUHANSHUIHETONGJIAKUAN\", \"合同额\"}, {\"FSHUIJIN\", \"税额\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FSHIGONGZHUANYE\", \"专业\"}, {\"FHETONGPINGSHENTYPE\", \"合同类型\"}, {\"FQIANDINGSHIJIAN\", \"签订日期\"}, {\"FTIANBAOBM\", \"填报部门\"}, {\"FBIAOZHUNHETONGNAME\", \"标准合同名称\"}, {\"FSHANGWUKEMUID\", \"商务科目ID\"}, {\"FCAIWUKEMUID\", \"财务科目ID\"}, {\"FDYYZMROKJXYBH\", \"对应框架合同编号\"}, {\"FBIAOZHUNHETONGCODE\", \"标准合同编码\"}, {\"FGONGFANGBIANMA\", \"供方编码\"}, {\"FHETONGXIEYIHAO\", \"补充协议号\"}, {\"FHETONGMINGCHENG\", \"合同名称\"}, {\"FZENGZHISHUISHUILV\", \"增值税率\"}, {\"FYEWUXIAOLEI\", \"业务小类\"}, {\"FYEWUDALEI\", \"业务大类\"}, {\"FGUONEIWAI\", \"国内外\"}}),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([FPINGSHENZHUANGTAI] = \"已完成\") )",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "GSPM_WUZIHETONGBUCHONG（物资补充协议）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIHETONGBUCHONG = GSPM{[Name=\"GSPM_WUZIHETONGBUCHONG\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_WUZIHETONGBUCHONG,{{\"FBUCHONGXIEYIHAO\", \"补充协议号\"}, {\"FBUCHONGXIEYIMINGCHENG\", \"合同名称\"}, {\"FHANSHUIHETONGZONGJIA\", \"价税合计\"}, {\"FBUCHONGPINGSHENRIQI\", \"签订日期\"}, {\"FXMBM\", \"项目编码\"}, {\"FXMMC\", \"项目名称\"}, {\"FGONGFANGBIANMA\", \"供方编码\"}, {\"FGONGFANGMINGCHENG\", \"供方名称\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FBIAOZHUNHETONGNAME\", \"标准合同名称\"}, {\"FBIAOZHUNHETONGCODE\", \"标准合同编码\"}, {\"FSHANGWUKEMUID\", \"商务科目ID\"}, {\"FCAIWUKEMUID\", \"财务科目ID\"}, {\"FSHIGONGZHUANYE\", \"专业\"}, {\"FBUHANSHUIHETONGJIAKUAN\", \"合同额\"}, {\"FQIZHONGSHUIJIN\", \"税额\"}, {\"FHETONGPINGSHENTYPE\", \"合同类型\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FZENGZHISHUISHUILV\", \"增值税率\"}, {\"FYEWUXIAOLEI\", \"业务小类\"}, {\"FSFJZDXM\", \"是否针对项目\"}, {\"FYEWUDALEI\", \"业务大类\"}, {\"FGUONEIWAI\", \"国内外\"}}),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([FPINGSHENZHUANGTAI] = \"已完成\")),",
          "    #\"替换的值(取原项目编码字段)\" = Table.ReplaceValue(筛选的行,null,(_) as text=> [FXIANGMUBIANMA],Replacer.ReplaceValue,{\"项目编码\"}),",
          "    #\"替换的值(取原项目名称字段)\" = Table.ReplaceValue(#\"替换的值(取原项目编码字段)\",null,(_) as text=>[FXIANGMUMINGCHENG],Replacer.ReplaceValue,{\"项目名称\"})",
          "in",
          "    #\"替换的值(取原项目名称字段)\""
        ]
      },
      {
        "name": "物资原始合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZIHETONGPS（物资原始合同）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"项目编码\", \"项目名称\", \"补充协议号\", \"合同编号\", \"合同名称\", \"标准合同编码\", \"标准合同名称\", \"商务科目ID\", \"财务科目ID\", \"专业\", \"分包类型\", \"供方编码\", \"供方名称\", \"增值税率\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"合同类型\", \"业务大类\", \"业务小类\", \"国内外\"}),",
          "    提取的日期 = Table.TransformColumns(删除的其他列,{{\"签订日期\", DateTime.Date, type date}}),",
          "    已添加自定义 = Table.AddColumn(提取的日期, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text)",
          "in",
          "    已添加自定义"
        ]
      },
      {
        "name": "物资补充协议",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZIHETONGBUCHONG（物资补充协议）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"合同编号\", \"补充协议号\", \"合同名称\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"专业\", \"供方编码\", \"供方名称\", \"合同类型\", \"业务大类\", \"业务小类\", \"标准合同编码\", \"标准合同名称\", \"商务科目ID\", \"财务科目ID\", \"国内外\", \"项目编码\", \"项目名称\", \"增值税率\", \"分包类型\"}),",
          "    已添加自定义1 = Table.AddColumn(删除的其他列, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text),",
          "    提取的日期 = Table.TransformColumns(已添加自定义1,{{\"签订日期\", DateTime.Date, type date}})",
          "in",
          "    提取的日期"
        ]
      },
      {
        "name": "物资合同表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({物资原始合同, 物资补充协议})",
          "in",
          "    源"
        ]
      },
      {
        "name": "采购物资合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 物资合同表,",
          "    筛选的行 = Table.SelectRows(源, each ([业务大类] = \"消耗\")),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"项目编码\", \"项目名称\", \"补充协议号\", \"合同编号\", \"合同名称\", \"标准合同编码\", \"标准合同名称\", \"商务科目ID\", \"财务科目ID\", \"专业\", \"分包类型\", \"供方编码\", \"供方名称\", \"增值税率\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"合同类型\", \"业务大类\", \"业务小类\", \"国内外\", \"KEYID\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "租赁物资合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 物资合同表,",
          "    筛选的行 = Table.SelectRows(源, each [业务大类] = \"周转\")",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_采购物资合同额",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 采购物资合同,",
          "    删除的其他列 = Table.SelectColumns(源,{\"项目编码\", \"补充协议号\", \"合同编号\", \"专业\", \"分包类型\", \"供方编码\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"KEYID\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "D_采购物资合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 采购物资合同,",
          "    删除的列 = Table.RemoveColumns(源,{\"签订日期\", \"价税合计\", \"合同额\", \"税额\"}),",
          "    删除的副本 = Table.Distinct(删除的列, {\"KEYID\"})",
          "in",
          "    删除的副本"
        ]
      },
      {
        "name": "F_租赁物资合同额",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 租赁物资合同,",
          "    删除的其他列 = Table.SelectColumns(源,{\"项目编码\", \"补充协议号\", \"合同编号\", \"专业\", \"分包类型\", \"供方编码\", \"签订日期\", \"价税合计\", \"合同额\", \"税额\", \"KEYID\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "D_租赁物资合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 租赁物资合同,",
          "    删除的列 = Table.RemoveColumns(源,{\"签订日期\", \"价税合计\", \"合同额\", \"税额\"}),",
          "    删除的副本 = Table.Distinct(删除的列, {\"KEYID\"})",
          "in",
          "    删除的副本"
        ]
      },
      {
        "name": "GSPM_WUZIYUEDUDUIZHANGDAN（物资对账单）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIHETONGXINXI = GSPM{[Name=\"GSPM_WUZIYUEDUDUIZHANGDAN\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_WUZIHETONGXINXI, each ([FPINGSHENZHUANGTAI] = \"已完成\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "GSPM_WUZIYUEDUDUIZHANGHTXXB（物资对账明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIHETONGXINXI = GSPM{[Name=\"GSPM_WUZIYUEDUDUIZHANGHTXXB\"]}[Data]",
          "in",
          "    GSPM_WUZIHETONGXINXI"
        ]
      },
      {
        "name": "GSPM_WUZIJINCHANG_ZB（物资进场一期）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIJINCHANG_ZB = GSPM{[Name=\"GSPM_WUZIJINCHANG_ZB\"]}[Data],",
          "    #\"筛选的行（保留已完成单据）\" = Table.SelectRows(GSPM_WUZIJINCHANG_ZB, each ([FDANJUZHUANGTAI] = \"已完成\")),",
          "    重命名的列 = Table.RenameColumns(#\"筛选的行（保留已完成单据）\",{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FHANSHUIJINCHANGJINE\", \"本月进场含税\"}, {\"FBUHANSHUIJINCHANGJINE\", \"本月进场不含税\"}, {\"FSHUIJIN\", \"本月税金\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FSHIGONGZHUANYE\", \"专业\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "物资进场主表二期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZIYUEDUDUIZHANGDAN（物资对账单）\",",
          "    #\"筛选的行（采购物资）\" = Table.SelectRows(源, each ([FWZSJLX] = \"单项采购物资\")),",
          "    删除的其他列 = Table.SelectColumns(#\"筛选的行（采购物资）\",{\"FID\", \"FXIANGMUMINGCHENG\", \"FXIANGMUBIANMA\", \"FPINGSHENJIESHURIQI\", \"FNIAN\", \"FYUE\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FPINGSHENJIESHURIQI\", \"评审完成时间\"}, {\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "物资进场明细二期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZIYUEDUDUIZHANGHTXXB（物资对账明细）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FHETONGBIANHAO\", \"FZENGZHISHUISHUILV\", \"FBYWCDZHSRMB\", \"FSHENPIBIAOID\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FZENGZHISHUISHUILV\", \"税率\"}, {\"FBYWCDZHSRMB\", \"本月进场含税\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "物资进场二期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(物资进场主表二期, {\"FID\"}, 物资进场明细二期, {\"FSHENPIBIAOID\"}, \"物资对账明细\", JoinKind.Inner),",
          "    #\"展开的“物资对账明细”\" = Table.ExpandTableColumn(源, \"物资对账明细\", {\"合同编号\", \"税率\", \"本月进场含税\"}, {\"合同编号\", \"税率\", \"本月进场含税\"}),",
          "    #\"删除的列（删除ID列）\" = Table.RemoveColumns(#\"展开的“物资对账明细”\",{\"FID\"}),",
          "    #\"替换的值（保证税率不空）\" = Table.ReplaceValue(#\"删除的列（删除ID列）\",null,0,Replacer.ReplaceValue,{\"税率\"}),",
          "    #\"已添加自定义（KEYID）\" = Table.AddColumn(#\"替换的值（保证税率不空）\", \"KEYID\", each [合同编号]&\"@\"&[项目编码],Text.Type),",
          "    排序的行 = Table.Sort(#\"已添加自定义（KEYID）\",{{\"KEYID\", Order.Ascending}, {\"评审完成时间\", Order.Descending}}),",
          "    #\"已添加索引（稳定排序结果）\" = Table.AddIndexColumn(排序的行, \"索引\", 0, 1, Int64.Type),",
          "    #\"删除的副本（每合同每月保留末期）\" = Table.Distinct(#\"已添加索引（稳定排序结果）\", {\"KEYID\", \"年\", \"月\"}),",
          "    #\"删除的列（删除索引列）\" = Table.RemoveColumns(#\"删除的副本（每合同每月保留末期）\",{\"索引\"}),",
          "    #\"已添加自定义（计算不含税进场额）\" = Table.AddColumn(#\"删除的列（删除索引列）\", \"本月进场不含税\", each [本月进场含税]/(1+[税率]),Number.Type),",
          "    #\"已添加自定义（税金）\" = Table.AddColumn(#\"已添加自定义（计算不含税进场额）\", \"本月税金\", each List.Sum({[本月进场含税],-[本月进场不含税]}),Number.Type),",
          "    #\"已添加自定义（计算日期）\" = Table.AddColumn(#\"已添加自定义（税金）\", \"日期\", each #date([年],[月],1),Date.Type),",
          "    #\"删除的其他列（只保留必要的列）\" = Table.SelectColumns(#\"已添加自定义（计算日期）\",{\"项目编码\", \"项目名称\", \"合同编号\", \"本月进场含税\", \"本月进场不含税\", \"本月税金\", \"日期\", \"KEYID\"})",
          "in",
          "    #\"删除的其他列（只保留必要的列）\""
        ]
      },
      {
        "name": "物资进场一期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZIJINCHANG_ZB（物资进场一期）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"年\", \"月\", \"项目编码\", \"项目名称\", \"合同编号\", \"本月进场含税\", \"本月进场不含税\", \"本月税金\"}),",
          "    #\"合并的查询（排除二期项目）\" = Table.NestedJoin(删除的其他列, {\"项目编码\"}, 非二期项目, {\"项目编码\"}, \"MD_XIANGMUXINXI\", JoinKind.Inner),",
          "    删除的列 = Table.RemoveColumns(#\"合并的查询（排除二期项目）\",{\"MD_XIANGMUXINXI\"}),",
          "    #\"已添加自定义（计算日期）\" = Table.AddColumn(删除的列, \"日期\", each #date([年],[月],1),Date.Type),",
          "    #\"已添加自定义（计算KEYID）\" = Table.AddColumn(#\"已添加自定义（计算日期）\", \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    #\"删除的其他列（保留必要的列）\" = Table.SelectColumns(#\"已添加自定义（计算KEYID）\",{\"项目编码\", \"项目名称\", \"合同编号\", \"本月进场含税\", \"本月进场不含税\", \"本月税金\", \"日期\", \"KEYID\"})",
          "in",
          "    #\"删除的其他列（保留必要的列）\""
        ]
      },
      {
        "name": "非二期项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = MD_XIANGMUXINXI,",
          "    筛选的行 = Table.SelectRows(源, each ([是否物资二期项目] = \"否\")),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"项目编码\", \"是否物资二期项目\"}),",
          "    #\"添加索引列（项目编码）\" = Table.AddKey(删除的其他列,{\"项目编码\"},true)",
          "in",
          "    #\"添加索引列（项目编码）\""
        ]
      },
      {
        "name": "F_采购物资进场",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({物资进场二期, 物资进场一期}),",
          "    合并的查询 = Table.NestedJoin(源, {\"KEYID\"}, D_采购物资合同, {\"KEYID\"}, \"D_消耗物资合同\", JoinKind.LeftOuter),",
          "    #\"展开的“D_消耗物资合同”\" = Table.ExpandTableColumn(合并的查询, \"D_消耗物资合同\", {\"专业\", \"分包类型\"}, {\"专业\", \"分包类型\"})",
          "in",
          "    #\"展开的“D_消耗物资合同”\""
        ]
      },
      {
        "name": "GSPM_DANXIANGWUZIFUKUAN（物资合同付款）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_DANXIANGWUZIFUKUAN = GSPM{[Name=\"GSPM_DANXIANGWUZIFUKUAN\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_DANXIANGWUZIFUKUAN,{{\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FBENQISHIJIFUKUAN\", \"本期付款\"}, {\"FPINGSHENZHUANGTAI2\", \"单据状态\"}, {\"FZHIFUFANGSHI\", \"支付方式\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FSHIGONGZHUANYE\", \"施工专业\"}}),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([单据状态] <> \"已作废\" and [单据状态] <> \"已终止\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "GSPM_ZZCAILIAOZULINAFK（租赁合同付款）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_ZZCAILIAOZULINAFK = GSPM{[Name=\"GSPM_ZZCAILIAOZULINAFK\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_ZZCAILIAOZULINAFK, each ([FPINGSHENZHUANGTAI] <> \"已终止\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_采购物资付款表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({单项物资付款,集采物资付款}),",
          "    #\"替换的值(标准化状态)\" = Table.ReplaceValue(源,each [单据状态] ,each if [单据状态]<> \"已完成\" then \"在途\" else [单据状态],Replacer.ReplaceText,{\"单据状态\"})",
          "in",
          "    #\"替换的值(标准化状态)\""
        ]
      },
      {
        "name": "F_租赁物资付款表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_ZZCAILIAOZULINAFK（租赁合同付款）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"FXIANGMUBIANMA\", \"FNIAN\", \"FYUE\", \"FZHIFUFANGSHI\", \"FHETONGBIANHAO\", \"FBENQISHIJIFUKUAN\", \"FPINGSHENZHUANGTAI2\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FBENQISHIJIFUKUAN\", \"金额\"}, {\"FPINGSHENZHUANGTAI2\", \"单据状态\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FZHIFUFANGSHI\", \"支付方式\"}}),",
          "    已添加自定义 = Table.AddColumn(重命名的列, \"日期\", each #date([年],[月],1),Date.Type),",
          "    已添加自定义1 = Table.AddColumn(已添加自定义, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    删除的列 = Table.RemoveColumns(已添加自定义1,{\"年\", \"月\"}),",
          "    #\"替换的值(标准化状态)\" = Table.ReplaceValue(删除的列,each [单据状态] , each if [单据状态]<>\"已完成\" then \"在途\" else [单据状态],Replacer.ReplaceText,{\"单据状态\"})",
          "in",
          "    #\"替换的值(标准化状态)\""
        ]
      },
      {
        "name": "集采物资付款",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_TONGYIZZWUZIFUKUAN = GSPM{[Name=\"GSPM_TONGYIZZWUZIFUKUAN\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_TONGYIZZWUZIFUKUAN, each ([FXMBM] <> null)),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"FNIAN\", \"FYUE\", \"FZHIFUFANGSHI\", \"FHETONGBIANHAO\", \"FHETONGLEIXING\", \"FSHIGONGZHUANYE\", \"FPINGSHENZHUANGTAI\", \"FBENQISHIJIFUKUAN\", \"FXMBM\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FZHIFUFANGSHI\", \"支付方式\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FXMBM\", \"项目编码\"}, {\"FBENQISHIJIFUKUAN\", \"本期付款\"}, {\"FHETONGLEIXING\", \"分包类型\"}, {\"FSHIGONGZHUANYE\", \"施工专业\"}, {\"FPINGSHENZHUANGTAI\", \"单据状态\"}}),",
          "    筛选的行1 = Table.SelectRows(重命名的列, each ([单据状态] <> \"已终止\")),",
          "    已添加自定义 = Table.AddColumn(筛选的行1, \"日期\", each #date([年],[月],1),type date),",
          "    已添加自定义1 = Table.AddColumn(已添加自定义, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),type text),",
          "    删除的列 = Table.RemoveColumns(已添加自定义1,{\"年\", \"月\"}),",
          "    #\"已添加自定义(支付渠道)\" = Table.AddColumn(删除的列, \"支付渠道\", each \"单项\",Text.Type)",
          "in",
          "    #\"已添加自定义(支付渠道)\""
        ]
      },
      {
        "name": "单项物资付款",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_DANXIANGWUZIFUKUAN（物资合同付款）\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"项目编码\", \"年\", \"月\", \"支付方式\", \"合同编号\", \"施工专业\", \"分包类型\", \"本期付款\", \"单据状态\"}),",
          "    合并的列 = Table.CombineColumns(Table.TransformColumnTypes(删除的其他列, {{\"年\", type text}, {\"月\", type text}}, \"zh-CN\"),{\"年\", \"月\"},Combiner.CombineTextByDelimiter(\"-\", QuoteStyle.None),\"日期\"),",
          "    已分析的日期 = Table.TransformColumns(合并的列,{{\"日期\", each Date.From(DateTimeZone.From(_)), type date}}),",
          "    #\"自定义的列（KEYID）\" = Table.AddColumn( 已分析的日期, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    已添加自定义 = Table.AddColumn(#\"自定义的列（KEYID）\", \"支付渠道\", each \"集中\",Text.Type)",
          "in",
          "    已添加自定义"
        ]
      },
      {
        "name": "GSPM_WUZITUICHANG_CB",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZITUICHANG_CB = GSPM{[Name=\"GSPM_WUZITUICHANG_CB\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_WUZITUICHANG_CB,{{\"FTUICHANGDANID\", \"退场单\"}, {\"FHETONGBIANHAO\", \"合同编号\"}, {\"FJINE\", \"金额\"}, {\"FSHUIE\", \"税金\"}, {\"FJIASHUIHEJI\", \"价税合计\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "GSPM_WUZITUICHANG_ZB",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZITUICHANG_ZB = GSPM{[Name=\"GSPM_WUZITUICHANG_ZB\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_WUZITUICHANG_ZB,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FDANJUZHUANGTAI\", \"单据状态\"}}),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([单据状态] = \"已完成\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_采购物资退场",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 采购物资退场明细,",
          "    合并的查询 = Table.NestedJoin(源,{\"退场单\"},采购物资退场主表,{\"FID\"},\"专项物资退场主表\",JoinKind.Inner),",
          "    #\"展开的“专项物资退场主表”\" = Table.ExpandTableColumn(合并的查询, \"专项物资退场主表\", {\"年\", \"月\", \"项目编码\", \"单据状态\"}, {\"年\", \"月\", \"项目编码\", \"单据状态\"}),",
          "    #\"合并的查询（排除二期项目）\" = Table.FuzzyNestedJoin(#\"展开的“专项物资退场主表”\", {\"项目编码\"}, 非二期项目, {\"项目编码\"}, \"非二期项目\", JoinKind.LeftOuter, [IgnoreCase=true, IgnoreSpace=true]),",
          "    #\"已添加自定义（KEYID）\" = Table.AddColumn(#\"合并的查询（排除二期项目）\", \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    #\"已添加自定义（日期）\" = Table.AddColumn(#\"已添加自定义（KEYID）\", \"日期\", each #date([年],[月],1),Date.Type),",
          "    #\"合并的查询（物资合同）\" = Table.NestedJoin(#\"已添加自定义（日期）\", {\"KEYID\"}, D_采购物资合同, {\"KEYID\"}, \"D_采购物资合同\", JoinKind.LeftOuter),",
          "    #\"展开的“D_采购物资合同”\" = Table.ExpandTableColumn(#\"合并的查询（物资合同）\", \"D_采购物资合同\", {\"专业\", \"分包类型\"}, {\"专业\", \"分包类型\"}),",
          "    删除的其他列 = Table.SelectColumns(#\"展开的“D_采购物资合同”\",{\"金额\", \"税金\", \"价税合计\", \"项目编码\", \"KEYID\", \"日期\", \"专业\", \"分包类型\"}),",
          "    重排序的列 = Table.ReorderColumns(删除的其他列,{\"项目编码\", \"KEYID\", \"专业\", \"分包类型\", \"日期\", \"金额\", \"税金\", \"价税合计\"})",
          "in",
          "    重排序的列"
        ]
      },
      {
        "name": "采购物资退场主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_WUZITUICHANG_ZB,",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"年\", \"月\", \"FXIANGMUBIANMA\", \"单据状态\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXIANGMUBIANMA\", \"项目编码\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "采购物资退场明细",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZITUICHANG_CB\",",
          "    删除的其他列 = Table.SelectColumns(源,{\"退场单\", \"合同编号\", \"金额\", \"税金\", \"价税合计\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "GSPM_WUZIDIAOBOXIANGMUFAQI_ZB",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIDIAOBOXIANGMUFAQI_ZB1 = GSPM{[Name=\"GSPM_WUZIDIAOBOXIANGMUFAQI_ZB\"]}[Data],",
          "    已完成单据 = Table.SelectRows(GSPM_WUZIDIAOBOXIANGMUFAQI_ZB1, each ([FDANJUZHUANGTAI] = \"已完成\"))",
          "in",
          "    已完成单据"
        ]
      },
      {
        "name": "GSPM_WUZIDIAOBOXIANGMUFAQI_CB",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIDIAOBOXIANGMUFAQI_CB1 = GSPM{[Name=\"GSPM_WUZIDIAOBOXIANGMUFAQI_CB\"]}[Data]",
          "in",
          "    GSPM_WUZIDIAOBOXIANGMUFAQI_CB1"
        ]
      },
      {
        "name": "物资调拨主表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_WUZIDIAOBOXIANGMUFAQI_ZB,",
          "    删除的其他列 = Table.SelectColumns(源,{\"FID\", \"FNIAN\", \"FYUE\", \"FDIAOCHUXIANGMUBIANMA\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FDIAOCHUXIANGMUBIANMA\", \"项目编码\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "物资进场物资详细",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIJINCHANGWUZIXX_CB1 = GSPM{[Name=\"GSPM_WUZIJINCHANGWUZIXX_CB\"]}[Data],",
          "    删除的其他列 = Table.SelectColumns(GSPM_WUZIJINCHANGWUZIXX_CB1,{\"FID\", \"FSHIGONGZHUANYE\", \"FHETONGLEIXING\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FSHIGONGZHUANYE\", \"施工专业\"}, {\"FHETONGLEIXING\", \"合同类型\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "F_物资调拨",
        "kind": "m",
        "expression": [
          "let",
          "    源 = GSPM_WUZIDIAOBOXIANGMUFAQI_CB,",
          "    删除的其他列 = Table.SelectColumns(源,{\"FDIAOBODANID\", \"FDIAOBOJINE\", \"FJINCHANGWUZIID\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FDIAOBOJINE\", \"调拨金额\"}}),",
          "    合并的查询 = Table.NestedJoin(重命名的列, {\"FDIAOBODANID\"}, 物资调拨主表, {\"FID\"}, \"物资调拨\", JoinKind.Inner),",
          "    #\"展开的“物资调拨报量不含税”\" = Table.ExpandTableColumn(合并的查询, \"物资调拨\", {\"年\", \"月\", \"项目编码\"}, {\"年\", \"月\", \"项目编码\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“物资调拨报量不含税”\",{\"FDIAOBODANID\"}),",
          "    合并的查询1 = Table.NestedJoin(删除的列, {\"FJINCHANGWUZIID\"}, 物资进场物资详细, {\"FID\"}, \"物资进场物资详细\", JoinKind.LeftOuter),",
          "    #\"展开的“物资进场物资详细”\" = Table.ExpandTableColumn(合并的查询1, \"物资进场物资详细\", {\"施工专业\", \"合同类型\"}, {\"施工专业\", \"合同类型\"}),",
          "    删除的列1 = Table.RemoveColumns(#\"展开的“物资进场物资详细”\",{\"FJINCHANGWUZIID\"}),",
          "    重排序的列 = Table.ReorderColumns(删除的列1,{\"年\", \"月\", \"项目编码\", \"施工专业\", \"合同类型\", \"调拨金额\"}),",
          "    已添加自定义 = Table.AddColumn(重排序的列, \"日期\", each #date([年],[月],1),type date),",
          "    替换的值 = Table.ReplaceValue(已添加自定义,null,\"土建\",Replacer.ReplaceValue,{\"施工专业\"}),",
          "    替换的值1 = Table.ReplaceValue(替换的值,null,\"自施\",Replacer.ReplaceValue,{\"合同类型\"})",
          "in",
          "    替换的值1"
        ]
      },
      {
        "name": "物资租赁主表二期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"GSPM_WUZIYUEDUDUIZHANGDAN（物资对账单）\",",
          "    #\"筛选的行（租赁物资）\" = Table.SelectRows(源, each [FWZSJLX] = \"单项租赁物资\"),",
          "    删除的其他列 = Table.SelectColumns(#\"筛选的行（租赁物资）\",{\"FID\", \"FXIANGMUMINGCHENG\", \"FXIANGMUBIANMA\", \"FPINGSHENJIESHURIQI\", \"FNIAN\", \"FYUE\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FPINGSHENJIESHURIQI\", \"评审完成时间\"}, {\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "物资租赁二期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(物资租赁主表二期, {\"FID\"}, 物资进场明细二期, {\"FSHENPIBIAOID\"}, \"物资对账明细\", JoinKind.Inner),",
          "    #\"展开的“物资对账明细”\" = Table.ExpandTableColumn(源, \"物资对账明细\", {\"合同编号\", \"税率\", \"本月进场含税\"}, {\"合同编号\", \"税率\", \"本月进场含税\"}),",
          "    #\"删除的列（删除ID列）\" = Table.RemoveColumns(#\"展开的“物资对账明细”\",{\"FID\"}),",
          "    #\"替换的值（保证税率不空）\" = Table.ReplaceValue(#\"删除的列（删除ID列）\",null,0,Replacer.ReplaceValue,{\"税率\"}),",
          "    #\"已添加自定义（KEYID）\" = Table.AddColumn(#\"替换的值（保证税率不空）\", \"KEYID\", each [合同编号]&\"@\"&[项目编码],Text.Type),",
          "    排序的行 = Table.Sort(#\"已添加自定义（KEYID）\",{{\"KEYID\", Order.Ascending}, {\"评审完成时间\", Order.Descending}}),",
          "    #\"已添加索引（稳定排序结果）\" = Table.AddIndexColumn(排序的行, \"索引\", 0, 1, Int64.Type),",
          "    #\"删除的副本（每合同每月保留末期）\" = Table.Distinct(#\"已添加索引（稳定排序结果）\", {\"KEYID\", \"年\", \"月\"}),",
          "    #\"删除的列（删除索引列）\" = Table.RemoveColumns(#\"删除的副本（每合同每月保留末期）\",{\"索引\"}),",
          "    #\"已添加自定义（计算不含税进场额）\" = Table.AddColumn(#\"删除的列（删除索引列）\", \"本月进场不含税\", each [本月进场含税]/(1+[税率]),Number.Type),",
          "    #\"已添加自定义（税金）\" = Table.AddColumn(#\"已添加自定义（计算不含税进场额）\", \"本月税金\", each List.Sum({[本月进场含税],-[本月进场不含税]}),Number.Type),",
          "    #\"已添加自定义（计算日期）\" = Table.AddColumn(#\"已添加自定义（税金）\", \"日期\", each #date([年],[月],1),Date.Type),",
          "    #\"删除的其他列（只保留必要的列）\" = Table.SelectColumns(#\"已添加自定义（计算日期）\",{\"项目编码\", \"项目名称\", \"合同编号\", \"本月进场含税\", \"本月进场不含税\", \"本月税金\", \"日期\", \"KEYID\"})",
          "in",
          "    #\"删除的其他列（只保留必要的列）\""
        ]
      },
      {
        "name": "物资租赁一期",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_ZZCAILIAOZLDQBL_ZB = GSPM{[Name=\"GSPM_ZZCAILIAOZLDQBL_ZB\"]}[Data],",
          "    删除的其他列 = Table.SelectColumns(GSPM_ZZCAILIAOZLDQBL_ZB,{\"FID\", \"FNIAN\", \"FYUE\", \"FXIANGMUBIANMA\", \"FXIANGMUMINGCHENG\", \"FDANJUZHUANGTAI\"}),",
          "    筛选的行 = Table.SelectRows(删除的其他列, each ([FDANJUZHUANGTAI] = \"已完成\")),",
          "    重命名的列 = Table.RenameColumns(筛选的行,{{\"FNIAN\", \"年\"}, {\"FYUE\", \"月\"}, {\"FXIANGMUMINGCHENG\", \"项目名称\"}, {\"FDANJUZHUANGTAI\", \"单据状态\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}}),",
          "    合并的查询 = Table.NestedJoin(重命名的列,{\"FID\"},租赁物资报量从表,{\"FBAOLIANGID\"},\"租赁物资报量从表\",JoinKind.LeftOuter),",
          "    #\"展开的“租赁物资报量从表”\" = Table.ExpandTableColumn(合并的查询, \"租赁物资报量从表\", {\"合同编号\", \"本月进场不含税\", \"供方名称\", \"本月税金\", \"本月进场含税\"}, {\"合同编号\", \"本月进场不含税\", \"供方名称\", \"本月税金\", \"本月进场含税\"}),",
          "    已添加自定义 = Table.AddColumn(#\"展开的“租赁物资报量从表”\", \"日期\", each #date([年],[月],1)),",
          "    更改的类型 = Table.TransformColumnTypes(已添加自定义,{{\"日期\", type datetime}}),",
          "    删除的其他列1 = Table.SelectColumns(更改的类型,{\"项目编码\", \"项目名称\", \"合同编号\", \"本月进场不含税\", \"本月税金\", \"本月进场含税\", \"日期\"}),",
          "    已添加自定义1 = Table.AddColumn(删除的其他列1, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    提取的日期 = Table.TransformColumns(已添加自定义1,{{\"日期\", DateTime.Date, type date}}),",
          "    #\"合并的查询（排除二期项目）\" = Table.NestedJoin(提取的日期, {\"项目编码\"}, 非二期项目, {\"项目编码\"}, \"非二期项目\", JoinKind.Inner),",
          "    删除的列 = Table.RemoveColumns(#\"合并的查询（排除二期项目）\",{\"非二期项目\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "租赁物资报量从表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_ZZZULINDQBLHT_CB = GSPM{[Name=\"GSPM_ZZZULINDQBLHT_CB\"]}[Data],",
          "    删除的其他列 = Table.SelectColumns(GSPM_ZZZULINDQBLHT_CB,{\"FBAOLIANGID\", \"FHETONGBIANHAO\", \"FBAOLIANGJINE\", \"FGONGFANGMINGCHENG\", \"FBAOLIANGSHUIE\", \"FBAOLIANGJIASHUIHEJI\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FBAOLIANGJINE\", \"本月进场不含税\"}, {\"FGONGFANGMINGCHENG\", \"供方名称\"}, {\"FBAOLIANGSHUIE\", \"本月税金\"}, {\"FBAOLIANGJIASHUIHEJI\", \"本月进场含税\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "F_物资租赁进场",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({物资租赁一期, 物资租赁二期}),",
          "    重排序的列 = Table.ReorderColumns(源,{\"KEYID\", \"项目编码\", \"项目名称\", \"日期\", \"合同编号\", \"本月进场不含税\", \"本月税金\", \"本月进场含税\"}),",
          "    合并的查询 = Table.NestedJoin(重排序的列, {\"KEYID\"}, D_租赁物资合同, {\"KEYID\"}, \"D_租赁物资合同\", JoinKind.LeftOuter),",
          "    #\"展开的“D_租赁物资合同”\" = Table.ExpandTableColumn(合并的查询, \"D_租赁物资合同\", {\"专业\", \"分包类型\"}, {\"专业\", \"分包类型\"})",
          "in",
          "    #\"展开的“D_租赁物资合同”\""
        ]
      },
      {
        "name": "物资合同结算",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_WUZIHETONGJIESUANPS = GSPM{[Name=\"GSPM_WUZIHETONGJIESUANPS\"]}[Data],",
          "    筛选的行 = Table.SelectRows(GSPM_WUZIHETONGJIESUANPS, each ([FPINGSHENZHUANGTAI] = \"已完成\")),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"FXIANGMUBIANMA\", \"FHETONGBIANHAO\", \"FJIESUANJIAHS\", \"FJIESUANJIABHS\", \"FQIANDINGRIQI\", \"FYEWUDALEI\", \"SCREATETIME\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FHETONGBIANHAO\", \"合同编号\"}, {\"FJIESUANJIAHS\", \"含税结算额\"}, {\"FQIANDINGRIQI\", \"签订日期\"}, {\"FXIANGMUBIANMA\", \"项目编码\"}, {\"FYEWUDALEI\", \"业务大类\"}, {\"FJIESUANJIABHS\", \"不含税结算额\"}}),",
          "    已添加自定义 = Table.AddColumn(重命名的列, \"税金\", each List.Sum({[含税结算额],-[不含税结算额]}),Number.Type),",
          "    #\"已添加自定义(KEYID)\" = Table.AddColumn(已添加自定义, \"KEYID\", each Text.Combine({[合同编号],[项目编码]},\"@\"),Text.Type),",
          "    排序的行 = Table.Sort(#\"已添加自定义(KEYID)\",{{\"KEYID\", Order.Ascending}, {\"SCREATETIME\", Order.Descending}}),",
          "    已添加索引 = Table.AddIndexColumn(排序的行, \"索引\", 0, 1, Int64.Type),",
          "    删除的副本 = Table.Distinct(已添加索引, {\"KEYID\"}),",
          "    删除的列 = Table.RemoveColumns(删除的副本,{\"索引\", \"SCREATETIME\"}),",
          "    提取的日期 = Table.TransformColumns(删除的列,{{\"签订日期\", DateTime.Date, type date}})",
          "in",
          "    提取的日期"
        ]
      },
      {
        "name": "F_采购物资结算",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 物资合同结算,",
          "    筛选的行 = Table.SelectRows(源, each ([业务大类] = \"消耗\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_租赁物资结算",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 物资合同结算,",
          "    筛选的行 = Table.SelectRows(源, each ([业务大类] = \"周转\"))",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_INVOICE",
        "kind": "m",
        "expression": [
          "let",
          "    源 = PingZhengKu,",
          "    BIDW_FOUR = 源{[Schema=\"BIDW_FOUR\"]}[Data],",
          "    F_INVOICE1 = BIDW_FOUR{[Name=\"F_INVOICE\"]}[Data]",
          "in",
          "    F_INVOICE1"
        ]
      },
      {
        "name": "凭证表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = F_INVOICE,",
          "    #\"筛选的行（取成本）\" = Table.SelectRows(源, each (([RACCT]>=\"54000105\") and [RACCT]<\"54000107\") and ([RACCT]<>\"5400010511\") and ([RACCT]<>\"5400010504\")),",
          "    #\"筛选的行（排除期初数）\" = Table.SelectRows(#\"筛选的行（取成本）\", each [BUDAT] <> \"00000000\"),",
          "    删除的其他列 = Table.SelectColumns(#\"筛选的行（排除期初数）\",{ \"PS_POSID\",\"FISCYEARPER\",\"DRCRK\", \"WSL\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"DRCRK\", \"借贷方\"}, {\"FISCYEARPER\", \"业务期间\"}, {\"PS_POSID\", \"WBS\"},{\"WSL\", \"金额\"}}),",
          "    按位置拆分列 = Table.SplitColumn(重命名的列, \"业务期间\", Splitter.SplitTextByPositions({0, 4,5}), {\"年\", \"业务期间.2\",\"月\"}),",
          "    删除的列 = Table.RemoveColumns(按位置拆分列,{\"业务期间.2\"}),",
          "    更改的类型 = Table.TransformColumnTypes(删除的列,{{\"年\", Int64.Type}, {\"月\", Int64.Type}}),",
          "    已添加自定义 = Table.AddColumn(更改的类型, \"日期\", each #date([年],[月],1),Date.Type),",
          "    #\"合并的查询（一体化WBS-X5项目编码对照）\" = Table.NestedJoin(已添加自定义, {\"WBS\"}, #\"一体化WBS-X5项目编码对照\", {\"WBS\"}, \"项目信息\", JoinKind.LeftOuter),",
          "    #\"展开的“一体化WBS-X5项目编码对照”\" = Table.ExpandTableColumn(#\"合并的查询（一体化WBS-X5项目编码对照）\", \"项目信息\", {\"项目编码\", \"专业分类\"}, {\"项目编码\", \"专业分类\"}),",
          "    已添加条件列 = Table.AddColumn(#\"展开的“一体化WBS-X5项目编码对照”\", \"专业\", each if [专业分类] = \"纯机电\" then \"机电\" else \"土建\",type text),",
          "    已添加自定义2 = Table.AddColumn(已添加条件列, \"分包类型\", each \"自施\",type text),",
          "    删除的其他列1 = Table.SelectColumns(已添加自定义2,{\"项目编码\", \"专业\", \"分包类型\",\"日期\",\"金额\"})",
          "in",
          "    删除的其他列1"
        ]
      },
      {
        "name": "一体化WBS-X5项目编码对照",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    MD = 源{[Schema=\"MD\"]}[Data],",
          "    MD_XIANGMUYTHXINXI1 = MD{[Name=\"MD_XIANGMUYTHXINXI\"]}[Data],",
          "    删除的其他列 = Table.SelectColumns(MD_XIANGMUYTHXINXI1,{\"FGFCWYTHXMBM\", \"FGFCWYTHZXMBM\"}),",
          "    筛选的行 = Table.SelectRows(删除的其他列, each ([FGFCWYTHXMBM] <> null)),",
          "    替换的值 = Table.ReplaceValue(筛选的行,null,each [FGFCWYTHXMBM],Replacer.ReplaceValue,{\"FGFCWYTHZXMBM\"}),",
          "    更改的类型 = Table.TransformColumnTypes(替换的值,{{\"FGFCWYTHZXMBM\", type text}}),",
          "    删除的列 = Table.RemoveColumns(更改的类型,{\"FGFCWYTHXMBM\"}),",
          "    重命名的列 = Table.RenameColumns(删除的列,{{\"FGFCWYTHZXMBM\", \"WBS\"}}),",
          "    合并的查询 = Table.NestedJoin(重命名的列, {\"WBS\"}, 项目信息, {\"股份财务一体化项目编码\"}, \"D_项目信息\", JoinKind.LeftOuter),",
          "    #\"展开的“D_项目信息”\" = Table.ExpandTableColumn(合并的查询, \"D_项目信息\", {\"项目编码\", \"专业分类\"}, {\"项目编码\", \"专业分类\"}),",
          "    筛选的行1 = Table.SelectRows(#\"展开的“D_项目信息”\", each ([项目编码] <> null))",
          "in",
          "    筛选的行1"
        ]
      },
      {
        "name": "F_凭证表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 凭证表",
          "in",
          "    源"
        ]
      },
      {
        "name": "总部员工项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 总部员工,",
          "    已添加自定义 = Table.AddColumn(源, \"项目编码\", each X5项目信息[项目编码]),",
          "    #\"展开的“项目编码”\" = Table.ExpandListColumn(已添加自定义, \"项目编码\"),",
          "    更改的类型 = Table.TransformColumnTypes(#\"展开的“项目编码”\",{{\"项目编码\", type text}}),",
          "    删除的列 = Table.RemoveColumns(更改的类型,{\"编码\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "分公司员工项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 区域公司员工,",
          "    合并的查询 = Table.NestedJoin(源, {\"编码\"}, X5项目信息, {\"分公司\"}, \"X5项目信息\", JoinKind.LeftOuter),",
          "    #\"展开的“X5项目信息”\" = Table.ExpandTableColumn(合并的查询, \"X5项目信息\", {\"项目编码\"}, {\"项目编码\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“X5项目信息”\",{\"编码\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "项目人员项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 项目人员,",
          "    重命名的列 = Table.RenameColumns(源,{{\"编码\", \"项目编码\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "厂房事业部员工项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = 厂房事业部员工,",
          "    合并的查询 = Table.NestedJoin(源, {\"编码\"}, X5项目信息, {\"厂房事业部编码\"}, \"X5项目信息\", JoinKind.Inner),",
          "    #\"展开的“X5项目信息”\" = Table.ExpandTableColumn(合并的查询, \"X5项目信息\", {\"项目编码\"}, {\"项目编码\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“X5项目信息”\",{\"编码\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "总部员工",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5组织机构,",
          "    筛选的行 = Table.SelectRows(源, each ([机构] = \"U_ORG_ZB\")),",
          "    删除的副本 = Table.Distinct(筛选的行, {\"身份证\"})",
          "in",
          "    删除的副本"
        ]
      },
      {
        "name": "区域公司员工",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5组织机构,",
          "    #\"筛选的行（包含区域公司列表中的分公司）\" = Table.SelectRows(源, each List.Contains(区域公司列表[区域分公司],[编码])),",
          "    #\"合并的查询(排除总部员工)\" = Table.NestedJoin(#\"筛选的行（包含区域公司列表中的分公司）\", {\"身份证\"}, 总部员工, {\"身份证\"}, \"总部员工\", JoinKind.LeftAnti),",
          "    删除的列 = Table.RemoveColumns(#\"合并的查询(排除总部员工)\",{\"总部员工\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "项目人员",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5组织机构,",
          "    筛选的行 = Table.SelectRows(源, each ([机构] = \"U_ORG_XM\")),",
          "    #\"合并的查询(排除总部员工)\" = Table.NestedJoin(筛选的行, {\"身份证\"}, 总部员工, {\"身份证\"}, \"总部员工\", JoinKind.LeftAnti),",
          "    #\"合并的查询（排除分公司员工）\" = Table.NestedJoin(#\"合并的查询(排除总部员工)\", {\"身份证\"}, 区域公司员工, {\"身份证\"}, \"分公司员工\", JoinKind.LeftAnti),",
          "    删除的列 = Table.RemoveColumns(#\"合并的查询（排除分公司员工）\",{\"总部员工\", \"分公司员工\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "厂房事业部员工",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5组织机构,",
          "    #\"筛选的行（厂房事业部员工）\" = Table.SelectRows(源, each Text.StartsWith([编码], \"U_ORG_CFSYBFGS\")),",
          "    #\"合并的查询(排除总部员工)\" = Table.NestedJoin(#\"筛选的行（厂房事业部员工）\", {\"身份证\"}, 总部员工, {\"身份证\"}, \"总部员工\", JoinKind.LeftAnti),",
          "    删除的列 = Table.RemoveColumns(#\"合并的查询(排除总部员工)\",{\"总部员工\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "门户账户",
        "kind": "m",
        "expression": [
          "let",
          "    源 = picc,",
          "    PICC = 源{[Schema=\"PICC\"]}[Data],",
          "    SY_ORG_DEPT1 = PICC{[Name=\"SY_ORG_USER\"]}[Data],",
          "    // 取有效账号",
          "    筛选的行 = Table.SelectRows(SY_ORG_DEPT1, each ([S_FLAG] = 1)),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"USER_CODE\", \"USER_LOGIN_NAME\"}),",
          "    重命名的列1 = Table.RenameColumns(删除的其他列,{{\"USER_LOGIN_NAME\", \"账号\"}, {\"USER_CODE\", \"身份证\"}})",
          "in",
          "    重命名的列1"
        ]
      },
      {
        "name": "X5组织机构",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    X5SYS = 源{[Schema=\"X5SYS\"]}[Data],",
          "    SA_OPORG1 = X5SYS{[Name=\"SA_OPORG\"]}[Data],",
          "    筛选的行 = Table.SelectRows(SA_OPORG1, each ([SVALIDSTATE] = 1) and ([SORGKINDID] = \"psm\")),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"SCODE\", \"SFCODE\"}),",
          "    按分隔符拆分列2 = Table.SplitColumn(删除的其他列, \"SFCODE\", Splitter.SplitTextByDelimiter(\"/\", QuoteStyle.Csv), {\"SFCODE.1\", \"SFCODE.2\", \"SFCODE.3\", \"SFCODE.4\", \"SFCODE.5\", \"SFCODE.6\", \"SFCODE.7\"}),",
          "    删除的其他列1 = Table.SelectColumns(按分隔符拆分列2,{\"SCODE\", \"SFCODE.3\", \"SFCODE.4\"}),",
          "    重命名的列1 = Table.RenameColumns(删除的其他列1,{{\"SCODE\", \"身份证\"}, {\"SFCODE.3\", \"机构\"}, {\"SFCODE.4\", \"编码\"}}),",
          "    筛选的行1 = Table.SelectRows(重命名的列1, each ([身份证] <> \"SYSTEM\") and ([机构] <> \"U_ORG_DFPRY\"))",
          "in",
          "    筛选的行1"
        ]
      },
      {
        "name": "X5项目信息",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    MD = 源{[Schema=\"MD\"]}[Data],",
          "    MD_XIANGMUXINXI = MD{[Name=\"MD_XIANGMUXINXI\"]}[Data],",
          "    删除的其他列 = Table.SelectColumns(MD_XIANGMUXINXI,{\"FXMBIANMA\", \"FZHIGUANJGXG\", \"FZHIGUANJGXGBM\", \"FCHANGFANGSHIYEBU\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXMBIANMA\", \"项目编码\"}, {\"FZHIGUANJGXGBM\", \"分公司\"}, {\"FCHANGFANGSHIYEBU\", \"厂房事业部\"}}),",
          "    合并的查询 = Table.NestedJoin(重命名的列, {\"厂房事业部\"}, 厂房事业部编码, {\"X5名称\"}, \"厂房事业部编码\", JoinKind.LeftOuter),",
          "    #\"展开的“厂房事业部编码”\" = Table.ExpandTableColumn(合并的查询, \"厂房事业部编码\", {\"厂房事业部编码\"}, {\"厂房事业部编码\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“厂房事业部编码”\",{\"厂房事业部\"})",
          "in",
          "    删除的列"
        ]
      },
      {
        "name": "员工项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.Combine({总部员工项目, 分公司员工项目, 项目人员项目,厂房事业部员工项目})",
          "in",
          "    源"
        ]
      },
      {
        "name": "区域公司列表",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WCo33D3KPd3MPjo/wU4rVQRbwQBcIj0ATCPFCE3BxCox0D1aKjQUA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [区域分公司 = _t])",
          "in",
          "    源"
        ]
      },
      {
        "name": "厂房事业部编码",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WCo33D3KPd3YLjnRycw+ON1TSUXq+Zs2THQ1PdnU/2THrZfMKpVgdDGVGUGW7evAqM4aZ1olXmQlE2dPZs5GUxQIA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [厂房事业部编码 = _t, X5名称 = _t])",
          "in",
          "    源"
        ]
      },
      {
        "name": "账户-项目",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(门户账户, {\"身份证\"}, 员工项目, {\"身份证\"}, \"员工项目\", JoinKind.LeftOuter),",
          "    #\"展开的“员工项目”\" = Table.ExpandTableColumn(源, \"员工项目\", {\"项目编码\"}, {\"项目编码\"}),",
          "    筛选的行 = Table.SelectRows(#\"展开的“员工项目”\", each [项目编码] <> null and [项目编码] <> \"\")",
          "in",
          "    筛选的行"
        ]
      },
      {
        "name": "F_应上交收益履约",
        "kind": "m",
        "expression": [
          "let",
          "    源 = X5,",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_PROJECTPROFIT = GSPM{[Name=\"GSPM_PROJECTPROFIT\"]}[Data],",
          "    删除的其他列 = Table.SelectColumns(GSPM_PROJECTPROFIT,{\"IYEAR\", \"IMONTH\", \"FXIANGMUBIANMA\", \"PROJNAME\", \"HEJI5\", \"HEJI8\"}),",
          "    重命名的列 = Table.RenameColumns(删除的其他列,{{\"FXIANGMUBIANMA\", \"项目编码\"}, {\"PROJNAME\", \"项目名称\"}, {\"HEJI5\", \"开工累计应上缴收益\"}, {\"HEJI8\", \"开工累计应上缴履约\"}}),",
          "    合并的列 = Table.CombineColumns(Table.TransformColumnTypes(重命名的列, {{\"IYEAR\", type text}, {\"IMONTH\", type text}}, \"zh-CN\"),{\"IYEAR\", \"IMONTH\"},Combiner.CombineTextByDelimiter(\"-\", QuoteStyle.None),\"日期\"),",
          "    已分析的日期 = Table.TransformColumns(合并的列,{{\"日期\", each Date.From(DateTimeZone.From(_)), type date}})",
          "in",
          "    已分析的日期"
        ]
      },
      {
        "name": "查询1",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Text.Upper(\"GSPM_JiCaiFenBaoFuKuan\")",
          "in",
          "    源"
        ]
      },
      {
        "name": "度量值",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [列1 = _t]),",
          "    重命名的列 = Table.RenameColumns(源,{{\"列1\", \"B\"}})",
          "in",
          "    重命名的列"
        ]
      },
      {
        "name": "刷新时间",
        "kind": "m",
        "expression": [
          "let",
          "    源 = DateTime.LocalNow(),",
          "    转换为表 = #table(1, {{源}}),",
          "    重命名的列 = Table.RenameColumns(转换为表,{{\"Column1\", \"刷新时间\"}}),",
          "    更改的类型 = Table.TransformColumnTypes(重命名的列,{{\"刷新时间\", type datetime}})",
          "in",
          "    更改的类型"
        ]
      },
      {
        "name": "货币单位",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WetrarKSjZKgUqxOt9GRHO5RrAAQQoV37kYQgwrEA\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [货币单位 = _t, 系数 = _t]),",
          "    更改的类型 = Table.TransformColumnTypes(源,{{\"系数\", Int64.Type}})",
          "in",
          "    更改的类型"
        ]
      },
      {
        "name": "GSPM_CBFKJD_HKPF_ZB（业主收款初始化主表）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_CBFKJD_HKPF_ZB1 = GSPM{[Name=\"GSPM_CBFKJD_HKPF_ZB\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_CBFKJD_HKPF_ZB1,#\"fx_List_生成字段更名列表\"(\"GSPM\",\"GSPM_CBFKJD_HKPF_ZB\")),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([评审状态] = \"已完成\")),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"项目编码\", \"项目名称\", \"FID\", \"创建时间\"}),",
          "    排序的行 = Table.Sort(删除的其他列,{{\"项目编码\", Order.Ascending}, {\"创建时间\", Order.Descending}}),",
          "    已添加索引 = Table.AddIndexColumn(排序的行, \"索引\", 0, 1, Int64.Type),",
          "    删除的副本 = Table.Distinct(已添加索引, {\"项目编码\"}),",
          "    提取的日期 = Table.TransformColumns(删除的副本,{{\"创建时间\", DateTime.Date, type date}}),",
          "    删除的列 = Table.RemoveColumns(提取的日期,{\"索引\"}),",
          "    重命名的列1 = Table.RenameColumns(删除的列,{{\"创建时间\", \"实际回款日期\"}})",
          "in",
          "    重命名的列1"
        ]
      },
      {
        "name": "GSPM_CBFKJD_HKPF_C1B（业主收款初始化明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_CBFKJD_HKPF_ZB1 = GSPM{[Name=\"GSPM_CBFKJD_HKPF_C1B\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_CBFKJD_HKPF_ZB1,#\"fx_List_生成字段更名列表\"(\"GSPM\",\"GSPM_CBFKJD_HKPF_C1B\")),",
          "    删除的其他列 = Table.SelectColumns(重命名的列,{\"合同编号\", \"主表ID\", \"累计回款金额\", \"其中土建自施劈分总额\", \"其中机电自施劈分总额\", \"其中土建指定劈分总额\", \"其中机电指定劈分总额\"}),",
          "    重命名的列1 = Table.RenameColumns(删除的其他列,{{\"其中土建自施劈分总额\", \"土建-自施\"}, {\"其中机电自施劈分总额\", \"机电-自施\"}, {\"其中土建指定劈分总额\", \"土建-指定\"}, {\"其中机电指定劈分总额\", \"机电-指定\"}})",
          "in",
          "    重命名的列1"
        ]
      },
      {
        "name": "业主合同回款初始化",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(#\"GSPM_CBFKJD_HKPF_ZB（业主收款初始化主表）\", {\"FID\"}, #\"GSPM_CBFKJD_HKPF_C1B（业主收款初始化明细）\", {\"主表ID\"}, \"GSPM_CBFKJD_HKPF_ZB（业主收款初始化明细）\", JoinKind.Inner),",
          "    #\"展开的“GSPM_CBFKJD_HKPF_ZB（业主收款初始化明细）”\" = Table.ExpandTableColumn(源, \"GSPM_CBFKJD_HKPF_ZB（业主收款初始化明细）\", {\"合同编号\", \"土建-自施\", \"机电-自施\", \"土建-指定\", \"机电-指定\"}, {\"合同编号\", \"土建-自施\", \"机电-自施\", \"土建-指定\", \"机电-指定\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“GSPM_CBFKJD_HKPF_ZB（业主收款初始化明细）”\",{\"FID\"}),",
          "    已添加自定义 = Table.AddColumn(删除的列, \"回款类型\", each \"初始化\",Text.Type),",
          "    逆透视的列 = Table.UnpivotOtherColumns(已添加自定义, {\"项目编码\", \"项目名称\", \"实际回款日期\", \"合同编号\", \"回款类型\"}, \"属性\", \"金额\"),",
          "    按分隔符拆分列 = Table.SplitColumn(逆透视的列, \"属性\", Splitter.SplitTextByDelimiter(\"-\", QuoteStyle.Csv), {\"施工专业\", \"分包类型\"})",
          "in",
          "    按分隔符拆分列"
        ]
      },
      {
        "name": "GSPM_GONGCHENGKUANHS_ZB（业主收款主表）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_CBFKJD_HKPF_ZB1 = GSPM{[Name=\"GSPM_GONGCHENGKUANHS_ZB\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_CBFKJD_HKPF_ZB1,#\"fx_List_生成字段更名列表\"(\"GSPM\",\"GSPM_GONGCHENGKUANHS_ZB\")),",
          "    筛选的行 = Table.SelectRows(重命名的列, each ([评审状态] = \"已完成\")),",
          "    删除的其他列 = Table.SelectColumns(筛选的行,{\"FID\", \"项目编码\", \"项目名称\"})",
          "in",
          "    删除的其他列"
        ]
      },
      {
        "name": "GSPM_GONGCHENGKUANHS_ZB（业主收款明细）",
        "kind": "m",
        "expression": [
          "let",
          "    源 = #\"X5\",",
          "    GSPM = 源{[Schema=\"GSPM\"]}[Data],",
          "    GSPM_CBFKJD_HKPF_ZB1 = GSPM{[Name=\"GSPM_GONGCHENGKUANHS_CB\"]}[Data],",
          "    重命名的列 = Table.RenameColumns(GSPM_CBFKJD_HKPF_ZB1,#\"fx_List_生成字段更名列表\"(\"GSPM\",\"GSPM_GONGCHENGKUANHS_CB\"),MissingField.Ignore),",
          "    #\"筛选的行（去掉收款为null）\" = Table.SelectRows(重命名的列, each ([本次回款金额] <> null)),",
          "    删除的其他列1 = Table.SelectColumns(#\"筛选的行（去掉收款为null）\",{\"合同编号\", \"实际回款日期\", \"其中土建自施\", \"其中土建指定\", \"其中机电自施\", \"其中机电指定\", \"回款类型\", \"主表ID\"}),",
          "    重命名的列1 = Table.RenameColumns(删除的其他列1,{{\"其中土建自施\", \"土建-自施\"}, {\"其中土建指定\", \"土建-指定\"}, {\"其中机电自施\", \"机电-自施\"}, {\"其中机电指定\", \"机电-指定\"}}),",
          "    提取的日期 = Table.TransformColumns(重命名的列1,{{\"实际回款日期\", DateTime.Date, type date}})",
          "in",
          "    提取的日期"
        ]
      },
      {
        "name": "业主合同回款登记",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.NestedJoin(#\"GSPM_GONGCHENGKUANHS_ZB（业主收款主表）\", {\"FID\"}, #\"GSPM_GONGCHENGKUANHS_ZB（业主收款明细）\", {\"主表ID\"}, \"GSPM_GONGCHENGKUANHS_ZB（业主收款明细）\", JoinKind.Inner),",
          "    #\"展开的“GSPM_GONGCHENGKUANHS_ZB（业主收款明细）”\" = Table.ExpandTableColumn(源, \"GSPM_GONGCHENGKUANHS_ZB（业主收款明细）\", {\"合同编号\", \"实际回款日期\", \"土建-自施\", \"土建-指定\", \"机电-自施\", \"机电-指定\", \"回款类型\"}, {\"合同编号\", \"实际回款日期\", \"土建-自施\", \"土建-指定\", \"机电-自施\", \"机电-指定\", \"回款类型\"}),",
          "    删除的列 = Table.RemoveColumns(#\"展开的“GSPM_GONGCHENGKUANHS_ZB（业主收款明细）”\",{\"FID\"}),",
          "    逆透视的列 = Table.UnpivotOtherColumns(删除的列, {\"项目编码\", \"项目名称\", \"合同编号\", \"实际回款日期\", \"回款类型\"}, \"属性\", \"金额\"),",
          "    按分隔符拆分列 = Table.SplitColumn(逆透视的列, \"属性\", Splitter.SplitTextByDelimiter(\"-\", QuoteStyle.Csv), {\"施工专业\", \"分包类型\"})",
          "in",
          "    按分隔符拆分列"
        ]
      },
      {
        "name": "集采劳务合同",
        "kind": "m",
        "expression": [
          "let",
          "    源 = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45Wcopy89I1MDVXitWBcQwtoRzHKF0DA0NkjhEyxxjMifJyDg7WNTA3gEpBucYoXCMzVK45CtfSAoVrDOTGAgA=\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [编号 = _t]),",
          "    更改的类型 = Table.TransformColumnTypes(源,{{\"编号\", type text}})",
          "in",
          "    更改的类型"
        ]
      }
    ],
    "annotations": [
      {
        "name": "ClientCompatibilityLevel",
        "value": "700"
      },
      {
        "name": "__TEdtr",
        "value": "1"
      }
    ]
  },
  "id": "SemanticModel"
}